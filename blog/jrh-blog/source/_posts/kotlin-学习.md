---
title: kotlin å­¦ä¹ 
date: 2019-01-20 22:11:37
categories:
- [kotlin]
tags:
- kotlin
---

## Kotlin 

1. kotlinçš„å˜é‡æ²¡æœ‰é»˜è®¤å€¼,éœ€è¦æ‰‹åŠ¨åˆå§‹åŒ–ï¼Œå¦åˆ™æŠ¥é”™

2. kotlin ç©ºå®‰å…¨

   * `Lateinit var view:View` å»¶è¿Ÿåˆå§‹åŒ–
   * kotlinå˜é‡é»˜è®¤éç©º å¯ä»¥æ·»åŠ  `ï¼Ÿ`è®¾ç½®ä¸ºå¯ç©º   `var name:String?=null`
   * kotlin çº¿ç¨‹å®‰å…¨  `name?.length`

3. ç±»å‹æ¨æ–­

   <!--more-->

4. var å¯ä»¥ä¿®æ”¹è®¾ç½®å˜é‡

   val åªè¯»å˜é‡

   * ä¸å¯ä»¥è°ƒç”¨setterå‡½æ•°ï¼Œä¸èƒ½é‡å†™setterå‡½æ•°ï¼Œä½†å¯ä»¥é‡å†™getterå‡½æ•°

5. é»˜è®¤å®ç°äº†geter/setter æ–¹æ³•ï¼Œé‡å†™getter,setter

   ```kotlin
   var name: String? = null
       get() {
         //æ³¨æ„æ­¤å¤„çš„filed
           return field
       }
       set(value) {
           field = value
       }
   ```

6. â€åŸºæœ¬ç±»å‹â€œçš„èˆå¼ƒ

   æ•°å­—ï¼Œå­—ç¬¦ï¼Œå¸ƒå°”å€¼ï¼Œæ•°ç»„ï¼Œå­—ç¬¦ä¸²

   * Int
   * Float
   * Long
   * ...

7. ç±»çš„å¯è§æ€§

   * Javaä¸­çš„publicåœ¨kotlinä¸­å¯ä»¥çœç•¥ï¼Œkotlinä¸­çš„ç±»é»˜è®¤æ˜¯publicçš„
   * kotlinä¸­çš„ç±»é»˜è®¤æ˜¯finalçš„ï¼Œå¯ä»¥åŠ `open` å…³é”®å­—ï¼Œæ¥è§£é™¤é™åˆ¶ï¼Œç»§æ‰¿æ—¶ä½¿ç”¨

8. `override`å…³é”®å­— ï¼Œåœ¨æ³¨è§£ä¸­@Override æ˜¯æ³¨è§£ï¼Œ`override`å…·æœ‰é—ä¼ æ€§ï¼Œå¯ä»¥æ·»åŠ `final`å…³é”®å­—ï¼Œå…³é—­`override` çš„é—ä¼ æ€§

9. `abstract`å…³é”®å­—ï¼Œä¿®é¥°çš„ç±»æ— æ³•ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨ã€‚

10. å®ä¾‹åŒ–ä¸€ä¸ªæ–°ç±»æ—¶ï¼Œçœç•¥äº†Javaä¸­çš„newå…³é”®å­—ã€‚

11. kotlinä¸­ä½¿ç”¨`is`å…³é”®å­—è¿›è¡Œç±»å‹åˆ¤æ–­ï¼Œå¹¶ä¸”ç¼–è¯‘å™¨èƒ½å¤Ÿè¿›è¡Œç±»å‹åˆ¤æ–­ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬çœå»å¼ºè½¬çš„å†™æ³•

    ```kotlin
    class NewActivity : MainActivity() {
        fun action() {}
    }
    
    
    fun main() {
        var activity: Activity = NewActivity()
        // ğŸ‘†activity æ˜¯æ— æ³•è°ƒç”¨ NewActivity çš„ action æ–¹æ³•çš„
    }
    
    fun main() {
        var activity: Activity = NewActivity()
        if (activity is NewActivity) {
            // ğŸ‘‡çš„å¼ºè½¬ç”±äºç±»å‹æ¨æ–­è¢«çœç•¥äº†
            activity.action()
        }
    }
    
    ```

    javaä¸­éœ€è¦å…ˆä½¿ç”¨ `instanceof` å…³é”®å­—åˆ¤æ–­ç±»å‹ï¼Œå†é€šè¿‡å¼ºè½¬æ¥è°ƒç”¨ï¼š

    ```java
    void main() {
        Activity activity = new NewActivity();
        if (activity instanceof NewActivity) {
            ((NewActivity) activity).action();
        }
    }
    ```

    å¯ä»¥ä½¿ç”¨ `as` å…³é”®å­—ï¼šç›´æ¥è¿›è¡Œå¼ºè½¬è°ƒç”¨

    ```java
    ğŸï¸
    fun main() {
        var activity: Activity = NewActivity()
         //è¿™ç§å†™æ³•å¦‚æœå¼ºè½¬ç±»å‹æ“ä½œæ˜¯æ­£ç¡®çš„å½“ç„¶æ²¡é—®é¢˜ï¼Œä½†å¦‚æœå¼ºè½¬æˆä¸€ä¸ªé”™è¯¯çš„ç±»å‹ï¼Œç¨‹åºå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚
        (activity as NewActivity).action()
          
         // ğŸ‘‡'(activity as? NewActivity)' ä¹‹åæ˜¯ä¸€ä¸ªå¯ç©ºç±»å‹çš„å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä½¿ç”¨ '?.' æ¥è°ƒç”¨
        (activity as? NewActivity)?.action()
    }
    ```

12. **constructor**

    ```java
    â˜•ï¸
    public class User {
        int id;
        String name;
          ğŸ‘‡   ğŸ‘‡
        public User(int id, String name) {
            this.id = id;
            this.name = name;
        }
    }
    ```

    ```kotlin
    ğŸï¸
    class User {
        val id: Int
        val name: String
             ğŸ‘‡
        constructor(id: Int, name: String) {
     //ğŸ‘† æ²¡æœ‰ public
            this.id = id
            this.name = name
        }
    }
    ```

    - Java ä¸­æ„é€ å™¨å’Œç±»åŒåï¼ŒKotlin ä¸­ä½¿ç”¨ `constructor` è¡¨ç¤ºã€‚
    - Kotlin ä¸­æ„é€ å™¨æ²¡æœ‰ public ä¿®é¥°ï¼Œå› ä¸ºé»˜è®¤å¯è§æ€§å°±æ˜¯å…¬å¼€çš„ï¼ˆå…³äºå¯è§æ€§ä¿®é¥°ç¬¦è¿™é‡Œå…ˆä¸å±•å¼€ï¼Œåé¢ä¼šè®²åˆ°ï¼‰ã€‚

13. #### init

    Java é‡Œå¸¸å¸¸é…åˆä¸€èµ·ä½¿ç”¨çš„ init ä»£ç å—ï¼Œåœ¨ Kotlin é‡Œçš„å†™æ³•ä¹Ÿæœ‰äº†ä¸€ç‚¹ç‚¹æ”¹å˜ï¼šä½ éœ€è¦ç»™å®ƒåŠ ä¸€ä¸ª `init` å‰ç¼€ã€‚

    ```java
    â˜•ï¸
    public class User {
       ğŸ‘‡
        {
            // åˆå§‹åŒ–ä»£ç å—ï¼Œå…ˆäºä¸‹é¢çš„æ„é€ å™¨æ‰§è¡Œ
        }
        public User() {
        }
    }
    ```

    ```kotlin
    ğŸï¸
    class User {
        ğŸ‘‡
        init {
            // åˆå§‹åŒ–ä»£ç å—ï¼Œå…ˆäºä¸‹é¢çš„æ„é€ å™¨æ‰§è¡Œ
        }
        constructor() {
        }
    }
    ```

    Kotlin çš„ init ä»£ç å—å’Œ Java ä¸€æ ·ï¼Œéƒ½åœ¨å®ä¾‹åŒ–æ—¶æ‰§è¡Œï¼Œå¹¶ä¸”æ‰§è¡Œé¡ºåºéƒ½åœ¨æ„é€ å™¨ä¹‹å‰ã€‚

    

14. ### final

    Kotlin ä¸­çš„ `val` å’Œ Java ä¸­çš„ `final` ç±»ä¼¼ï¼Œè¡¨ç¤ºåªè¯»å˜é‡ï¼Œä¸èƒ½ä¿®æ”¹ã€‚è¿™é‡Œåˆ†åˆ«ä»æˆå‘˜å˜é‡ã€å‚æ•°å’Œå±€éƒ¨å˜é‡æ¥å’Œ Java åšå¯¹æ¯”ï¼š

    ```java
    â˜•ï¸
     ğŸ‘‡
    final int final1 = 1;
                 ğŸ‘‡  
    void method(final String final2) {
         ğŸ‘‡
        final String final3 = "The parameter is " + final2;
    }
    
    ```

    ```kotlin
    ğŸï¸
    ğŸ‘‡
    val fina1 = 1
           // ğŸ‘‡ å‚æ•°æ˜¯æ²¡æœ‰ val çš„
    fun method(final2: String) {
        ğŸ‘‡
        val final3 = "The parameter is " + final2
    }
    
    ```

    - final å˜æˆäº† valã€‚
    - Kotlin å‡½æ•°å‚æ•°é»˜è®¤æ˜¯ val ç±»å‹ï¼Œæ‰€ä»¥å‚æ•°å‰ä¸éœ€è¦å†™ val å…³é”®å­—ï¼ŒKotlin é‡Œè¿™æ ·è®¾è®¡çš„åŸå› æ˜¯ä¿è¯äº†å‚æ•°ä¸ä¼šè¢«ä¿®æ”¹ï¼Œè€Œ Java çš„å‚æ•°å¯ä¿®æ”¹ï¼ˆé»˜è®¤æ²¡ final ä¿®é¥°ï¼‰ä¼šå¢åŠ å‡ºé”™çš„æ¦‚ç‡ã€‚
    - `var` æ˜¯ variable çš„ç¼©å†™ï¼Œ `val` æ˜¯ value çš„ç¼©å†™ã€‚

15. ### static

    åœ¨ Java é‡Œé¢å†™å¸¸é‡ï¼Œæˆ‘ä»¬ç”¨çš„æ˜¯ `static` + `final`ã€‚è€Œåœ¨ Kotlin é‡Œé¢ï¼Œé™¤äº† `final` çš„å†™æ³•ä¸ä¸€æ ·ï¼Œ`static` çš„å†™æ³•ä¹Ÿä¸ä¸€æ ·ï¼Œè€Œä¸”æ˜¯æ›´ä¸ä¸€æ ·ã€‚ç¡®åˆ‡åœ°è¯´ï¼šåœ¨ `Kotlin` é‡Œï¼Œé™æ€å˜é‡å’Œé™æ€æ–¹æ³•è¿™ä¸¤ä¸ªæ¦‚å¿µè¢«å»é™¤äº†ã€‚

    é‚£å¦‚æœæƒ³åœ¨ Kotlin ä¸­åƒ Java ä¸€æ ·é€šè¿‡ç±»ç›´æ¥å¼•ç”¨è¯¥æ€ä¹ˆåŠå‘¢ï¼ŸKotlin çš„ç­”æ¡ˆæ˜¯ `companion object`ï¼š

    ```kotlin
    ğŸï¸
    class Sample {
        ...
           ğŸ‘‡
        companion object {
            val anotherString = "Another String"
        }
    }
    
    ```

16. ### object

    Kotlin é‡Œçš„ `object` â€”â€”é¦–å­—æ¯å°å†™çš„ï¼Œä¸æ˜¯å¤§å†™ï¼ŒJava é‡Œçš„ `Object` åœ¨ Kotlin é‡Œä¸ç”¨äº†ã€‚

    > Java ä¸­çš„ `Object` åœ¨ Kotlin ä¸­å˜æˆäº† `Any`ï¼Œå’Œ `Object` ä½œç”¨ä¸€æ ·ï¼šä½œä¸ºæ‰€æœ‰ç±»çš„åŸºç±»ã€‚

    è€Œ `object` ä¸æ˜¯ç±»ï¼Œåƒ `class` ä¸€æ ·åœ¨ Kotlin ä¸­å±äºå…³é”®å­—ï¼š

    ```kotlin
    ğŸï¸
    object Sample {
        val name = "A name"
    }
    
    ```

    å®ƒçš„æ„æ€å¾ˆç›´æ¥ï¼šåˆ›å»ºä¸€ä¸ªç±»ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªè¿™ä¸ªç±»çš„å¯¹è±¡ã€‚è¿™ä¸ªå°±æ˜¯ `object` çš„æ„æ€ï¼šå¯¹è±¡ã€‚

    åœ¨ä»£ç ä¸­å¦‚æœè¦ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œç›´æ¥é€šè¿‡å®ƒçš„ç±»åå°±å¯ä»¥è®¿é—®ï¼š

    ```kotlin
    ğŸï¸
    Sample.name
    //è¿™ä¸å°±æ˜¯å•ä¾‹ä¹ˆï¼Œæ‰€ä»¥åœ¨ Kotlin ä¸­åˆ›å»ºå•ä¾‹ä¸ç”¨åƒ Java ä¸­é‚£ä¹ˆå¤æ‚ï¼Œåªéœ€è¦æŠŠ class æ¢æˆ object å°±å¯ä»¥äº†ã€‚
    
    
    ```

    è¿™ç§é€šè¿‡ `object` å®ç°çš„å•ä¾‹æ˜¯ä¸€ä¸ªé¥¿æ±‰å¼çš„å•ä¾‹ï¼Œå¹¶ä¸”å®ç°äº†çº¿ç¨‹å®‰å…¨ã€‚

    

    **ç»§æ‰¿ç±»å’Œå®ç°æ¥å£**

    Kotlin ä¸­ä¸ä»…ç±»å¯ä»¥ç»§æ‰¿åˆ«çš„ç±»ï¼Œå¯ä»¥å®ç°æ¥å£ï¼Œ`object` ä¹Ÿå¯ä»¥ï¼š

    ```kotlin
    ğŸï¸
    open class A {
        open fun method() {
            ...
        }
    }
    
    interface B {
        fun interfaceMethod()
    }
      ğŸ‘‡      ğŸ‘‡   ğŸ‘‡
    object C : A(), B {
    
        override fun method() {
            ...
        }
    
        override fun interfaceMethod() {
            ...
        }
    }
    
    ```

    **åŒ¿åç±»**

    Kotlin è¿˜å¯ä»¥åˆ›å»º Java ä¸­çš„åŒ¿åç±»ï¼Œåªæ˜¯å†™æ³•ä¸Šæœ‰ç‚¹ä¸åŒï¼š

    ```java
    â˜•ï¸                                              ğŸ‘‡ 
    ViewPager.SimpleOnPageChangeListener listener = new ViewPager.SimpleOnPageChangeListener() {
        @Override // ğŸ‘ˆ
        public void onPageSelected(int position) {
            // override
        }
    };
    
    ```

    ```kotlin
    ğŸï¸          
    val listener = object: ViewPager.SimpleOnPageChangeListener() {
        override fun onPageSelected(position: Int) {
            // override
        }
    }    
    
    ```

    - Java ä¸­ `new` ç”¨æ¥åˆ›å»ºä¸€ä¸ªåŒ¿åç±»çš„å¯¹è±¡
    - Kotlin ä¸­ `object:` ä¹Ÿå¯ä»¥ç”¨æ¥åˆ›å»ºåŒ¿åç±»çš„å¯¹è±¡

    è¿™é‡Œçš„ `new` å’Œ `object:` ä¿®é¥°çš„éƒ½æ˜¯æ¥å£æˆ–è€…æŠ½è±¡ç±»ã€‚

17. #### companion object

    ç”¨ `object` ä¿®é¥°çš„å¯¹è±¡ä¸­çš„å˜é‡å’Œå‡½æ•°éƒ½æ˜¯é™æ€çš„ï¼Œä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åªæƒ³è®©ç±»ä¸­çš„ä¸€éƒ¨åˆ†å‡½æ•°å’Œå˜é‡æ˜¯é™æ€çš„è¯¥æ€ä¹ˆåšå‘¢ï¼š

    ```kotlin
    ğŸï¸
    class A {
              ğŸ‘‡
        object B {
            var c: Int = 0
        }
    }
    
    ```

    å¦‚ä¸Šï¼Œå¯ä»¥åœ¨ç±»ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ŒæŠŠéœ€è¦é™æ€çš„å˜é‡æˆ–å‡½æ•°æ”¾åœ¨å†…éƒ¨å¯¹è±¡ B ä¸­ï¼Œå¤–éƒ¨å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼è°ƒç”¨è¯¥é™æ€å˜é‡ï¼š

    ```kotlin
    ğŸï¸
    A.B.c
      ğŸ‘†
    
    ```

    ç±»ä¸­åµŒå¥—çš„å¯¹è±¡å¯ä»¥ç”¨ `companion` ä¿®é¥°ï¼š

    ```kotlin
    ğŸï¸
    class A {
           ğŸ‘‡
        companion object B {
            var c: Int = 0
        }
    }
    
    ```

    `companion` å¯ä»¥ç†è§£ä¸ºä¼´éšã€ä¼´ç”Ÿï¼Œè¡¨ç¤ºä¿®é¥°çš„å¯¹è±¡å’Œå¤–éƒ¨ç±»ç»‘å®šã€‚

    ä½†è¿™é‡Œæœ‰ä¸€ä¸ªå°é™åˆ¶ï¼šä¸€ä¸ªç±»ä¸­æœ€å¤šåªå¯ä»¥æœ‰ä¸€ä¸ªä¼´ç”Ÿå¯¹è±¡ï¼Œä½†å¯ä»¥æœ‰å¤šä¸ªåµŒå¥—å¯¹è±¡ã€‚

    è¿™æ ·çš„å¥½å¤„æ˜¯è°ƒç”¨çš„æ—¶å€™å¯ä»¥çœæ‰å¯¹è±¡åï¼š

    ```kotlin
    ğŸï¸
    A.c // ğŸ‘ˆ B æ²¡äº†
    
    ```

    æ‰€ä»¥ï¼Œå½“æœ‰ `companion` ä¿®é¥°æ—¶ï¼Œå¯¹è±¡çš„åå­—ä¹Ÿå¯ä»¥çœç•¥æ‰ï¼š

    ```kotlin
    ğŸï¸
    class A {
                    // ğŸ‘‡ B æ²¡äº†
        companion object {
            var c: Int = 0
        }
    }
    
    ```

    **é™æ€åˆå§‹åŒ–**

    Java ä¸­çš„é™æ€å˜é‡å’Œæ–¹æ³•ï¼Œåœ¨ Kotlin ä¸­éƒ½æ”¾åœ¨äº† `companion object` ä¸­ã€‚å› æ­¤ Java ä¸­çš„é™æ€åˆå§‹åŒ–åœ¨ Kotlin ä¸­è‡ªç„¶ä¹Ÿæ˜¯æ”¾åœ¨ `companion object` ä¸­çš„ï¼Œåƒç±»çš„åˆå§‹åŒ–ä»£ç ä¸€æ ·ï¼Œç”± `init` å’Œä¸€å¯¹å¤§æ‹¬å·è¡¨ç¤ºï¼š

    ```kotlin
    ğŸï¸
    class Sample {
           ğŸ‘‡
        companion object {
             ğŸ‘‡
            init {
                ...
            }
        }
    }
    
    ```

    **top-level property / function å£°æ˜**

    é™¤äº†é™æ€å‡½æ•°è¿™ç§ç®€ä¾¿çš„è°ƒç”¨æ–¹å¼ï¼ŒKotlin è¿˜æœ‰æ›´æ–¹ä¾¿çš„ä¸œè¥¿ï¼šã€Œ`top-level declaration` é¡¶å±‚å£°æ˜ã€ã€‚å…¶å®å°±æ˜¯æŠŠå±æ€§å’Œå‡½æ•°çš„å£°æ˜ä¸å†™åœ¨ `class` é‡Œé¢ï¼Œè¿™ä¸ªåœ¨ Kotlin é‡Œæ˜¯å…è®¸çš„ï¼š

    ```kotlin
    ğŸï¸
    package com.hencoder.plus
    
    // ğŸ‘‡ å±äº packageï¼Œä¸åœ¨ class/object å†…
    fun topLevelFuncion() {
    }
    
    ```

    è¿™æ ·å†™çš„å±æ€§å’Œå‡½æ•°ï¼Œä¸å±äºä»»ä½• `class`ï¼Œè€Œæ˜¯ç›´æ¥å±äº `package`ï¼Œå®ƒå’Œé™æ€å˜é‡ã€é™æ€å‡½æ•°ä¸€æ ·æ˜¯å…¨å±€çš„ï¼Œä½†ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼šä½ åœ¨å…¶å®ƒåœ°æ–¹ç”¨çš„æ—¶å€™ï¼Œå°±è¿ç±»åéƒ½ä¸ç”¨å†™ï¼š

    <br class="Apple-interchange-newline"><div></div>

    ```kotlin
    ğŸï¸
    import com.hencoder.plus.topLevelFunction // ğŸ‘ˆ ç›´æ¥ import å‡½æ•°
    
    topLevelFunction()
    
    ```

    * å‘½åç›¸åŒçš„é¡¶çº§å‡½æ•°

      > é¡¶çº§å‡½æ•°ä¸å†™åœ¨ç±»ä¸­å¯èƒ½æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœåœ¨ä¸åŒæ–‡ä»¶ä¸­å£°æ˜å‘½åç›¸åŒçš„å‡½æ•°ï¼Œä½¿ç”¨çš„æ—¶å€™ä¼šä¸ä¼šæ··æ·†ï¼Ÿ
      >
      > ä¸ä¼šï¼Œå½“å‡ºç°ä¸¤ä¸ªåŒåé¡¶çº§å‡½æ•°æ—¶ï¼ŒIDE ä¼šè‡ªåŠ¨åŠ ä¸ŠåŒ…å‰ç¼€æ¥åŒºåˆ†ï¼Œè¿™ä¹Ÿå°è¯äº†ã€Œé¡¶çº§å‡½æ•°å±äºåŒ…ã€çš„ç‰¹æ€§ã€‚

    åœ¨ `object`ã€`companion object` å’Œ top-level ä¸­è¯¥é€‰æ‹©å“ªä¸€ä¸ªå‘¢ï¼Ÿç®€å•æ¥è¯´æŒ‰ç…§ä¸‹é¢è¿™ä¸¤ä¸ªåŸåˆ™åˆ¤æ–­ï¼š

    - å¦‚æœæƒ³å†™å·¥å…·ç±»çš„åŠŸèƒ½ï¼Œç›´æ¥åˆ›å»ºæ–‡ä»¶ï¼Œå†™ top-levelã€Œé¡¶å±‚ã€å‡½æ•°ã€‚
    - å¦‚æœéœ€è¦ç»§æ‰¿åˆ«çš„ç±»æˆ–è€…å®ç°æ¥å£ï¼Œå°±ç”¨ `object` æˆ– `companion object`ã€‚

    

18. #### å¸¸é‡

    Java ä¸­å£°æ˜å¸¸é‡ï¼š

    ```java
    â˜•ï¸
    public class Sample {
                ğŸ‘‡     ğŸ‘‡
        public static final int CONST_NUMBER = 1;
    }
    
    ```

    Kotlin ä¸­å£°æ˜å¸¸é‡ï¼š

    ```kotlin
    ğŸï¸
    class Sample {
        companion object {
             ğŸ‘‡                  // ğŸ‘‡
            const val CONST_NUMBER = 1
        }
    }
    
    const val CONST_SECOND_NUMBER = 2
    
    ```

    å‘ç°ä¸åŒç‚¹æœ‰ï¼š

    - Kotlin çš„å¸¸é‡å¿…é¡»å£°æ˜åœ¨å¯¹è±¡ï¼ˆåŒ…æ‹¬ä¼´ç”Ÿå¯¹è±¡ï¼‰æˆ–è€…ã€Œtop-level é¡¶å±‚ã€ä¸­ï¼Œå› ä¸ºå¸¸é‡æ˜¯é™æ€çš„ã€‚

    - Kotlin æ–°å¢äº†ä¿®é¥°å¸¸é‡çš„ `const` å…³é”®å­—ã€‚

    - Kotlin ä¸­åªæœ‰åŸºæœ¬ç±»å‹å’Œ String ç±»å‹å¯ä»¥å£°æ˜æˆå¸¸é‡ã€‚

      > åŸå› æ˜¯ Kotlin ä¸­çš„å¸¸é‡æŒ‡çš„æ˜¯ ã€Œcompile-time constant ç¼–è¯‘æ—¶å¸¸é‡ã€ï¼Œå®ƒçš„æ„æ€æ˜¯ã€Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™å°±çŸ¥é“è¿™ä¸ªä¸œè¥¿åœ¨æ¯ä¸ªè°ƒç”¨å¤„çš„å®é™…å€¼ã€ï¼Œå› æ­¤å¯ä»¥åœ¨ç¼–è¯‘æ—¶ç›´æ¥æŠŠè¿™ä¸ªå€¼ç¡¬ç¼–ç åˆ°ä»£ç é‡Œä½¿ç”¨çš„åœ°æ–¹ã€‚
      >
      > è€ŒéåŸºæœ¬å’Œ String ç±»å‹çš„å˜é‡ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•æˆ–å˜é‡æ”¹å˜å¯¹è±¡å†…éƒ¨çš„å€¼ï¼Œè¿™æ ·è¿™ä¸ªå˜é‡å°±ä¸æ˜¯å¸¸é‡äº†ï¼Œ
      >
      > æ¥çœ‹ä¸€ä¸ª Java çš„ä¾‹å­ï¼Œæ¯”å¦‚ä¸€ä¸ª User ç±»ï¼š
      >
      > ```java
      > â˜•ï¸
      > public class User {
      >  int id; // ğŸ‘ˆ å¯ä¿®æ”¹
      >  String name; // ğŸ‘ˆ å¯ä¿®æ”¹
      >  public User(int id, String name) {
      >      this.id = id;
      >      this.name = name;
      >  }
      > }
      > 
      > ```
      >
      > åœ¨ä½¿ç”¨çš„åœ°æ–¹å£°æ˜ä¸€ä¸ª `static final` çš„ User å®ä¾‹ `user`ï¼Œå®ƒæ˜¯ä¸èƒ½äºŒæ¬¡èµ‹å€¼çš„ï¼š
      >
      > ```java
      > â˜•ï¸
      > static final User user = new User(123, "Zhangsan");
      > ğŸ‘†    ğŸ‘†
      > 
      > ```
      >
      > ä½†æ˜¯å¯ä»¥é€šè¿‡è®¿é—®è¿™ä¸ª `user` å®ä¾‹çš„æˆå‘˜å˜é‡æ”¹å˜å®ƒçš„å€¼ï¼š
      >
      > ```java
      > â˜•ï¸
      > user.name = "Lisi";
      >    ğŸ‘†
      > 
      > ```
      >
      > æ‰€ä»¥ Java ä¸­çš„å¸¸é‡å¯ä»¥è®¤ä¸ºæ˜¯ã€Œä¼ªå¸¸é‡ã€ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡ä¸Šé¢è¿™ç§æ–¹å¼æ”¹å˜å®ƒå†…éƒ¨çš„å€¼ã€‚è€Œ Kotlin çš„å¸¸é‡å› ä¸ºé™åˆ¶ç±»å‹å¿…é¡»æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ‰€ä»¥ä¸å­˜åœ¨è¿™ç§é—®é¢˜ï¼Œæ›´ç¬¦åˆå¸¸é‡çš„å®šä¹‰ã€‚

19. #### æ•°ç»„å’Œé›†åˆ

    å£°æ˜ä¸€ä¸ª String æ•°ç»„ï¼š

    java:

    ```java
    String[] strs = {"a", "b", "c"};
    
    ```

    Kotlin:

    ```kotlin
    val strs: Array<String> = arrayOf("a", "b", "c")
    
    ```

    * å–å€¼å’Œä¿®æ”¹

      Kotlin ä¸­è·å–æˆ–è€…è®¾ç½®æ•°ç»„å…ƒç´ å’Œ Java ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·åŠ ä¸‹æ ‡çš„æ–¹å¼ç´¢å¼•ï¼š

      ```kotlin
      ğŸï¸
      println(strs[0])
         ğŸ‘‡      ğŸ‘†
      strs[1] = "B"
      
      ```

    * ä¸æ”¯æŒåå˜

      Kotlin çš„æ•°ç»„ç¼–è¯‘æˆå­—èŠ‚ç æ—¶ä½¿ç”¨çš„ä»ç„¶æ˜¯ Java çš„æ•°ç»„ï¼Œä½†åœ¨è¯­è¨€å±‚é¢æ˜¯æ³›å‹å®ç°ï¼Œè¿™æ ·ä¼šå¤±å»åå˜ (covariance) ç‰¹æ€§ï¼Œå°±æ˜¯å­ç±»æ•°ç»„å¯¹è±¡ä¸èƒ½èµ‹å€¼ç»™çˆ¶ç±»çš„æ•°ç»„å˜é‡ï¼š

      ```kotlin
      ğŸï¸
      val strs: Array<String> = arrayOf("a", "b", "c")
                        ğŸ‘†
      val anys: Array<Any> = strs // compile-error: Type mismatch
                      ğŸ‘†
      
      ```

      Java ä¸­å¯ä»¥

      ```java
      â˜•ï¸
      String[] strs = {"a", "b", "c"};
        ğŸ‘†
      Object[] objs = strs; // success
        ğŸ‘†
      
      ```

20. #### é›†åˆ

    Kotlin å’Œ Java ä¸€æ ·æœ‰ä¸‰ç§é›†åˆç±»å‹ï¼šListã€Set å’Œ Mapï¼Œå®ƒä»¬çš„å«ä¹‰åˆ†åˆ«å¦‚ä¸‹ï¼š

    - `List` ä»¥å›ºå®šé¡ºåºå­˜å‚¨ä¸€ç»„å…ƒç´ ï¼Œå…ƒç´ å¯ä»¥é‡å¤ã€‚
    - `Set` å­˜å‚¨ä¸€ç»„äº’ä¸ç›¸ç­‰çš„å…ƒç´ ï¼Œé€šå¸¸æ²¡æœ‰å›ºå®šé¡ºåºã€‚
    - `Map` å­˜å‚¨ é”®-å€¼ å¯¹çš„æ•°æ®é›†åˆï¼Œé”®äº’ä¸ç›¸ç­‰ï¼Œä½†ä¸åŒçš„é”®å¯ä»¥å¯¹åº”ç›¸åŒçš„å€¼ã€‚

    Java ä¸­åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ï¼š 

    ```java
    â˜•ï¸
    List<String> strList = new ArrayList<>();
    strList.add("a");
    strList.add("b");
    strList.add("c"); // ğŸ‘ˆ æ·»åŠ å…ƒç´ ç¹ç
    
    ```

    Kotlin ä¸­åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ï¼š

    ```kotlin
    ğŸï¸            
    val strList = listOf("a", "b", "c")
    
    ```

    é¦–å…ˆèƒ½çœ‹åˆ°çš„æ˜¯ Kotlin ä¸­åˆ›å»ºä¸€ä¸ª `List` ç‰¹åˆ«çš„ç®€å•ï¼Œæœ‰ç‚¹åƒåˆ›å»ºæ•°ç»„çš„ä»£ç ã€‚è€Œä¸” Kotlin ä¸­çš„ `List` å¤šäº†ä¸€ä¸ªç‰¹æ€§ï¼šæ”¯æŒ covariantï¼ˆåå˜ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥æŠŠå­ç±»çš„ `List` èµ‹å€¼ç»™çˆ¶ç±»çš„ `List` å˜é‡ï¼š

    ```kotlin
    ğŸï¸
    val strs: List<String> = listOf("a", "b", "c")
                    ğŸ‘†
    val anys: List<Any> = strs // success
                   ğŸ‘†
    
    
    ```

    **å’Œæ•°ç»„çš„åŒºåˆ«:**

    Kotlin ä¸­æ•°ç»„å’Œ MutableList çš„ API æ˜¯éå¸¸åƒçš„ï¼Œä¸»è¦çš„åŒºåˆ«æ˜¯æ•°ç»„çš„å…ƒç´ ä¸ªæ•°ä¸èƒ½å˜ã€‚é‚£åœ¨ä»€ä¹ˆæ—¶å€™ç”¨æ•°ç»„å‘¢ï¼Ÿ

    - è¿™ä¸ªé—®é¢˜åœ¨ Java ä¸­å°±å­˜åœ¨äº†ï¼Œæ•°ç»„å’Œ `List` çš„åŠŸèƒ½ç±»ä¼¼ï¼Œ`List` çš„åŠŸèƒ½æ›´å¤šä¸€äº›ï¼Œç›´è§‰ä¸Šåº”è¯¥ç”¨ `List` ã€‚ä½†æ•°ç»„ä¹Ÿä¸æ˜¯æ²¡æœ‰ä¼˜åŠ¿ï¼ŒåŸºæœ¬ç±»å‹ (`int[]`ã€`float[]`) çš„æ•°ç»„ä¸ç”¨è‡ªåŠ¨è£…ç®±ï¼Œæ€§èƒ½å¥½ä¸€ç‚¹ã€‚
    - åœ¨ Kotlin ä¸­ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œåœ¨ä¸€äº›æ€§èƒ½éœ€æ±‚æ¯”è¾ƒè‹›åˆ»çš„åœºæ™¯ï¼Œå¹¶ä¸”å…ƒç´ ç±»å‹æ˜¯åŸºæœ¬ç±»å‹æ—¶ï¼Œç”¨æ•°ç»„å¥½ä¸€ç‚¹ã€‚ä¸è¿‡è¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ï¼ŒKotlin ä¸­è¦ç”¨ä¸“é—¨çš„åŸºæœ¬ç±»å‹æ•°ç»„ç±» (`IntArray` `FloatArray` `LongArray`) æ‰å¯ä»¥å…äºè£…ç®±ã€‚ä¹Ÿå°±æ˜¯è¯´å…ƒç´ ä¸æ˜¯åŸºæœ¬ç±»å‹æ—¶ï¼Œç›¸æ¯” `Array`ï¼Œç”¨ `List` æ›´æ–¹ä¾¿äº›ã€‚

    Java ä¸­åˆ›å»ºä¸€ä¸ª `Set`ï¼š

    ```java
    â˜•ï¸
    Set<String> strSet = new HashSet<>();
    strSet.add("a");
    strSet.add("b");
    strSet.add("c");
    
    ```

    - Kotlin ä¸­åˆ›å»ºç›¸åŒçš„ `Set`    

      ```kotlin
      val strSet = setOf("a", "b", "c")
      
      ```

    Java ä¸­åˆ›å»ºä¸€ä¸ª `Map`ï¼š

    ```java
    â˜•ï¸
    Map<String, Integer> map = new HashMap<>();
    map.put("key1", 1);
    map.put("key2", 2);
    map.put("key3", 3);
    map.put("key4", 3);
    
    ```

    Kotlin ä¸­åˆ›å»ºä¸€ä¸ª `Map`ï¼š

    ```kotlin
    ğŸï¸         
    val map = mapOf("key1" to 1, "key2" to 2, "key3" to 3, "key4" to 3)
    
    ```

    Kotlin ä¸­çš„ Map é™¤äº†å’Œ Java ä¸€æ ·å¯ä»¥ä½¿ç”¨ `get()` æ ¹æ®é”®è·å–å¯¹åº”çš„å€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·çš„æ–¹å¼è·å–ï¼š

    ```kotlin
    ğŸï¸
                     ğŸ‘‡
    val value1 = map.get("key1")
                   ğŸ‘‡
    val value2 = map["key2"]
    
    ```

    Kotlin ä¸­ä¹Ÿå¯ä»¥ç”¨æ–¹æ‹¬å·çš„æ–¹å¼æ”¹å˜ `Map` ä¸­é”®å¯¹åº”çš„å€¼ï¼š

    ```kotlin
    ğŸï¸       
                  ğŸ‘‡
    val map = mutableMapOf("key1" to 1, "key2" to 2)
        ğŸ‘‡
    map.put("key1", 2)
       ğŸ‘‡
    map["key1"] = 2   
    
    ```

    **å¯å˜é›†åˆ/ä¸å¯å˜é›†åˆ**

    Kotlin ä¸­é›†åˆåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šåªè¯»çš„å’Œå¯å˜çš„ã€‚è¿™é‡Œçš„åªè¯»æœ‰ä¸¤å±‚æ„æ€ï¼š

    - é›†åˆçš„ size ä¸å¯å˜
    - é›†åˆä¸­çš„å…ƒç´ å€¼ä¸å¯å˜

    ä»¥ä¸‹æ˜¯ä¸‰ç§é›†åˆç±»å‹åˆ›å»ºä¸å¯å˜å’Œå¯å˜å®ä¾‹çš„ä¾‹å­ï¼š

    - `listOf()` åˆ›å»ºä¸å¯å˜çš„ `List`ï¼Œ`mutableListOf()` åˆ›å»ºå¯å˜çš„ `List`ã€‚
    - `setOf()` åˆ›å»ºä¸å¯å˜çš„ `Set`ï¼Œ`mutableSetOf()` åˆ›å»ºå¯å˜çš„ `Set`ã€‚
    - `mapOf()` åˆ›å»ºä¸å¯å˜çš„ `Map`ï¼Œ`mutableMapOf()` åˆ›å»ºå¯å˜çš„ `Map`ã€‚

    å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ `mutable` å‰ç¼€çš„å‡½æ•°åˆ›å»ºçš„æ˜¯å¯å˜çš„é›†åˆï¼Œæ²¡æœ‰ `mutbale` å‰ç¼€çš„åˆ›å»ºçš„æ˜¯ä¸å¯å˜çš„é›†åˆï¼Œä¸è¿‡ä¸å¯å˜çš„å¯ä»¥é€šè¿‡ `toMutable*()` ç³»å‡½æ•°è½¬æ¢æˆå¯å˜çš„é›†åˆï¼š

    ```kotlin
    ğŸï¸
    val strList = listOf("a", "b", "c")
                ğŸ‘‡
    strList.toMutableList()
    val strSet = setOf("a", "b", "c")
                ğŸ‘‡
    strSet.toMutableSet()
    val map = mapOf("key1" to 1, "key2" to 2, "key3" to 3, "key4" to 3)
             ğŸ‘‡
    map.toMutableMap()
    
    ```

    ç„¶åå°±å¯ä»¥å¯¹é›†åˆè¿›è¡Œä¿®æ”¹äº†ï¼Œè¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ä¸‹ï¼š

    - `toMutable*()` è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å»ºçš„é›†åˆï¼ŒåŸæœ‰çš„é›†åˆè¿˜æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥åªèƒ½å¯¹å‡½æ•°è¿”å›çš„é›†åˆä¿®æ”¹ã€‚

21. #### Sequence

    é™¤äº†é›†åˆ Kotlin è¿˜å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å®¹å™¨ç±»å‹ `Sequence`ï¼Œå®ƒå’Œ `Iterable` ä¸€æ ·ç”¨æ¥éå†ä¸€ç»„æ•°æ®å¹¶å¯ä»¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œç‰¹å®šçš„å¤„ç†ã€‚

    ```kotlin
    ğŸï¸
    sequenceOf("a", "b", "c")
    
    ğŸï¸
    val list = listOf("a", "b", "c")
    list.asSequence()
    
    ğŸï¸                          // ğŸ‘‡ ç¬¬ä¸€ä¸ªå…ƒç´ 
    val sequence = generateSequence(0) { it + 1 }
                                      // ğŸ‘† lambda è¡¨è¾¾å¼ï¼Œè´Ÿè´£ç”Ÿæˆç¬¬äºŒä¸ªåŠä»¥åçš„å…ƒç´ ï¼Œit è¡¨ç¤ºå‰ä¸€ä¸ªå…ƒç´ 
    
    ```

22. #### å¯è§æ€§ä¿®é¥°ç¬¦

    Kotlin ä¸­æœ‰å››ç§å¯è§æ€§ä¿®é¥°ç¬¦ï¼š

    - `public`ï¼šå…¬å¼€ï¼Œå¯è§æ€§æœ€å¤§ï¼Œå“ªé‡Œéƒ½å¯ä»¥å¼•ç”¨ã€‚
    - `private`ï¼šç§æœ‰ï¼Œå¯è§æ€§æœ€å°ï¼Œæ ¹æ®å£°æ˜ä½ç½®ä¸åŒå¯åˆ†ä¸ºç±»ä¸­å¯è§å’Œæ–‡ä»¶ä¸­å¯è§ã€‚
    - `protected`ï¼šä¿æŠ¤ï¼Œç›¸å½“äº `private` + å­ç±»å¯è§ã€‚
    - `internal`ï¼šå†…éƒ¨ï¼Œä»…å¯¹ module å†…å¯è§ã€‚

    #### `public`

    Java ä¸­æ²¡å†™å¯è§æ€§ä¿®é¥°ç¬¦æ—¶ï¼Œè¡¨ç¤ºåŒ…å†…å¯è§ï¼Œåªæœ‰åœ¨åŒä¸€ä¸ª `package` å†…å¯ä»¥å¼•ç”¨ï¼Œ`package` å¤–å¦‚æœè¦å¼•ç”¨ï¼Œéœ€è¦åœ¨ `class` å‰åŠ ä¸Šå¯è§æ€§ä¿®é¥°ç¬¦ `public` è¡¨ç¤ºå…¬å¼€ã€‚

    Kotlin ä¸­å¦‚æœä¸å†™å¯è§æ€§ä¿®é¥°ç¬¦ï¼Œå°±è¡¨ç¤ºå…¬å¼€ï¼Œå’Œ Java ä¸­ `public` ä¿®é¥°ç¬¦å…·æœ‰ç›¸åŒæ•ˆæœã€‚åœ¨ Kotlin ä¸­ `public` ä¿®é¥°ç¬¦ã€Œå¯ä»¥åŠ ï¼Œä½†æ²¡å¿…è¦ã€ã€‚

    #### `@hide`

    åœ¨ Android çš„å®˜æ–¹ sdk ä¸­ï¼Œæœ‰ä¸€äº›æ–¹æ³•åªæƒ³å¯¹ sdk å†…å¯è§ï¼Œä¸æƒ³å¼€æ”¾ç»™ç”¨æˆ·ä½¿ç”¨ï¼ˆå› ä¸ºè¿™äº›æ–¹æ³•ä¸å¤ªç¨³å®šï¼Œåœ¨åç»­ç‰ˆæœ¬ä¸­å¾ˆæœ‰å¯èƒ½ä¼šä¿®æ”¹æˆ–åˆ æ‰ï¼‰ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç‰¹æ€§ï¼Œä¼šåœ¨æ–¹æ³•çš„æ³¨é‡Šä¸­æ·»åŠ ä¸€ä¸ª Javadoc æ–¹æ³• `@hide`ï¼Œç”¨æ¥é™åˆ¶å®¢æˆ·ç«¯è®¿é—®ï¼š

    ```java
    â˜•ï¸
    /**
    * @hide ğŸ‘ˆ
    */
    public void hideMethod() {
        ...
    }
    
    ```

    ä½†è¿™ç§é™åˆ¶ä¸å¤ªä¸¥æ ¼ï¼Œå¯ä»¥é€šè¿‡åå°„è®¿é—®åˆ°é™åˆ¶çš„æ–¹æ³•ã€‚é’ˆå¯¹è¿™ä¸ªæƒ…å†µï¼ŒKotlin å¼•è¿›äº†ä¸€ä¸ªæ›´ä¸ºä¸¥æ ¼çš„å¯è§æ€§ä¿®é¥°ç¬¦ï¼š`internal`ã€‚

    #### `internal`

    `internal` è¡¨ç¤ºä¿®é¥°çš„ç±»ã€å‡½æ•°ä»…å¯¹ module å†…å¯è§ï¼Œè¿™é‡Œçš„ module å…·ä½“æŒ‡çš„æ˜¯ä¸€ç»„å…±åŒç¼–è¯‘çš„ kotlin æ–‡ä»¶ï¼Œå¸¸è§çš„å½¢å¼æœ‰ï¼š

    - Android Studio é‡Œçš„ module
    - Maven project

    > æˆ‘ä»¬å¸¸è§çš„æ˜¯ Android Studio ä¸­çš„ module è¿™ç§æƒ…å†µï¼ŒMaven project ä»…ä½œäº†è§£å°±å¥½ï¼Œä¸ç”¨ç»†ç©¶ã€‚

    `internal` åœ¨å†™ä¸€ä¸ª library module æ—¶éå¸¸æœ‰ç”¨ï¼Œå½“éœ€è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°ä»…å¼€æ”¾ç»™ module å†…éƒ¨ä½¿ç”¨ï¼Œä¸æƒ³å¯¹ library çš„ä½¿ç”¨è€…å¯è§ï¼Œè¿™æ—¶å°±åº”è¯¥ç”¨ `internal` å¯è§æ€§ä¿®é¥°ç¬¦ã€‚

    #### `protected`

    - Java ä¸­ `protected` è¡¨ç¤ºåŒ…å†…å¯è§ + å­ç±»å¯è§ã€‚
    - Kotlin ä¸­ `protected` è¡¨ç¤º `private` + å­ç±»å¯è§ã€‚

    Kotlin ç›¸æ¯” Java `protected` çš„å¯è§èŒƒå›´æ”¶çª„äº†ï¼ŒåŸå› æ˜¯ Kotlin ä¸­ä¸å†æœ‰ã€ŒåŒ…å†…å¯è§ã€çš„æ¦‚å¿µäº†ï¼Œç›¸æ¯” Java çš„å¯è§æ€§ç€çœ¼äº `package`ï¼ŒKotlin æ›´å…³å¿ƒçš„æ˜¯ moduleã€‚

    #### `private`

    - Java ä¸­çš„ `private` è¡¨ç¤ºç±»ä¸­å¯è§ï¼Œä½œä¸ºå†…éƒ¨ç±»æ—¶å¯¹å¤–éƒ¨ç±»ã€Œå¯è§ã€ã€‚
    - Kotlin ä¸­çš„ `private` è¡¨ç¤ºç±»ä¸­æˆ–æ‰€åœ¨æ–‡ä»¶å†…å¯è§ï¼Œä½œä¸ºå†…éƒ¨ç±»æ—¶å¯¹å¤–éƒ¨ç±»ã€Œä¸å¯è§ã€ã€‚

    `private` ä¿®é¥°çš„å˜é‡ã€Œç±»ä¸­å¯è§ã€å’Œ ã€Œæ–‡ä»¶ä¸­å¯è§ã€:

    ```kotlin
    ğŸï¸
    class Sample {
        private val propertyInClass = 1 // ğŸ‘ˆ ä»… Sample ç±»ä¸­å¯è§
    }
    
    private val propertyInFile = "A string." // ğŸ‘ˆ èŒƒå›´æ›´å¤§ï¼Œæ•´ä¸ªæ–‡ä»¶å¯è§
    
    ```

    åœ¨ Java ä¸­ï¼Œå¤–éƒ¨ç±»å¯ä»¥è®¿é—®å†…éƒ¨ç±»çš„ `private` å˜é‡

    ```java
    â˜•ï¸
    public class Outter {
        public void method() {
            Inner inner = new Inner();
                                ğŸ‘‡
            int result = inner.number * 2; // success
        }
        
        private class Inner {
            private int number = 0;
        }
    }
    
    ```

    åœ¨ Kotlin ä¸­ï¼Œå¤–éƒ¨ç±»ä¸å¯ä»¥è®¿é—®å†…éƒ¨ç±»çš„ `private` å˜é‡ï¼š

    ```kotlin
    ğŸï¸
    class Outter {
        fun method() {
            val inner = Inner()
                                ğŸ‘‡
            val result = inner.number * 2 // compile-error: Cannot access 'number': it is private in 'Inner'
        }
        
        class Inner {
            private val number = 1
        }
    }
    
    ```

    **å¯ä»¥ä¿®é¥°ç±»å’Œæ¥å£**

    - Java ä¸­ä¸€ä¸ªæ–‡ä»¶åªå…è®¸ä¸€ä¸ªå¤–éƒ¨ç±»ï¼Œæ‰€ä»¥ `class` å’Œ `interface` ä¸å…è®¸è®¾ç½®ä¸º `private`ï¼Œå› ä¸ºå£°æ˜ `private` åæ— æ³•è¢«å¤–éƒ¨ä½¿ç”¨ï¼Œè¿™æ ·å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚

    - Kotlin å…è®¸åŒä¸€ä¸ªæ–‡ä»¶å£°æ˜å¤šä¸ª `class` å’Œ top-level çš„å‡½æ•°å’Œå±æ€§ï¼Œæ‰€ä»¥ Kotlin ä¸­å…è®¸ç±»å’Œæ¥å£å£°æ˜ä¸º `private`ï¼Œå› ä¸ºåŒä¸ªæ–‡ä»¶ä¸­çš„å…¶å®ƒæˆå‘˜å¯ä»¥è®¿é—®ï¼š

      ```kotlin
      ğŸï¸                   
      private class Sample {
          val number = 1
          fun method() {
              println("Sample method()")
          }
      }
                  // ğŸ‘‡ åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®
      val sample = Sample()
      
      ```

23. ### æ„é€ å™¨

    #### ä¸»æ„é€ å™¨

    Kotlin ä¸­ constructor çš„å†™æ³•ï¼š

    ```kotlin
    ğŸï¸
    class User {
        var name: String
        constructor(name: String) {
            this.name = name
        }
    }
    
    ```

    Kotlin ä¸­è¿˜æœ‰æ›´ç®€å•çš„æ–¹æ³•æ¥å†™æ„é€ å™¨

    ```kotlin
    class User constructor(name: String) {
        //                  ğŸ‘‡ è¿™é‡Œä¸æ„é€ å™¨ä¸­çš„ name æ˜¯åŒä¸€ä¸ª
        var name: String = name
    }
    
    
    ```

    - `constructor` æ„é€ å™¨ç§»åˆ°äº†ç±»åä¹‹å
    - ç±»çš„å±æ€§ `name` å¯ä»¥å¼•ç”¨æ„é€ å™¨ä¸­çš„å‚æ•° `name`

    è¿™ä¸ªå†™æ³•å«ã€Œä¸»æ„é€ å™¨ primary constructorã€ã€‚

    åœ¨ Kotlin ä¸­ä¸€ä¸ªç±»æœ€å¤šåªèƒ½æœ‰ 1 ä¸ªä¸»æ„é€ å™¨ï¼ˆä¹Ÿå¯ä»¥æ²¡æœ‰ï¼‰ï¼Œè€Œæ¬¡æ„é€ å™¨æ˜¯æ²¡æœ‰ä¸ªæ•°é™åˆ¶ã€‚

    ä¸»æ„é€ å™¨ä¸­çš„å‚æ•°é™¤äº†å¯ä»¥åœ¨ç±»çš„å±æ€§ä¸­ä½¿ç”¨ï¼Œè¿˜å¯ä»¥åœ¨ `init` ä»£ç å—ä¸­ä½¿ç”¨ï¼š

    ```kotlin
    ğŸï¸
    class User constructor(name: String) {
        var name: String
        init {
            this.name = name
        }
    }
    
    ```

    å…¶ä¸­ `init` ä»£ç å—æ˜¯ç´§è·Ÿåœ¨ä¸»æ„é€ å™¨ä¹‹åæ‰§è¡Œçš„ï¼Œè¿™æ˜¯å› ä¸ºä¸»æ„é€ å™¨æœ¬èº«æ²¡æœ‰ä»£ç ä½“ï¼Œ`init` ä»£ç å—å°±å……å½“äº†ä¸»æ„é€ å™¨ä»£ç ä½“çš„åŠŸèƒ½ã€‚

    å¦å¤–ï¼Œå¦‚æœç±»ä¸­æœ‰ä¸»æ„é€ å™¨ï¼Œé‚£ä¹ˆå…¶ä»–çš„æ¬¡æ„é€ å™¨éƒ½éœ€è¦é€šè¿‡ `this` å…³é”®å­—è°ƒç”¨ä¸»æ„é€ å™¨ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æˆ–è€…é€šè¿‡åˆ«çš„æ¬¡æ„é€ å™¨é—´æ¥è°ƒç”¨ã€‚å¦‚æœä¸è°ƒç”¨ IDE å°±ä¼šæŠ¥é”™ï¼š

    ```kotlin
    ğŸï¸
    class User constructor(var name: String) {
        constructor(name: String, id: Int) {
        // ğŸ‘†è¿™æ ·å†™ä¼šæŠ¥é”™ï¼ŒPrimary constructor call expected
        }
    }
    
    ```

    ä¸ºä»€ä¹ˆå½“ç±»ä¸­æœ‰ä¸»æ„é€ å™¨çš„æ—¶å€™å°±å¼ºåˆ¶è¦æ±‚æ¬¡æ„é€ å™¨è°ƒç”¨ä¸»æ„é€ å™¨å‘¢ï¼Ÿ

    æˆ‘ä»¬ä»ä¸»æ„é€ å™¨çš„ç‰¹æ€§å‡ºå‘ï¼Œä¸€æ—¦åœ¨ç±»ä¸­å£°æ˜äº†ä¸»æ„é€ å™¨ï¼Œå°±åŒ…å«ä¸¤ç‚¹ï¼š

    - å¿…é¡»æ€§ï¼šåˆ›å»ºç±»çš„å¯¹è±¡æ—¶ï¼Œä¸ç®¡ä½¿ç”¨å“ªä¸ªæ„é€ å™¨ï¼Œéƒ½éœ€è¦ä¸»æ„é€ å™¨çš„å‚ä¸
    - ç¬¬ä¸€æ€§ï¼šåœ¨ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆæ‰§è¡Œçš„å°±æ˜¯ä¸»æ„é€ å™¨

    å½“ä¸€ä¸ªç±»ä¸­åŒæ—¶æœ‰ä¸»æ„é€ å™¨ä¸æ¬¡æ„é€ å™¨çš„æ—¶å€™ï¼Œéœ€è¦è¿™æ ·å†™ï¼š

    ```kotlin
    ğŸï¸
    class User constructor(var name: String) {
                                       // ğŸ‘‡  ğŸ‘‡ ç›´æ¥è°ƒç”¨ä¸»æ„é€ å™¨
        constructor(name: String, id: Int) : this(name) {
        }
                                                    // ğŸ‘‡ é€šè¿‡ä¸Šä¸€ä¸ªæ¬¡æ„é€ å™¨ï¼Œé—´æ¥è°ƒç”¨ä¸»æ„é€ å™¨
        constructor(name: String, id: Int, age: Int) : this(name, id) {
        }
    }
    
    ```

    åœ¨ä½¿ç”¨æ¬¡æ„é€ å™¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œ`init` ä»£ç å—æ˜¯å…ˆäºæ¬¡æ„é€ å™¨æ‰§è¡Œçš„ã€‚å¦‚æœæŠŠä¸»æ„é€ å™¨çœ‹æˆèº«ä½“çš„å¤´éƒ¨ï¼Œé‚£ä¹ˆ `init` ä»£ç å—å°±æ˜¯é¢ˆéƒ¨ï¼Œæ¬¡æ„é€ å™¨å°±ç›¸å½“äºèº«ä½“å…¶ä½™éƒ¨åˆ†ã€‚

    ç»†å¿ƒçš„ä½ ä¹Ÿè®¸ä¼šå‘ç°è¿™é‡Œåˆå‡ºç°äº† `:` ç¬¦å·ï¼Œå®ƒè¿˜åœ¨å…¶ä»–åœºåˆå‡ºç°è¿‡ï¼Œä¾‹å¦‚ï¼š

    - å˜é‡çš„å£°æ˜ï¼š`var id: Int`
    - ç±»çš„ç»§æ‰¿ï¼š`class MainActivity : AppCompatActivity() {}`
    - æ¥å£çš„å®ç°ï¼š`class User : Impl {}`
    - åŒ¿åç±»çš„åˆ›å»ºï¼š`object: ViewPager.SimpleOnPageChangeListener() {}`
    - å‡½æ•°çš„è¿”å›å€¼ï¼š`fun sum(a: Int, b: Int): Int`

    å¯ä»¥çœ‹å‡º `:` ç¬¦å·åœ¨ Kotlin ä¸­éå¸¸é«˜é¢‘å‡ºç°ï¼Œå®ƒå…¶å®è¡¨ç¤ºäº†ä¸€ç§ä¾èµ–å…³ç³»ï¼Œåœ¨è¿™é‡Œè¡¨ç¤ºä¾èµ–äºä¸»æ„é€ å™¨ã€‚

    é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸»æ„é€ å™¨ä¸­çš„ `constructor` å…³é”®å­—å¯ä»¥çœç•¥ï¼š

    ```kotlin
    ğŸï¸
    class User(name: String) {
        var name: String = name
    }
    
    ```

    ä½†æœ‰äº›åœºæ™¯ï¼Œ`constructor` æ˜¯ä¸å¯ä»¥çœç•¥çš„ï¼Œä¾‹å¦‚åœ¨ä¸»æ„é€ å™¨ä¸Šä½¿ç”¨ã€Œå¯è§æ€§ä¿®é¥°ç¬¦ã€æˆ–è€…ã€Œæ³¨è§£ã€ï¼š

    ```kotlin
    ğŸï¸
    class User private constructor(name: String) {
    //           ğŸ‘† ä¸»æ„é€ å™¨è¢«ä¿®é¥°ä¸ºç§æœ‰çš„ï¼Œå¤–éƒ¨å°±æ— æ³•è°ƒç”¨è¯¥æ„é€ å™¨
    }
    
    ```

    #### ä¸»æ„é€ å™¨é‡Œå£°æ˜å±æ€§

    å¯ä»¥åœ¨ä¸»æ„é€ å™¨ä¸­ç›´æ¥å£°æ˜å±æ€§ï¼š

    ```kotlin
    ğŸï¸
               ğŸ‘‡
    class User(var name: String) {
    }
    // ç­‰ä»·äºï¼š
    class User(name: String) {
      var name: String = name
    }
    
    ```

    å¦‚æœåœ¨ä¸»æ„é€ å™¨çš„å‚æ•°å£°æ˜æ—¶åŠ ä¸Š `var` æˆ–è€… `val`ï¼Œå°±ç­‰ä»·äºåœ¨ç±»ä¸­åˆ›å»ºäº†è¯¥åç§°çš„å±æ€§ï¼ˆpropertyï¼‰ï¼Œå¹¶ä¸”åˆå§‹å€¼å°±æ˜¯ä¸»æ„é€ å™¨ä¸­è¯¥å‚æ•°çš„å€¼ã€‚

    

    å…³äºä¸»æ„é€ å™¨ç›¸å…³çš„çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ç±»çš„åˆå§‹åŒ–å†™æ³•ï¼š

    é¦–å…ˆåˆ›å»ºä¸€ä¸ª `User` ç±»ï¼š

    ```kotlin
    ğŸï¸
    class User {
    }
    
    ```

    æ·»åŠ ä¸€ä¸ªå‚æ•°ä¸º `name` ä¸ `id` çš„ä¸»æ„é€ å™¨ï¼š

    ```kotlin
    ğŸï¸
    class User(name: String, id: String) {
    }
    
    ```

    å°†ä¸»æ„é€ å™¨ä¸­çš„ `name` ä¸ `id` å£°æ˜ä¸ºç±»çš„å±æ€§ï¼š

    ```kotlin
    ğŸï¸
    class User(val name: String, val id: String) {
    }
    
    ```

    ç„¶ååœ¨ `init` ä»£ç å—ä¸­æ·»åŠ ä¸€äº›åˆå§‹åŒ–é€»è¾‘ï¼š

    ```kotlin
    ğŸï¸
    class User(val name: String, val id: String) {
        init {
            ...
        }
    }
    
    ```

    æœ€åå†æ·»åŠ å…¶ä»–æ¬¡æ„é€ å™¨ï¼š

    ```kotlin
    ğŸï¸
    class User(val name: String, val id: String) {
        init {
            ...
        }
        
        constructor(person: Person) : this(person.name, person.id) {
        }
    }
    
    ```

    - å½“ä¸€ä¸ªç±»æœ‰å¤šä¸ªæ„é€ å™¨æ—¶ï¼Œåªéœ€è¦æŠŠæœ€åŸºæœ¬ã€æœ€é€šç”¨çš„é‚£ä¸ªå†™æˆä¸»æ„é€ å™¨å°±è¡Œäº†ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©å°†å‚æ•°ä¸º `name` ä¸ `id` çš„æ„é€ å™¨ä½œä¸ºä¸»æ„é€ å™¨ã€‚

24. ### å‡½æ•°ç®€åŒ–

    #### ä½¿ç”¨ `=` è¿æ¥è¿”å›å€¼

    ```kotlin
    ğŸï¸
    fun area(width: Int, height: Int): Int {
        return width * height
    }
    
    
                                          ğŸ‘‡
    fun area(width: Int, height: Int): Int = width * height
    
    
    //                               ğŸ‘‡çœç•¥äº†è¿”å›ç±»å‹  ç±»å‹æ¨æ–­
    fun area(width: Int, height: Int) = width * height
    
    //å¯¹äºæ²¡æœ‰è¿”å›å€¼çš„æƒ…å†µï¼Œå¯ä»¥ç†è§£ä¸ºè¿”å›å€¼æ˜¯ Unitï¼š
    fun sayHi(name: String) {
        println("Hi " + name)
    }
    
                           ğŸ‘‡
    fun sayHi(name: String) = println("Hi " + name)
    
    ```

25. #### å‚æ•°é»˜è®¤å€¼

    Java ä¸­ï¼Œå…è®¸åœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªåç§°ç›¸åŒçš„æ–¹æ³•ï¼Œä½†æ˜¯å‚æ•°çš„ç±»å‹æˆ–ä¸ªæ•°å¿…é¡»ä¸åŒï¼Œè¿™å°±æ˜¯æ–¹æ³•çš„é‡è½½ï¼š

    ```java
    â˜•ï¸
    public void sayHi(String name) {
        System.out.println("Hi " + name);
    }
    â€‹
    public void sayHi() {
        sayHi("world"); 
    }
    
    
    ```

    åœ¨ Kotlin ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¿™æ ·çš„æ–¹å¼è¿›è¡Œå‡½æ•°çš„é‡è½½ï¼Œä¸è¿‡è¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹å¼ï¼Œé‚£å°±æ˜¯ã€Œå‚æ•°é»˜è®¤å€¼ã€ï¼š

    ```kotlin
    ğŸï¸
                               ğŸ‘‡
    fun sayHi(name: String = "world") = println("Hi " + name)
    
    ```

26. #### å‘½åå‚æ•°

    ```kotlin
    ğŸï¸
    fun sayHi(name: String = "world", age: Int) {
        ...
    }
          ğŸ‘‡   
    sayHi(age = 21)
    
    ```

    çœ‹ä¸€ä¸ªæœ‰éå¸¸å¤šå‚æ•°çš„å‡½æ•°çš„ä¾‹å­ï¼š

    ```kotlin
    ğŸï¸ 
    fun sayHi(name: String = "world", age: Int, isStudent: Boolean = true, isFat: Boolean = true, isTall: Boolean = true) {
        ...
    }
    
    
    ğŸï¸
    sayHi("world", 21, false, true, false)
    
    
    //å½“çœ‹åˆ°åé¢ä¸€é•¿ä¸²çš„å¸ƒå°”å€¼æ—¶ï¼Œæˆ‘ä»¬å¾ˆéš¾åˆ†æ¸…æ¥šæ¯ä¸ªå‚æ•°çš„ç”¨å¤„ï¼Œå¯è¯»æ€§å¾ˆå·®ã€‚é€šè¿‡å‘½åå‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿™ä¹ˆå†™ï¼š
    
    sayHi(name = "wo", age = 21, isStudent = false, isFat = true, isTall = false)
    
    
    ```

    ä¸å‘½åå‚æ•°ç›¸å¯¹çš„ä¸€ä¸ªæ¦‚å¿µè¢«ç§°ä¸ºã€Œä½ç½®å‚æ•°ã€ï¼Œä¹Ÿå°±æ˜¯æŒ‰ä½ç½®é¡ºåºè¿›è¡Œå‚æ•°å¡«å†™ã€‚

    å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå¦‚æœæ··ç”¨ä½ç½®å‚æ•°ä¸å‘½åå‚æ•°ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„ä½ç½®å‚æ•°éƒ½åº”è¯¥æ”¾åœ¨ç¬¬ä¸€ä¸ªå‘½åå‚æ•°ä¹‹å‰ï¼š

    ```kotlin
    ğŸï¸
    fun sayHi(name: String = "world", age: Int) {
        ...
    }
    
    sayHi(name = "wo", 21) // ğŸ‘ˆ IDE ä¼šæŠ¥é”™ï¼ŒMixing named and positioned arguments is not allowed
    sayHi("wo", age = 21) // ğŸ‘ˆ è¿™æ˜¯æ­£ç¡®çš„å†™æ³•
    
    ```

27. #### æœ¬åœ°å‡½æ•°ï¼ˆåµŒå¥—å‡½æ•°ï¼‰

    ```kotlin
    ğŸï¸
    fun login(user: String, password: String, illegalStr: String) {
        // éªŒè¯ user æ˜¯å¦ä¸ºç©º
        if (user.isEmpty()) {
            throw IllegalArgumentException(illegalStr)
        }
        // éªŒè¯ password æ˜¯å¦ä¸ºç©º
        if (password.isEmpty()) {
            throw IllegalArgumentException(illegalStr)
        }
    }
    
    ```

    è¯¥å‡½æ•°ä¸­ï¼Œæ£€æŸ¥å‚æ•°è¿™ä¸ªéƒ¨åˆ†æœ‰äº›å†—ä½™ï¼Œæˆ‘ä»¬åˆä¸æƒ³å°†è¿™æ®µé€»è¾‘ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å‡½æ•°å¯¹å¤–æš´éœ²ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨åµŒå¥—å‡½æ•°ï¼Œåœ¨ `login` å‡½æ•°å†…éƒ¨å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼š

    ```kotlin
    ğŸï¸
    fun login(user: String, password: String, illegalStr: String) {
               ğŸ‘‡ 
        fun validate(value: String, illegalStr: String) {
          if (value.isEmpty()) {
              throw IllegalArgumentException(illegalStr)
          }
        }
       ğŸ‘‡
        validate(user, illegalStr)
        validate(password, illegalStr)
    }
    
    ```

    è¿™é‡Œæˆ‘ä»¬å°†å…±åŒçš„éªŒè¯é€»è¾‘æ”¾è¿›äº†åµŒå¥—å‡½æ•° `validate` ä¸­ï¼Œå¹¶ä¸” `login` å‡½æ•°ä¹‹å¤–çš„å…¶ä»–åœ°æ–¹æ— æ³•è®¿é—®è¿™ä¸ªåµŒå¥—å‡½æ•°ã€‚

    è¿™é‡Œçš„ `illegalStr` æ˜¯é€šè¿‡å‚æ•°çš„æ–¹å¼ä¼ è¿›åµŒå¥—å‡½æ•°ä¸­çš„ï¼Œå…¶å®å®Œå…¨æ²¡æœ‰è¿™ä¸ªå¿…è¦ï¼Œå› ä¸º**åµŒå¥—å‡½æ•°ä¸­å¯ä»¥è®¿é—®åœ¨å®ƒå¤–éƒ¨çš„æ‰€æœ‰å˜é‡æˆ–å¸¸é‡ï¼Œä¾‹å¦‚ç±»ä¸­çš„å±æ€§ã€å½“å‰å‡½æ•°ä¸­çš„å‚æ•°ä¸å˜é‡ç­‰ã€‚**

    

    æˆ‘ä»¬ç¨åŠ æ”¹è¿›ï¼š

    ```kotlin
    ğŸï¸
    fun login(user: String, password: String, illegalStr: String) {
        fun validate(value: String) {
            if (value.isEmpty()) {
                                                  ğŸ‘‡
                throw IllegalArgumentException(illegalStr)
            }
        }
        ...
    }
    
    ```

    è¿™é‡Œçœå»äº†åµŒå¥—å‡½æ•°ä¸­çš„ `illegalStr` å‚æ•°ï¼Œåœ¨è¯¥åµŒå¥—å‡½æ•°å†…ç›´æ¥ä½¿ç”¨å¤–å±‚å‡½æ•° `login` çš„å‚æ•° `illegalStr`ã€‚

    ä¸Šé¢ `login` å‡½æ•°ä¸­çš„éªŒè¯é€»è¾‘ï¼Œå…¶å®è¿˜æœ‰å¦ä¸€ç§æ›´ç®€å•çš„æ–¹å¼ï¼š

    ```kotlin
    ğŸï¸
    fun login(user: String, password: String, illegalStr: String) {
        require(user.isNotEmpty()) { illegalStr }
        require(password.isNotEmpty()) { illegalStr }
    }
    
    ```

    å…¶ä¸­ç”¨åˆ°äº† lambda è¡¨è¾¾å¼ä»¥åŠ Kotlin å†…ç½®çš„ `require` å‡½æ•°ã€‚

28. ### å­—ç¬¦ä¸²

    #### å­—ç¬¦ä¸²æ¨¡æ¿

    åœ¨ Java ä¸­ï¼Œå­—ç¬¦ä¸²ä¸å˜é‡ä¹‹é—´æ˜¯ä½¿ç”¨ `+` ç¬¦å·è¿›è¡Œæ‹¼æ¥çš„ï¼ŒKotlin ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼š

    ```kotlin
    ğŸï¸
    val name = "world"
    println("Hi " + name)
    
    ```

    ä½†æ˜¯å½“å˜é‡æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œå¯è¯»æ€§ä¼šå˜å·®ï¼Œå†™èµ·æ¥ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚

    Java ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯ `String.format`ï¼š

    ```java
    â˜•ï¸
    System.out.print(String.format("Hi %s", name));
    
    ```

    Kotlin ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æ›´åŠ æ–¹ä¾¿çš„å†™æ³•ï¼š

    ```kotlin
    ğŸï¸
    val name = "world"
    //         ğŸ‘‡ ç”¨ '$' ç¬¦å·åŠ å‚æ•°çš„æ–¹å¼
    println("Hi $name")
    
    ```

    è¿™ç§æ–¹å¼å°±æ˜¯æŠŠ `name` ä»åç½®æ”¹ä¸ºå‰ç½®ï¼Œç®€åŒ–ä»£ç çš„åŒæ—¶å¢åŠ äº†å­—ç¬¦ä¸²çš„å¯è¯»æ€§ã€‚

    é™¤äº†å˜é‡ï¼Œ`$` åè¿˜å¯ä»¥è·Ÿè¡¨è¾¾å¼ï¼Œä½†è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨ `{}` ç»™å®ƒåŒ…èµ·æ¥ï¼š

    ```kotlin
    ğŸï¸
    val name = "world"
    println("Hi ${name.length}") 
    
    ```

    å…¶å®å°±è·Ÿå››åˆ™è¿ç®—çš„æ‹¬å·ä¸€æ ·ï¼Œæé«˜è¯­æ³•ä¸Šçš„ä¼˜å…ˆçº§ï¼Œè€Œå•ä¸ªå˜é‡çš„åœºæ™¯å¯ä»¥çœç•¥ `{}`ã€‚

    å­—ç¬¦ä¸²æ¨¡æ¿è¿˜æ”¯æŒè½¬ä¹‰å­—ç¬¦ï¼Œæ¯”å¦‚ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ `\n` è¿›è¡Œæ¢è¡Œæ“ä½œï¼š

    ```kotlin
    ğŸï¸
    val name = "world!\n"
    println("Hi $name") // ğŸ‘ˆ ä¼šå¤šæ‰“ä¸€ä¸ªç©ºè¡Œ
    
    ```

    #### raw string (åŸç”Ÿå­—ç¬¦ä¸²)

    æœ‰æ—¶å€™æˆ‘ä»¬ä¸å¸Œæœ›å†™è¿‡å¤šçš„è½¬ä¹‰å­—ç¬¦ï¼Œè¿™ç§æƒ…å†µ Kotlin é€šè¿‡ã€ŒåŸç”Ÿå­—ç¬¦ä¸²ã€æ¥å®ç°ã€‚

    ç”¨æ³•å°±æ˜¯ä½¿ç”¨ä¸€å¯¹ `"""` å°†å­—ç¬¦ä¸²æ‹¬èµ·æ¥ï¼š

    ```kotlin
    ğŸï¸
    val name = "world"
    val myName = "kotlin"
               ğŸ‘‡
    val text = """
          Hi $name!
        My name is $myName.\n
    """
    println(text)
    
    ```

    - `\n` å¹¶ä¸ä¼šè¢«è½¬ä¹‰
    - æœ€åè¾“å‡ºçš„å†…å®¹ä¸å†™çš„å†…å®¹å®Œå…¨ä¸€è‡´ï¼ŒåŒ…æ‹¬å®é™…çš„æ¢è¡Œ
    - `$` ç¬¦å·å¼•ç”¨å˜é‡ä»ç„¶ç”Ÿæ•ˆ

    è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

    ```kotlin
      Hi world!
        My name is kotlin.\n
    
    ```

    å¯¹é½æ–¹å¼çœ‹èµ·æ¥ä¸å¤ªä¼˜é›…ï¼ŒåŸç”Ÿå­—ç¬¦ä¸²è¿˜å¯ä»¥é€šè¿‡ `trimMargin()` å‡½æ•°å»é™¤æ¯è¡Œå‰é¢çš„ç©ºæ ¼ï¼š

    ```kotlin
    ğŸï¸
    val text = """
         ğŸ‘‡ 
          |Hi world!
        |My name is kotlin.
    """.trimMargin()
    println(text)
    
    ```

    è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

    ```kotlin
    Hi world!
    My name is kotlin.
    
    ```

    è¿™é‡Œçš„ `trimMargin()` å‡½æ•°æœ‰ä»¥ä¸‹å‡ ä¸ªæ³¨æ„ç‚¹ï¼š

    - `|` ç¬¦å·ä¸ºé»˜è®¤çš„è¾¹ç•Œå‰ç¼€ï¼Œå‰é¢åªèƒ½æœ‰ç©ºæ ¼ï¼Œå¦åˆ™ä¸ä¼šç”Ÿæ•ˆ
    - è¾“å‡ºæ—¶ `|` ç¬¦å·ä»¥åŠå®ƒå‰é¢çš„ç©ºæ ¼éƒ½ä¼šè¢«åˆ é™¤
    - è¾¹ç•Œå‰ç¼€è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–å­—ç¬¦ï¼Œæ¯”å¦‚ `trimMargin("/")`ï¼Œåªä¸è¿‡ä¸Šæ–¹çš„ä»£ç ä½¿ç”¨çš„æ˜¯å‚æ•°é»˜è®¤å€¼çš„è°ƒç”¨æ–¹å¼ã€‚

29. ### æ•°ç»„å’Œé›†åˆ

    #### æ•°ç»„ä¸é›†åˆçš„æ“ä½œç¬¦

    å£°æ˜å¦‚ä¸‹ `IntArray` å’Œ `List`ï¼š

    ```kotlin
    ğŸï¸
    val intArray = intArrayOf(1, 2, 3)
    val strList = listOf("a", "b", "c")
    
    ```

    `forEach`ï¼šéå†æ¯ä¸€ä¸ªå…ƒç´ 

    ```kotlin
    ğŸï¸
    //              ğŸ‘‡ lambda è¡¨è¾¾å¼ï¼Œi è¡¨ç¤ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ 
    intArray.forEach { i ->
        print(i + " ")
    }
    // è¾“å‡ºï¼š1 2 3 
    
    ```

    `filter`ï¼šå¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œè¿‡æ»¤æ“ä½œï¼Œå¦‚æœ lambda è¡¨è¾¾å¼ä¸­çš„æ¡ä»¶æˆç«‹åˆ™ç•™ä¸‹è¯¥å…ƒç´ ï¼Œå¦åˆ™å‰”é™¤ï¼Œæœ€ç»ˆç”Ÿæˆæ–°çš„é›†åˆ

    ```kotlin
    ğŸï¸
    // [1, 2, 3]
          â¬‡ï¸
    //  {2, 3}
    
    //            ğŸ‘‡ æ³¨æ„ï¼Œè¿™é‡Œå˜æˆäº† List
    val newList: List = intArray.filter { i ->
        i != 1 // ğŸ‘ˆ è¿‡æ»¤æ‰æ•°ç»„ä¸­ç­‰äº 1 çš„å…ƒç´ 
    }
    
    ```

    `map`ï¼šéå†æ¯ä¸ªå…ƒç´ å¹¶æ‰§è¡Œç»™å®šè¡¨è¾¾å¼ï¼Œæœ€ç»ˆå½¢æˆæ–°çš„é›†åˆ

    ```kotlinÂ 
    ğŸï¸
    //  [1, 2, 3]
           â¬‡ï¸
    //  {2, 3, 4}
    
    val newList: List = intArray.map { i ->
        i + 1 // ğŸ‘ˆ æ¯ä¸ªå…ƒç´ åŠ  1
    }
    
    ```

    `flatMap`ï¼šéå†æ¯ä¸ªå…ƒç´ ï¼Œå¹¶ä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºæ–°çš„é›†åˆï¼Œæœ€ååˆå¹¶åˆ°ä¸€ä¸ªé›†åˆä¸­

    ```kotlin
    ğŸï¸
    //          [1, 2, 3]
                   â¬‡ï¸
    // {"2", "a" , "3", "a", "4", "a"}
    
    intArray.flatMap { i ->
        listOf("${i + 1}", "a") // ğŸ‘ˆ ç”Ÿæˆæ–°é›†åˆ
    }
    
    ```

30. #### `Range`

    åœ¨ Java è¯­è¨€ä¸­å¹¶æ²¡æœ‰ `Range` çš„æ¦‚å¿µï¼ŒKotlin ä¸­çš„ `Range` è¡¨ç¤ºåŒºé—´çš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯èŒƒå›´ã€‚åŒºé—´çš„å¸¸è§å†™æ³•å¦‚ä¸‹ï¼š

    ```kotlin
    ğŸï¸
                  ğŸ‘‡      ğŸ‘‡
    val range: IntRange = 0..1000 
    
    ```

    è¿™é‡Œçš„ `0..1000` å°±è¡¨ç¤ºä» 0 åˆ° 1000 çš„èŒƒå›´ï¼Œ**åŒ…æ‹¬ 1000**ï¼Œæ•°å­¦ä¸Šç§°ä¸ºé—­åŒºé—´ [0, 1000]ã€‚é™¤äº†è¿™é‡Œçš„ `IntRange` ï¼Œè¿˜æœ‰ `CharRange` ä»¥åŠ `LongRange`ã€‚

    Kotlin ä¸­æ²¡æœ‰çº¯çš„å¼€åŒºé—´çš„å®šä¹‰ï¼Œä¸è¿‡æœ‰åŠå¼€åŒºé—´çš„å®šä¹‰ï¼š

    ```koltin
    ğŸï¸
                             ğŸ‘‡
    val range: IntRange = 0 until 1000 
    
    ```

    è¿™é‡Œçš„ `0 until 1000` è¡¨ç¤ºä» 0 åˆ° 1000ï¼Œä½†**ä¸åŒ…æ‹¬ 1000**ï¼Œè¿™å°±æ˜¯åŠå¼€åŒºé—´ [0, 1000) ã€‚

    ```kotlin
    ğŸï¸
    val range = 0..1000
    //     ğŸ‘‡ é»˜è®¤æ­¥é•¿ä¸º 1ï¼Œè¾“å‡ºï¼š0, 1, 2, 3, 4, 5, 6, 7....1000,
    for (i in range) {
        print("$i, ")
    }
    
    ```

    é™¤äº†ä½¿ç”¨é»˜è®¤çš„æ­¥é•¿ 1ï¼Œè¿˜å¯ä»¥é€šè¿‡ `step` è®¾ç½®æ­¥é•¿ï¼š

    ```kotlin
    ğŸï¸
    val range = 0..1000
    //               ğŸ‘‡ æ­¥é•¿ä¸º 2ï¼Œè¾“å‡ºï¼š0, 2, 4, 6, 8, 10,....1000,
    for (i in range step 2) {
        print("$i, ")
    }
    
    ```

    Kotlin è¿˜æä¾›äº†é€’å‡åŒºé—´ `downTo` ï¼Œä¸è¿‡é€’å‡æ²¡æœ‰åŠå¼€åŒºé—´çš„ç”¨æ³•:

    ```kotlin
    ğŸï¸
    //            ğŸ‘‡ è¾“å‡ºï¼š4, 3, 2, 1, 
    for (i in 4 downTo 1) {
        print("$i, ")
    }
    
    ```

    å…¶ä¸­ `4 downTo 1` å°±è¡¨ç¤ºé€’å‡çš„é—­åŒºé—´ [4, 1]ã€‚è¿™é‡Œçš„ `downTo` ä»¥åŠä¸Šé¢çš„ `step` éƒ½å«åšã€Œä¸­ç¼€è¡¨è¾¾å¼ã€

    

31. #### `Sequence`

    äº†è§£ `Sequence` åºåˆ—çš„ä½¿ç”¨æ–¹å¼ã€‚

    åºåˆ— `Sequence` åˆè¢«ç§°ä¸ºã€Œæƒ°æ€§é›†åˆæ“ä½œã€ï¼Œå…³äºä»€ä¹ˆæ˜¯æƒ°æ€§ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥ç†è§£ï¼š

    ```kotlin
    ğŸï¸
    val sequence = sequenceOf(1, 2, 3, 4)
    val result: List = sequence
        .map { i ->
            println("Map $i")
            i * 2 
        }
        .filter { i ->
            println("Filter $i")
            i % 3  == 0 
        }
    ğŸ‘‡
    println(result.first()) // ğŸ‘ˆ åªå–é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ 
    
    ```

    - æƒ°æ€§çš„æ¦‚å¿µé¦–å…ˆå°±æ˜¯è¯´åœ¨ã€ŒğŸ‘‡ã€æ ‡æ³¨ä¹‹å‰çš„ä»£ç è¿è¡Œæ—¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œå®ƒåªæ˜¯å®šä¹‰äº†ä¸€ä¸ªæ‰§è¡Œæµç¨‹ï¼Œåªæœ‰ `result` è¢«ä½¿ç”¨åˆ°çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œ

    - å½“ã€ŒğŸ‘‡ã€çš„ `println` æ‰§è¡Œæ—¶æ•°æ®å¤„ç†æµç¨‹æ˜¯è¿™æ ·çš„ï¼š

      - å–å‡ºå…ƒç´  1 -> map ä¸º 2 -> filter åˆ¤æ–­ 2 æ˜¯å¦èƒ½è¢« 3 æ•´é™¤
      - å–å‡ºå…ƒç´  2 -> map ä¸º 4 -> filter åˆ¤æ–­ 4 æ˜¯å¦èƒ½è¢« 3 æ•´é™¤
      - ...

      æƒ°æ€§æŒ‡å½“å‡ºç°æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œ`Sequence` å°±ä¸ä¼šæ‰§è¡Œåé¢çš„å…ƒç´ éå†äº†ï¼Œå³è·³è¿‡äº† `4` çš„éå†ã€‚

    è€Œ `List` æ˜¯æ²¡æœ‰æƒ°æ€§çš„ç‰¹æ€§çš„ï¼š

    ```kotlin
    ğŸï¸
    val list = listOf(1, 2, 3, 4)
    val result: List = list
        .map { i ->
            println("Map $i")
            i * 2 
        }
        .filter { i ->
            println("Filter $i")
            i % 3  == 0 
        }
    ğŸ‘‡
    println(result.first()) // ğŸ‘ˆ åªå–é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ 
    
    ```

    åŒ…æ‹¬ä¸¤ç‚¹ï¼š

    - å£°æ˜ä¹‹åç«‹å³æ‰§è¡Œ
    - æ•°æ®å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š
      - {1, 2, 3, 4} -> {2, 4, 6, 8}
      - éå†åˆ¤æ–­æ˜¯å¦èƒ½è¢« 3 æ•´é™¤

    `Sequence` è¿™ç§ç±»ä¼¼æ‡’åŠ è½½çš„å®ç°æœ‰ä¸‹é¢è¿™äº›ä¼˜ç‚¹ï¼š

    - ä¸€æ—¦æ»¡è¶³éå†é€€å‡ºçš„æ¡ä»¶ï¼Œå°±å¯ä»¥çœç•¥åç»­ä¸å¿…è¦çš„éå†è¿‡ç¨‹ã€‚
    - åƒ `List` è¿™ç§å®ç° `Iterable` æ¥å£çš„é›†åˆç±»ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡å‡½æ•°å°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ `Iterable`ï¼Œä¸‹ä¸€ä¸ªå‡½æ•°å†åŸºäºæ–°çš„ `Iterable` æ‰§è¡Œï¼Œæ¯æ¬¡å‡½æ•°è°ƒç”¨äº§ç”Ÿçš„ä¸´æ—¶ `Iterable` ä¼šå¯¼è‡´é¢å¤–çš„å†…å­˜æ¶ˆè€—ï¼Œè€Œ `Sequence` åœ¨æ•´ä¸ªæµç¨‹ä¸­åªæœ‰ä¸€ä¸ªã€‚

    å› æ­¤ï¼Œ`Sequence` è¿™ç§æ•°æ®ç±»å‹å¯ä»¥åœ¨æ•°æ®é‡æ¯”è¾ƒå¤§æˆ–è€…æ•°æ®é‡æœªçŸ¥çš„æ—¶å€™ï¼Œä½œä¸ºæµå¼å¤„ç†çš„è§£å†³æ–¹æ¡ˆã€‚

32. ### æ¡ä»¶æ§åˆ¶

    #### `if/else`

    é¦–å…ˆæ¥çœ‹ä¸‹ Java ä¸­çš„ `if/else` å†™æ³•ï¼š

    ```java
    â˜•ï¸
    int max;
    if (a > b) {
        max = a;
    } else {
        max = b;
    }
    
    ```

    åœ¨ Kotlin ä¸­ï¼Œè¿™ä¹ˆå†™å½“ç„¶ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡ï¼ŒKotlin ä¸­ `if` è¯­å¥è¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªè¡¨è¾¾å¼èµ‹å€¼ç»™å˜é‡ï¼š

    ```kotlin
    ğŸï¸
           ğŸ‘‡
    val max = if (a > b) a else b
    
    ```

    å¦å¤–ï¼ŒKotlin ä¸­å¼ƒç”¨äº†ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆæ¡ä»¶ ? ç„¶å : å¦åˆ™ï¼‰ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `if/else` æ¥ä»£æ›¿å®ƒã€‚

    ä¸Šé¢çš„ `if/else` çš„åˆ†æ”¯ä¸­æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå…¶å®è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œä»£ç å—çš„æœ€åä¸€è¡Œä¼šä½œä¸ºç»“æœè¿”å›ï¼š

    ```kotlin
    ğŸï¸
    val max = if (a > b) {
        println("max:a")
        a // ğŸ‘ˆ è¿”å› a
    } else {
        println("max:b")
        b // ğŸ‘ˆ è¿”å› b
    }
    
    
    ```

    #### `when`

    åœ¨ Java ä¸­ï¼Œç”¨ `switch` è¯­å¥æ¥åˆ¤æ–­ä¸€ä¸ªå˜é‡ä¸ä¸€ç³»åˆ—å€¼ä¸­æŸä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼š

    ```java
    â˜•ï¸
    switch (x) {
        case 1: {
            System.out.println("1");
            break;
        }
        case 2: {
            System.out.println("2");
            break;
        }
        default: {
            System.out.println("default");
        }
    }
    
    ```

    kotlinä¸­

    ```kotlin
    ğŸï¸
    ğŸ‘‡
    when (x) {
       ğŸ‘‡
        1 -> { println("1") }
        2 -> { println("2") }
       ğŸ‘‡
        else -> { println("else") }
    }
    
    ```

    è¿™é‡Œä¸ Java ç›¸æ¯”çš„ä¸åŒç‚¹æœ‰ï¼š

    - çœç•¥äº† `case` å’Œ `break`ï¼Œå‰è€…æ¯”è¾ƒå¥½ç†è§£ï¼Œåè€…çš„æ„æ€æ˜¯ Kotlin è‡ªåŠ¨ä¸ºæ¯ä¸ªåˆ†æ”¯åŠ ä¸Šäº† `break` çš„åŠŸèƒ½ï¼Œé˜²æ­¢æˆ‘ä»¬åƒ Java é‚£æ ·å†™é”™
    - Java ä¸­çš„é»˜è®¤åˆ†æ”¯ä½¿ç”¨çš„æ˜¯ `default` å…³é”®å­—ï¼ŒKotlin ä¸­ä½¿ç”¨çš„æ˜¯ `else`

    ä¸ `if/else` ä¸€æ ·ï¼Œ`when` ä¹Ÿå¯ä»¥ä½œä¸ºè¡¨è¾¾å¼è¿›è¡Œä½¿ç”¨ï¼Œåˆ†æ”¯ä¸­æœ€åä¸€è¡Œçš„ç»“æœä½œä¸ºè¿”å›å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ—¶å°±å¿…é¡»è¦æœ‰ `else` åˆ†æ”¯ï¼Œä½¿å¾—æ— è®ºæ€æ ·éƒ½ä¼šæœ‰ç»“æœè¿”å›ï¼Œé™¤éå·²ç»åˆ—å‡ºäº†æ‰€æœ‰æƒ…å†µï¼š

    ```kotlin
    ğŸï¸
    val value: Int = when (x) {
        1 -> { x + 1 }
        2 -> { x * 2 }
        else -> { x + 5 }
    }
    
    ```

    åœ¨ Java ä¸­ï¼Œå½“å¤šç§æƒ…å†µæ‰§è¡ŒåŒä¸€ä»½ä»£ç æ—¶ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š

    ```java
    â˜•ï¸
    switch (x) {
        case 1:
        case 2: {
            System.out.println("x == 1 or x == 2");
            break;
        }
        default: {
            System.out.println("default");
        }
    }
    
    ```

    è€Œ Kotlin ä¸­å¤šç§æƒ…å†µæ‰§è¡ŒåŒä¸€ä»½ä»£ç æ—¶ï¼Œå¯ä»¥å°†å¤šä¸ªåˆ†æ”¯æ¡ä»¶æ”¾åœ¨ä¸€èµ·ï¼Œç”¨ `,` ç¬¦å·éš”å¼€ï¼Œè¡¨ç¤ºè¿™äº›æƒ…å†µéƒ½ä¼šæ‰§è¡Œåé¢çš„ä»£ç ï¼š

    ```koltin
    ğŸï¸
    when (x) {
        ğŸ‘‡
        1, 2 -> print("x == 1 or x == 2")
        else -> print("else")
    }
    
    ```

    åœ¨ `when` è¯­å¥ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ä½œä¸ºåˆ†æ”¯çš„åˆ¤æ–­æ¡ä»¶ï¼š

    ä½¿ç”¨ `in` æ£€æµ‹æ˜¯å¦åœ¨ä¸€ä¸ªåŒºé—´æˆ–è€…é›†åˆä¸­ï¼š

    ```kotlin
    ğŸï¸
    when (x) {
       ğŸ‘‡
        in 1..10 -> print("x åœ¨åŒºé—´ 1..10 ä¸­")
       ğŸ‘‡
        in listOf(1,2) -> print("x åœ¨é›†åˆä¸­")
       ğŸ‘‡ // not in
        !in 10..20 -> print("x ä¸åœ¨åŒºé—´ 10..20 ä¸­")
        else -> print("ä¸åœ¨ä»»ä½•åŒºé—´ä¸Š")
    }
    
    ```

    æˆ–è€…ä½¿ç”¨ `is` è¿›è¡Œç‰¹å®šç±»å‹çš„æ£€æµ‹ï¼š

    ```kotlin
    ğŸï¸
    val isString = when(x) {
        ğŸ‘‡
        is String -> true
        else -> false
    }
    
    ```

    è¿˜å¯ä»¥çœç•¥ `when` åé¢çš„å‚æ•°ï¼Œæ¯ä¸€ä¸ªåˆ†æ”¯æ¡ä»¶éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªå¸ƒå°”è¡¨è¾¾å¼ï¼š

    ```kotlin
    ğŸï¸
    when {
       ğŸ‘‡
        str1.contains("a") -> print("å­—ç¬¦ä¸² str1 åŒ…å« a")
       ğŸ‘‡
        str2.length == 3 -> print("å­—ç¬¦ä¸² str2 çš„é•¿åº¦ä¸º 3")
    }
    
    ```

    å½“åˆ†æ”¯çš„åˆ¤æ–­æ¡ä»¶ä¸ºè¡¨è¾¾å¼æ—¶ï¼Œå“ªä¸€ä¸ªæ¡ä»¶å…ˆä¸º `true` å°±æ‰§è¡Œå“ªä¸ªåˆ†æ”¯çš„ä»£ç å—ã€‚

33. #### `for`

    æˆ‘ä»¬çŸ¥é“ Java å¯¹ä¸€ä¸ªé›†åˆæˆ–æ•°ç»„å¯ä»¥è¿™æ ·éå†ï¼š

    ```java
    â˜•ï¸
    int[] array = {1, 2, 3, 4};
    for (int item : array) {
        ...
    }
    
    ```

    kotlin

    ```kotlin
    ğŸï¸
    val array = intArrayOf(1, 2, 3, 4)
              ğŸ‘‡
    for (item in array) {
        ...
    }
    
    ```

    è¿™é‡Œä¸ Java æœ‰å‡ å¤„ä¸åŒï¼š

    - åœ¨ Kotlin ä¸­ï¼Œè¡¨ç¤ºå•ä¸ªå…ƒç´ çš„ `item` ï¼Œä¸ç”¨æ˜¾å¼çš„å£°æ˜ç±»å‹
    - Kotlin ä½¿ç”¨çš„æ˜¯ `in` å…³é”®å­—ï¼Œè¡¨ç¤º `item` æ˜¯ `array` é‡Œé¢çš„ä¸€ä¸ªå…ƒç´ 

    å¦å¤–ï¼ŒKotlin çš„ `in` åé¢çš„å˜é‡å¯ä»¥æ˜¯ä»»ä½•å®ç° `Iterable` æ¥å£çš„å¯¹è±¡ã€‚

    åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿™ä¹ˆå†™ `for` å¾ªç¯ï¼š

    ```java
    â˜•ï¸
    for (int i = 0; i <= 10; i++) {
        // éå†ä» 0 åˆ° 10
    }
    
    ```

    ä½† Kotlin ä¸­æ²¡æœ‰è¿™æ ·çš„å†™æ³•ï¼Œé‚£åº”è¯¥æ€æ ·å®ç°ä¸€ä¸ª 0 åˆ° 10 çš„éå†å‘¢ï¼Ÿ

    å…¶å®ä½¿ç”¨ä¸Šé¢è®²è¿‡çš„åŒºé—´å°±å¯ä»¥å®ç°å•¦ï¼Œä»£ç å¦‚ä¸‹ï¼š

    ```kotlin
    ğŸï¸
    for (i in 0..10) {
        println(i)
    }
    
    ```

34. #### `try-catch`

    å…³äº `try-catch` æˆ‘ä»¬éƒ½ä¸é™Œç”Ÿï¼Œåœ¨å¹³æ—¶å¼€å‘ä¸­éš¾å…éƒ½ä¼šé‡åˆ°å¼‚å¸¸éœ€è¦å¤„ç†ï¼Œé‚£ä¹ˆåœ¨ Kotlin ä¸­æ˜¯æ€æ ·å¤„ç†çš„å‘¢ï¼Œå…ˆæ¥çœ‹ä¸‹ Kotlin ä¸­æ•è·å¼‚å¸¸çš„ä»£ç ï¼š

    ```kotlin
    ğŸï¸
    try {
        ...
    }
    catch (e: Exception) {
        ...
    }
    finally {
        ...
    }
    
    ```

    å¯ä»¥å‘ç° Kotlin å¼‚å¸¸å¤„ç†ä¸ Java çš„å¼‚å¸¸å¤„ç†åŸºæœ¬ç›¸åŒï¼Œä½†ä¹Ÿæœ‰å‡ ä¸ªä¸åŒç‚¹ï¼š

    * æˆ‘ä»¬çŸ¥é“åœ¨ Java ä¸­ï¼Œè°ƒç”¨ä¸€ä¸ªæŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ï¼š

      ```java
      â˜•ï¸
      public class User{
          void sayHi() throws IOException {
          }
          
          void test() {
              sayHi();
              // ğŸ‘† IDE æŠ¥é”™ï¼ŒUnhandled exception: java.io.IOException
          }
      }
      
      ```

      ä½†åœ¨ Kotlin ä¸­ï¼Œè°ƒç”¨ä¸Šæ–¹ `User` ç±»çš„ `sayHi` æ–¹æ³•æ—¶ï¼š

      ```koltin
      ğŸï¸
      val user = User()
      user.sayHi() // ğŸ‘ˆ æ­£å¸¸è°ƒç”¨ï¼ŒIDE ä¸ä¼šæŠ¥é”™ï¼Œä½†è¿è¡Œæ—¶ä¼šå‡ºé”™
      
      ```

      ä¸ºä»€ä¹ˆè¿™é‡Œä¸ä¼šæŠ¥é”™å‘¢ï¼Ÿå› ä¸º Kotlin ä¸­çš„å¼‚å¸¸æ˜¯ä¸ä¼šè¢«æ£€æŸ¥çš„ï¼Œåªæœ‰åœ¨è¿è¡Œæ—¶å¦‚æœ `sayHi` æŠ›å‡ºå¼‚å¸¸ï¼Œæ‰ä¼šå‡ºé”™ã€‚

    * Kotlin ä¸­ `try-catch` è¯­å¥ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå…è®¸ä»£ç å—çš„æœ€åä¸€è¡Œä½œä¸ºè¿”å›å€¼ï¼š

      ```kotlin
      ğŸï¸
                 ğŸ‘‡       
      val a: Int? = try { parseInt(input) } catch (e: NumberFormatException) { null }
      
      ```

    

35. #### `?.` å’Œ `?:`

    æˆ‘ä»¬çŸ¥é“ç©ºå®‰å…¨è°ƒç”¨ `?.`ï¼Œåœ¨å¯¹è±¡éç©ºæ—¶ä¼šæ‰§è¡Œåé¢çš„è°ƒç”¨ï¼Œå¯¹è±¡ä¸ºç©ºæ—¶å°±ä¼šè¿”å› `null`ã€‚å¦‚æœè¿™æ—¶å°†è¯¥è¡¨è¾¾å¼èµ‹å€¼ç»™ä¸€ä¸ªä¸å¯ç©ºçš„å˜é‡ï¼š

    ```kotlin
    ğŸï¸
    val str: String? = "Hello"
    var length: Int = str?.length
    //                ğŸ‘† ï¼ŒIDE æŠ¥é”™ï¼ŒType mismatch. Required:Int. Found:Int?
    
    ```

    æŠ¥é”™çš„åŸå› å°±æ˜¯ `str` ä¸º null æ—¶æˆ‘ä»¬æ²¡æœ‰å€¼å¯ä»¥è¿”å›ç»™ `length`

    è¿™æ—¶å°±å¯ä»¥ä½¿ç”¨ Kotlin ä¸­çš„ Elvis æ“ä½œç¬¦ `?:` æ¥å…œåº•ï¼š

    ```kotlin
    ğŸï¸
    val str: String? = "Hello"
                                 ğŸ‘‡
    val length: Int = str?.length ?: -1
    
    ```

    å®ƒçš„æ„æ€æ˜¯å¦‚æœå·¦ä¾§è¡¨è¾¾å¼ `str?.length` ç»“æœä¸ºç©ºï¼Œåˆ™è¿”å›å³ä¾§çš„å€¼ `-1`ã€‚

    Elvis æ“ä½œç¬¦è¿˜æœ‰å¦å¤–ä¸€ç§å¸¸è§ç”¨æ³•ï¼Œå¦‚ä¸‹ï¼š

    ```kotlin
    ğŸï¸
    fun validate(user: User) {
        val id = user.id ?: return // ğŸ‘ˆ éªŒè¯ user.id æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºæ—¶ return 
    }
    
    // ç­‰åŒäº
    
    fun validate(user: User) {
        if (user.id == null) {
            return
        }
        val id = user.id
    }
    
    ```

36. #### `==` å’Œ `===`

    åœ¨ Java ä¸­ï¼Œ`==` æ¯”è¾ƒçš„å¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹åˆ™åˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœæ¯”è¾ƒçš„æ˜¯ `String` åˆ™è¡¨ç¤ºå¼•ç”¨åœ°å€æ˜¯å¦ç›¸ç­‰ï¼Œ `String` å­—ç¬¦ä¸²çš„å†…å®¹æ¯”è¾ƒä½¿ç”¨çš„æ˜¯ `equals()` ï¼š

    ```java
    â˜•ï¸
    String str1 = "123", str2 = "123";
    System.out.println(str1.equals(str2));
    System.out.println(str1 == str2); 
    
    ```

    Kotlin ä¸­ä¹Ÿæœ‰ä¸¤ç§ç›¸ç­‰æ¯”è¾ƒæ–¹å¼ï¼š

    - `==` ï¼šå¯ä»¥å¯¹åŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠ `String` ç­‰ç±»å‹è¿›è¡Œå†…å®¹æ¯”è¾ƒï¼Œç›¸å½“äº Java ä¸­çš„ `equals`
    - `===` ï¼šå¯¹å¼•ç”¨çš„å†…å­˜åœ°å€è¿›è¡Œæ¯”è¾ƒï¼Œç›¸å½“äº Java ä¸­çš„ `==`

    å¯ä»¥å‘ç°ï¼ŒJava ä¸­çš„ `equals` ï¼Œåœ¨ Kotlin ä¸­ä¸ä¹‹ç›¸å¯¹åº”çš„æ˜¯ `==`ï¼Œè¿™æ ·å¯ä»¥ä½¿æˆ‘ä»¬çš„ä»£ç æ›´åŠ ç®€æ´ã€‚

    ä¸‹é¢å†æ¥çœ‹çœ‹ä»£ç ç¤ºä¾‹ï¼š

    ```kotlin
    ğŸï¸
    val str1 = "123"
    val str2 = "123"
    println(str1 == str2) // ğŸ‘ˆ å†…å®¹ç›¸ç­‰ï¼Œè¾“å‡ºï¼štrue
    
    val str1= "å­—ç¬¦ä¸²"
    val str2 = str1
    val str3 = str1
    print(str2 === str3) // ğŸ‘ˆ å¼•ç”¨åœ°å€ç›¸ç­‰ï¼Œè¾“å‡ºï¼štrue
    
    ```

    å…¶å® Kotlin ä¸­çš„ `equals` å‡½æ•°æ˜¯ `==` çš„æ“ä½œç¬¦é‡è½½ã€‚

37. ### æ³›å‹

    > `in`  å’Œ `out` å…³é”®å­—

    javaä¸­ï¼š

    ```java
    â˜•ï¸
    List<TextView> textViews = new ArrayList<TextView>();
    
    ```

    å…¶ä¸­ `List` è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ä¸º `TextView` çš„ `List`ã€‚

    > ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ
    >
    > ç°åœ¨çš„ç¨‹åºå¼€å‘å¤§éƒ½æ˜¯é¢å‘å¯¹è±¡çš„ï¼Œå¹³æ—¶ä¼šç”¨åˆ°å„ç§ç±»å‹çš„å¯¹è±¡ï¼Œä¸€ç»„å¯¹è±¡é€šå¸¸éœ€è¦ç”¨é›†åˆæ¥å­˜å‚¨å®ƒä»¬ï¼Œå› è€Œå°±æœ‰äº†ä¸€äº›é›†åˆç±»ï¼Œæ¯”å¦‚ `List`ã€`Map` ç­‰ã€‚
    >
    > è¿™äº›é›†åˆç±»é‡Œé¢éƒ½æ˜¯è£…çš„å…·ä½“ç±»å‹çš„å¯¹è±¡ï¼Œå¦‚æœæ¯ä¸ªç±»å‹éƒ½å»å®ç°è¯¸å¦‚ `TextViewList`ã€`ActivityList` è¿™æ ·çš„å…·ä½“çš„ç±»å‹ï¼Œæ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ã€‚
    >
    > å› æ­¤å°±è¯ç”Ÿäº†ã€Œæ³›å‹ã€ï¼Œå®ƒçš„æ„æ€æ˜¯æŠŠå…·ä½“çš„ç±»å‹æ³›åŒ–ï¼Œç¼–ç çš„æ—¶å€™ç”¨ç¬¦å·æ¥æŒ‡ä»£ç±»å‹ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå†ç¡®å®šå®ƒçš„ç±»å‹ã€‚
    >
    > å‰é¢é‚£ä¸ªä¾‹å­ï¼Œ`List` å°±æ˜¯æ³›å‹ç±»å‹å£°æ˜ã€‚

    æ—¢ç„¶æ³›å‹æ˜¯è·Ÿç±»å‹ç›¸å…³çš„ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯ä¹Ÿèƒ½é€‚ç”¨ç±»å‹çš„å¤šæ€å‘¢ï¼Ÿ

    çœ‹çœ‹ä¸€ä¸ªä½¿ç”¨åœºæ™¯ï¼š

    ```java
    â˜•ï¸
    TextView textView = new Button(context);
    // ğŸ‘† è¿™æ˜¯å¤šæ€
    
    List<Button> buttons = new ArrayList<Button>();
    List<TextView> textViews = buttons;
    // ğŸ‘† å¤šæ€ç”¨åœ¨è¿™é‡Œä¼šæŠ¥é”™ incompatible types: List<Button> cannot be converted to List<TextView>
    
    ```

    æˆ‘ä»¬çŸ¥é“ `Button` æ˜¯ç»§æ‰¿è‡ª `TextView` çš„ï¼Œæ ¹æ® Java å¤šæ€çš„ç‰¹æ€§ï¼Œç¬¬ä¸€å¤„èµ‹å€¼æ˜¯æ­£ç¡®çš„ã€‚

    ä½†æ˜¯åˆ°äº† `List` çš„æ—¶å€™ IDE å°±æŠ¥é”™äº†ï¼Œè¿™æ˜¯å› ä¸º Java çš„æ³›å‹æœ¬èº«å…·æœ‰ã€Œä¸å¯å˜æ€§ Invarianceã€ï¼ŒJava é‡Œé¢è®¤ä¸º `List` å’Œ `List` ç±»å‹å¹¶ä¸ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå­ç±»çš„æ³›å‹ï¼ˆ`List`ï¼‰ä¸å±äºæ³›å‹ï¼ˆ`List`ï¼‰çš„å­ç±»ã€‚

    > Java çš„æ³›å‹ç±»å‹ä¼šåœ¨ç¼–è¯‘æ—¶å‘ç”Ÿ**ç±»å‹æ“¦é™¤**ï¼Œä¸ºäº†ä¿è¯ç±»å‹å®‰å…¨ï¼Œä¸å…è®¸è¿™æ ·èµ‹å€¼
    >
    > åœ¨ Java é‡Œç”¨æ•°ç»„åšç±»ä¼¼çš„äº‹æƒ…ï¼Œæ˜¯ä¸ä¼šæŠ¥é”™çš„ï¼Œè¿™æ˜¯å› ä¸ºæ•°ç»„å¹¶æ²¡æœ‰åœ¨ç¼–è¯‘æ—¶æ“¦é™¤ç±»å‹.

    #### ç±»å‹æ“¦é™¤

    [æ¥æº](https://www.cnblogs.com/wuqinglong/p/9456193.html)

    > Javaçš„æ³›å‹æ˜¯ä¼ªæ³›å‹ï¼Œè¿™æ˜¯å› ä¸ºJavaåœ¨ç¼–è¯‘æœŸé—´ï¼Œæ‰€æœ‰çš„æ³›å‹ä¿¡æ¯éƒ½ä¼šè¢«æ“¦æ‰ã€‚
    >
    > Javaçš„æ³›å‹åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨ç¼–è¯‘å™¨è¿™ä¸ªå±‚æ¬¡ä¸Šå®ç°çš„ï¼Œåœ¨ç”Ÿæˆçš„å­—èŠ‚ç ä¸­æ˜¯ä¸åŒ…å«æ³›å‹ä¸­çš„ç±»å‹ä¿¡æ¯çš„ï¼Œä½¿ç”¨æ³›å‹çš„æ—¶å€™åŠ ä¸Šç±»å‹å‚æ•°ï¼Œåœ¨ç¼–è¯‘å™¨ç¼–è¯‘çš„æ—¶å€™ä¼šå»æ‰ï¼Œè¿™ä¸ªè¿‡ç¨‹æˆä¸ºç±»å‹æ“¦é™¤ã€‚
    >
    > 
    >
    > å¦‚åœ¨ä»£ç ä¸­å®šä¹‰`List`å’Œ`List`ç­‰ç±»å‹ï¼Œåœ¨ç¼–è¯‘åéƒ½ä¼šå˜æˆ`List`ï¼ŒJVMçœ‹åˆ°çš„åªæ˜¯Listï¼Œè€Œç”±æ³›å‹é™„åŠ çš„ç±»å‹ä¿¡æ¯å¯¹JVMæ˜¯çœ‹ä¸åˆ°çš„ã€‚Javaç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶å°½å¯èƒ½çš„å‘ç°å¯èƒ½å‡ºé”™çš„åœ°æ–¹ï¼Œä½†æ˜¯ä»ç„¶æ— æ³•åœ¨è¿è¡Œæ—¶åˆ»å‡ºç°çš„ç±»å‹è½¬æ¢å¼‚å¸¸çš„æƒ…å†µï¼Œç±»å‹æ“¦é™¤ä¹Ÿæ˜¯Javaçš„æ³›å‹ä¸C++æ¨¡æ¿æœºåˆ¶å®ç°æ–¹å¼ä¹‹é—´çš„é‡è¦åŒºåˆ«ã€‚

    * ä¾‹1 åŸå§‹ç±»å‹ç›¸ç­‰

    ```java
    public static void main(String[] args) {
        ArrayList<String> list1 = new ArrayList<String>();
        list1.add("abc");
    
        ArrayList<Integer> list2 = new ArrayList<Integer>();
        list2.add(123);
    
        System.out.println(list1.getClass() == list2.getClass());
    }
    
    
    ```

    åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ª`ArrayList`æ•°ç»„ï¼Œä¸è¿‡ä¸€ä¸ªæ˜¯`ArrayList`æ³›å‹ç±»å‹çš„ï¼Œåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼›ä¸€ä¸ªæ˜¯`ArrayList`æ³›å‹ç±»å‹çš„ï¼Œåªèƒ½å­˜å‚¨æ•´æ•°ï¼Œæœ€åï¼Œæˆ‘ä»¬é€šè¿‡`list1`å¯¹è±¡å’Œ`list2`å¯¹è±¡çš„`getClass()`æ–¹æ³•è·å–ä»–ä»¬çš„ç±»çš„ä¿¡æ¯ï¼Œæœ€åå‘ç°ç»“æœä¸º`true`ã€‚è¯´æ˜æ³›å‹ç±»å‹`String`å’Œ`Integer`éƒ½è¢«æ“¦é™¤æ‰äº†ï¼Œåªå‰©ä¸‹åŸå§‹ç±»å‹ã€‚

    * ä¾‹2 é€šè¿‡åå°„æ·»åŠ å…¶å®ƒç±»å‹å…ƒç´ 

    ```Java
    ArrayList<Integer> list = new ArrayList<Integer>();
    
    list.add(1);  //è¿™æ ·è°ƒç”¨ add æ–¹æ³•åªèƒ½å­˜å‚¨æ•´å½¢ï¼Œå› ä¸ºæ³›å‹ç±»å‹çš„å®ä¾‹ä¸º Integer
    
    list.getClass().getMethod("add", Object.class).invoke(list, "asd");
    
    for (int i = 0; i < list.size(); i++) {
        System.out.println(list.get(i));
    }
    
    ```

    åœ¨ç¨‹åºä¸­å®šä¹‰äº†ä¸€ä¸ª`ArrayList`æ³›å‹ç±»å‹å®ä¾‹åŒ–ä¸º`Integer`å¯¹è±¡ï¼Œå¦‚æœç›´æ¥è°ƒç”¨`add()`æ–¹æ³•ï¼Œé‚£ä¹ˆåªèƒ½å­˜å‚¨æ•´æ•°æ•°æ®ï¼Œä¸è¿‡å½“æˆ‘ä»¬åˆ©ç”¨åå°„è°ƒç”¨`add()`æ–¹æ³•çš„æ—¶å€™ï¼Œå´å¯ä»¥å­˜å‚¨å­—ç¬¦ä¸²ï¼Œè¿™è¯´æ˜äº†`Integer`æ³›å‹å®ä¾‹åœ¨ç¼–è¯‘ä¹‹åè¢«æ“¦é™¤æ‰äº†ï¼Œåªä¿ç•™äº†åŸå§‹ç±»å‹ã€‚

    ##### ç±»å‹æ“¦é™¤åä¿ç•™çš„åŸå§‹ç±»å‹

    ------

    > **åŸå§‹ç±»å‹** å°±æ˜¯æ“¦é™¤å»äº†æ³›å‹ä¿¡æ¯ï¼Œæœ€ååœ¨å­—èŠ‚ç ä¸­çš„ç±»å‹å˜é‡çš„çœŸæ­£ç±»å‹ï¼Œæ— è®ºä½•æ—¶å®šä¹‰ä¸€ä¸ªæ³›å‹ï¼Œç›¸åº”çš„åŸå§‹ç±»å‹éƒ½ä¼šè¢«è‡ªåŠ¨æä¾›ï¼Œç±»å‹å˜é‡æ“¦é™¤ï¼Œå¹¶ä½¿ç”¨å…¶é™å®šç±»å‹ï¼ˆæ— é™å®šçš„å˜é‡ç”¨Objectï¼‰æ›¿æ¢ã€‚

    * ä¾‹3åŸå§‹ç±»å‹Object

    ```java
    class Pair<T> {
        private T value;
        public T getValue() {
            return value;
        }
        public void setValue(T  value) {
            this.value = value;
        }
    }  
    
    ```

    Pairçš„åŸå§‹ç±»å‹ä¸º:

    ```java
    class Pair {
        private Object value;
        public Object getValue() {
            return value;
        }
        public void setValue(Object  value) {
            this.value = value;
        }
    }
    
    ```

    å› ä¸ºåœ¨`Pair`ä¸­ï¼ŒT æ˜¯ä¸€ä¸ªæ— é™å®šçš„ç±»å‹å˜é‡ï¼Œæ‰€ä»¥ç”¨`Object`æ›¿æ¢ï¼Œå…¶ç»“æœå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ç±»ï¼Œå¦‚åŒæ³›å‹åŠ å…¥Javaè¯­è¨€ä¹‹å‰çš„å·²ç»å®ç°çš„æ ·å­ã€‚åœ¨ç¨‹åºä¸­å¯ä»¥åŒ…å«ä¸åŒç±»å‹çš„`Pair`ï¼Œå¦‚`Pair`æˆ–`Pair`ï¼Œä½†æ˜¯æ“¦é™¤ç±»å‹åä»–ä»¬çš„å°±æˆä¸ºåŸå§‹çš„`Pair`ç±»å‹äº†ï¼ŒåŸå§‹ç±»å‹éƒ½æ˜¯`Object`ã€‚

    ä»ä¸Šé¢çš„ä¾‹2ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜ç™½`ArrayList`è¢«æ“¦é™¤ç±»å‹åï¼ŒåŸå§‹ç±»å‹ä¹Ÿå˜ä¸º`Object`ï¼Œæ‰€ä»¥é€šè¿‡åå°„æˆ‘ä»¬å°±å¯ä»¥å­˜å‚¨å­—ç¬¦ä¸²äº†ã€‚

    å¦‚æœç±»å‹å˜é‡æœ‰é™å®šï¼Œé‚£ä¹ˆåŸå§‹ç±»å‹å°±ç”¨ç¬¬ä¸€ä¸ªè¾¹ç•Œçš„ç±»å‹å˜é‡ç±»æ›¿æ¢ã€‚

    æ¯”å¦‚: Pairè¿™æ ·å£°æ˜çš„è¯

    `public class Pair<T extends Comparable> {}` é‚£ä¹ˆåŸå§‹ç±»å‹å°±æ˜¯`Comparable`ã€‚

    åœ¨è°ƒç”¨æ³›å‹æ–¹æ³•æ—¶ï¼Œå¯ä»¥æŒ‡å®šæ³›å‹ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®šæ³›å‹ã€‚

    - åœ¨ä¸æŒ‡å®šæ³›å‹çš„æƒ…å†µä¸‹ï¼Œæ³›å‹å˜é‡çš„ç±»å‹ä¸ºè¯¥æ–¹æ³•ä¸­çš„å‡ ç§ç±»å‹çš„åŒä¸€çˆ¶ç±»çš„æœ€å°çº§ï¼Œç›´åˆ°Object
    - åœ¨æŒ‡å®šæ³›å‹çš„æƒ…å†µä¸‹ï¼Œè¯¥æ–¹æ³•çš„å‡ ç§ç±»å‹å¿…é¡»æ˜¯è¯¥æ³›å‹çš„å®ä¾‹çš„ç±»å‹æˆ–è€…å…¶å­ç±»

    ```java
    class Test {
    
        public static void main(String[] args) {
            /**ä¸æŒ‡å®šæ³›å‹çš„æ—¶å€™*/
            int i = Test.add(1, 2); //è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯Integerï¼Œæ‰€ä»¥Tä¸ºIntegerç±»å‹
            Number f = Test.add(1, 1.2); //è¿™ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªæ˜¯Integerï¼Œä¸€ä¸ªæ˜¯Doubleï¼Œæ‰€ä»¥å–åŒä¸€çˆ¶ç±»çš„æœ€å°çº§ï¼Œä¸ºNumber
            Object o = Test.add(1, "asd"); //è¿™ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªæ˜¯Integerï¼Œä¸€ä¸ªæ˜¯Stringï¼Œæ‰€ä»¥å–åŒä¸€çˆ¶ç±»çš„æœ€å°çº§ï¼Œä¸ºString
    
            System.out.println(Test.add(1, 2).getClass());
            System.out.println(Test.add(1, 1.2).getClass());
            System.out.println(Test.add(1, "asd").getClass());
    
            /**æŒ‡å®šæ³›å‹çš„æ—¶å€™*/
            int a = Test.<Integer>add(1, 2); //æŒ‡å®šäº†Integerï¼Œæ‰€ä»¥åªèƒ½ä¸ºIntegerç±»å‹æˆ–è€…å…¶å­ç±»
            int b = Test.<Integer>add(1, 2.2); //ç¼–è¯‘é”™è¯¯ï¼ŒæŒ‡å®šäº†Integerï¼Œä¸èƒ½ä¸ºDouble
            Number c = Test.<Number>add(1, 2.2); //æŒ‡å®šä¸ºNumberï¼Œæ‰€ä»¥å¯ä»¥ä¸ºIntegerå’ŒDouble
        }
    
        //è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ³›å‹æ–¹æ³•
        public static <T> T add(T x,T y){
            return y;
        }
    }
    
    ```

    è¾“å‡º

    class java.lang.Integer
    class java.lang.Double
    class java.lang.String

    å…¶å®åœ¨æ³›å‹ç±»ä¸­ï¼Œä¸æŒ‡å®šæ³›å‹çš„æ—¶å€™ï¼Œä¹Ÿå·®ä¸å¤šï¼Œåªä¸è¿‡è¿™ä¸ªæ—¶å€™çš„æ³›å‹ä¸º`Object`ï¼Œå°±æ¯”å¦‚`ArrayList`ä¸­ï¼Œå¦‚æœä¸æŒ‡å®šæ³›å‹ï¼Œé‚£ä¹ˆè¿™ä¸ª`ArrayList`å¯ä»¥å­˜å‚¨ä»»æ„çš„å¯¹è±¡ã€‚

    ```java
    public static void main(String[] args) {
        ArrayList list = new ArrayList();
        list.add(1);
        list.add("121");
        list.add(new Date());
    }
    
    ```

    ##### ç±»å‹æ“¦é™¤å¼•èµ·çš„é—®é¢˜åŠè§£å†³æ–¹æ³•

    ------

    1. Q: æ—¢ç„¶è¯´ç±»å‹å˜é‡ä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™æ“¦é™¤æ‰ï¼Œé‚£ä¸ºä»€ä¹ˆæˆ‘ä»¬å¾€ ArrayList åˆ›å»ºçš„å¯¹è±¡ä¸­æ·»åŠ æ•´æ•°ä¼šæŠ¥é”™å‘¢ï¼Ÿä¸æ˜¯è¯´æ³›å‹å˜é‡Stringä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™å˜ä¸ºObjectç±»å‹å—ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½å­˜åˆ«çš„ç±»å‹å‘¢ï¼Ÿæ—¢ç„¶ç±»å‹æ“¦é™¤äº†ï¼Œå¦‚ä½•ä¿è¯æˆ‘ä»¬åªèƒ½ä½¿ç”¨æ³›å‹å˜é‡é™å®šçš„ç±»å‹å‘¢ï¼Ÿ

       * Javaç¼–è¯‘å™¨æ˜¯é€šè¿‡å…ˆæ£€æŸ¥ä»£ç ä¸­æ³›å‹çš„ç±»å‹ï¼Œç„¶ååœ¨è¿›è¡Œç±»å‹æ“¦é™¤ï¼Œå†è¿›è¡Œç¼–è¯‘ã€‚

       ```java
       ArrayList<String> list = new ArrayList<String>();
       list.add("123");
       list.add(123);//ç¼–è¯‘é”™è¯¯  
       
       ```

       åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œä½¿ç”¨`add`æ–¹æ³•æ·»åŠ ä¸€ä¸ªæ•´å‹ï¼Œåœ¨IDEä¸­ï¼Œç›´æ¥ä¼šæŠ¥é”™ï¼Œè¯´æ˜è¿™å°±æ˜¯åœ¨ç¼–è¯‘ä¹‹å‰çš„æ£€æŸ¥ï¼Œå› ä¸ºå¦‚æœæ˜¯åœ¨ç¼–è¯‘ä¹‹åæ£€æŸ¥ï¼Œç±»å‹æ“¦é™¤åï¼ŒåŸå§‹ç±»å‹ä¸º`Object`ï¼Œæ˜¯åº”è¯¥å…è®¸ä»»æ„å¼•ç”¨ç±»å‹æ·»åŠ çš„ã€‚å¯å®é™…ä¸Šå´ä¸æ˜¯è¿™æ ·çš„ï¼Œè¿™æ°æ°è¯´æ˜äº†å…³äºæ³›å‹å˜é‡çš„ä½¿ç”¨ï¼Œæ˜¯ä¼šåœ¨ç¼–è¯‘ä¹‹å‰æ£€æŸ¥çš„ã€‚

    2. æ³›å‹ä¸­å‚æ•°è¯ç±»å‹ä¸ºä»€ä¹ˆä¸è€ƒè™‘ç»§æ‰¿å…³ç³»ï¼Ÿ

       åœ¨Javaä¸­ï¼Œåƒä¸‹é¢å½¢å¼çš„å¼•ç”¨ä¼ é€’æ˜¯ä¸å…è®¸çš„:

       ```java
       ArrayList<String> list1 = new ArrayList<Object>(); //ç¼–è¯‘é”™è¯¯  
       ArrayList<Object> list2 = new ArrayList<String>(); //ç¼–è¯‘é”™è¯¯
       
       ```

       æˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ç§æƒ…å†µï¼Œå°†ç¬¬ä¸€ç§æƒ…å†µæ‹“å±•æˆä¸‹é¢çš„å½¢å¼ï¼š

       ```java
       ArrayList<Object> list1 = new ArrayList<Object>();
       list1.add(new Object());
       list1.add(new Object());
       ArrayList<String> list2 = list1; //ç¼–è¯‘é”™è¯¯
       
       ```

       å®é™…ä¸Šï¼Œåœ¨ç¬¬4è¡Œä»£ç çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰ç¼–è¯‘é”™è¯¯ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å…ˆå‡è®¾å®ƒç¼–è¯‘æ²¡é”™ã€‚é‚£ä¹ˆå½“æˆ‘ä»¬ä½¿ç”¨`list2`å¼•ç”¨ç”¨`get()`æ–¹æ³•å–å€¼çš„æ—¶å€™ï¼Œè¿”å›çš„éƒ½æ˜¯`String`ç±»å‹çš„å¯¹è±¡ï¼ˆä¸Šé¢æåˆ°äº†ï¼Œç±»å‹æ£€æµ‹æ˜¯æ ¹æ®å¼•ç”¨æ¥å†³å®šçš„ï¼‰ï¼Œå¯æ˜¯å®ƒé‡Œé¢å®é™…ä¸Šå·²ç»è¢«æˆ‘ä»¬å­˜æ”¾äº†`Object`ç±»å‹çš„å¯¹è±¡ï¼Œè¿™æ ·å°±ä¼šæœ‰`ClassCastException`äº†ã€‚æ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§ææ˜“å‡ºç°çš„é”™è¯¯ï¼ŒJavaä¸å…è®¸è¿›è¡Œè¿™æ ·çš„å¼•ç”¨ä¼ é€’ã€‚ï¼ˆè¿™ä¹Ÿæ˜¯æ³›å‹å‡ºç°çš„åŸå› ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³ç±»å‹è½¬æ¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸èƒ½è¿èƒŒå®ƒçš„åˆè¡·ï¼‰ã€‚

       å†çœ‹ç¬¬äºŒç§æƒ…å†µï¼Œå°†ç¬¬äºŒç§æƒ…å†µæ‹“å±•æˆä¸‹é¢çš„å½¢å¼ï¼š

       ```java
       ArrayList<String> list1 = new ArrayList<String>();
       list1.add(new String());
       list1.add(new String());
       
       ArrayList<Object> list2 = list1; //ç¼–è¯‘é”™è¯¯
       
       ```

       æ²¡é”™ï¼Œè¿™æ ·çš„æƒ…å†µæ¯”ç¬¬ä¸€ç§æƒ…å†µå¥½çš„å¤šï¼Œæœ€èµ·ç ï¼Œåœ¨æˆ‘ä»¬ç”¨`list2`å–å€¼çš„æ—¶å€™ä¸ä¼šå‡ºç°`ClassCastException`ï¼Œå› ä¸ºæ˜¯ä»`String`è½¬æ¢ä¸º`Object`ã€‚å¯æ˜¯ï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Œæ³›å‹å‡ºç°çš„åŸå› ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³ç±»å‹è½¬æ¢çš„é—®é¢˜ã€‚æˆ‘ä»¬ä½¿ç”¨äº†æ³›å‹ï¼Œåˆ°å¤´æ¥ï¼Œè¿˜æ˜¯è¦è‡ªå·±å¼ºè½¬ï¼Œè¿èƒŒäº†æ³›å‹è®¾è®¡çš„åˆè¡·ã€‚æ‰€ä»¥javaä¸å…è®¸è¿™ä¹ˆå¹²ã€‚å†è¯´ï¼Œä½ å¦‚æœåˆç”¨`list2`å¾€é‡Œé¢`add()`æ–°çš„å¯¹è±¡ï¼Œé‚£ä¹ˆåˆ°æ—¶å€™å–å¾—æ—¶å€™ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“æˆ‘å–å‡ºæ¥çš„åˆ°åº•æ˜¯`String`ç±»å‹çš„ï¼Œè¿˜æ˜¯`Object`ç±»å‹çš„å‘¢ï¼Ÿ

       **æ‰€ä»¥ï¼Œè¦æ ¼å¤–æ³¨æ„ï¼Œæ³›å‹ä¸­çš„å¼•ç”¨ä¼ é€’çš„é—®é¢˜ã€‚**

    3. ##### è‡ªåŠ¨ç±»å‹è½¬æ¢

       å› ä¸ºç±»å‹æ“¦é™¤çš„é—®é¢˜ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æ³›å‹ç±»å‹å˜é‡æœ€åéƒ½ä¼šè¢«æ›¿æ¢ä¸ºåŸå§‹ç±»å‹ã€‚

       æ—¢ç„¶éƒ½è¢«æ›¿æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨è·å–çš„æ—¶å€™ï¼Œä¸éœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢å‘¢ï¼Ÿ

       çœ‹ä¸‹`ArrayList.get()`æ–¹æ³•ï¼š

       ```java
       public E get(int index) {
       
           RangeCheck(index);
       
           return (E) elementData[index];
       
       }
       
       ```

       å¯ä»¥çœ‹åˆ°ï¼Œåœ¨`return`ä¹‹å‰ï¼Œä¼šæ ¹æ®æ³›å‹å˜é‡è¿›è¡Œå¼ºè½¬ã€‚å‡è®¾æ³›å‹ç±»å‹å˜é‡ä¸º`Date`ï¼Œè™½ç„¶æ³›å‹ä¿¡æ¯ä¼šè¢«æ“¦é™¤æ‰ï¼Œä½†æ˜¯ä¼šå°†`(E) elementData[index]`ï¼Œç¼–è¯‘ä¸º`(Date)elementData[index]`ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸ç”¨è‡ªå·±è¿›è¡Œå¼ºè½¬ã€‚å½“å­˜å–ä¸€ä¸ªæ³›å‹åŸŸæ—¶ä¹Ÿä¼šè‡ªåŠ¨æ’å…¥å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚å‡è®¾`Pair`ç±»çš„`value`åŸŸæ˜¯`public`çš„ï¼Œé‚£ä¹ˆè¡¨è¾¾å¼ï¼š

       ```
       Date date = pair.value;
       
       ```

       ä¹Ÿä¼šè‡ªåŠ¨åœ°åœ¨ç»“æœå­—èŠ‚ç ä¸­æ’å…¥å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚

    4. ##### ç±»å‹æ“¦é™¤ä¸å¤šæ€çš„å†²çªå’Œè§£å†³æ–¹æ³•

       ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªæ³›å‹ç±»ï¼š

       ```java
       class Pair<T> {
       
           private T value;
       
           public T getValue() {
               return value;
           }
       
           public void setValue(T value) {
               this.value = value;
           }
       }
       
       ```

       ç„¶åæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå­ç±»ç»§æ‰¿å®ƒã€‚

       ```java
       class DateInter extends Pair<Date> {
       
           @Override
           public void setValue(Date value) {
               super.setValue(value);
           }
       
           @Override
           public Date getValue() {
               return super.getValue();
           }
       }
       
       ```

       åœ¨è¿™ä¸ªå­ç±»ä¸­ï¼Œæˆ‘ä»¬è®¾å®šçˆ¶ç±»çš„æ³›å‹ç±»å‹ä¸º`Pair`ï¼Œåœ¨å­ç±»ä¸­ï¼Œæˆ‘ä»¬è¦†ç›–äº†çˆ¶ç±»çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬çš„åŸæ„æ˜¯è¿™æ ·çš„ï¼šå°†çˆ¶ç±»çš„æ³›å‹ç±»å‹é™å®šä¸º`Date`ï¼Œé‚£ä¹ˆçˆ¶ç±»é‡Œé¢çš„ä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°éƒ½ä¸º`Date`ç±»å‹ã€‚

       æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨å­ç±»ä¸­é‡å†™è¿™ä¸¤ä¸ªæ–¹æ³•ä¸€ç‚¹é—®é¢˜ä¹Ÿæ²¡æœ‰ï¼Œå®é™…ä¸Šï¼Œä»ä»–ä»¬çš„`@Override`æ ‡ç­¾ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œä¸€ç‚¹é—®é¢˜ä¹Ÿæ²¡æœ‰ï¼Œå®é™…ä¸Šæ˜¯è¿™æ ·çš„å—ï¼Ÿ

       åˆ†æï¼šå®é™…ä¸Šï¼Œç±»å‹æ“¦é™¤åï¼Œçˆ¶ç±»çš„çš„æ³›å‹ç±»å‹å…¨éƒ¨å˜ä¸ºäº†åŸå§‹ç±»å‹`Object`ï¼Œæ‰€ä»¥çˆ¶ç±»ç¼–è¯‘ä¹‹åä¼šå˜æˆä¸‹é¢çš„æ ·å­ï¼š

       ```java
       class Pair {
           private Object value;
       
           public Object getValue() {
               return value;
           }
       
           public void setValue(Object  value) {
               this.value = value;
           }
       }
       
       ```

       å…ˆæ¥åˆ†æ`setValue`æ–¹æ³•ï¼Œçˆ¶ç±»çš„ç±»å‹æ˜¯`Object`ï¼Œè€Œå­ç±»çš„ç±»å‹æ˜¯`Date`ï¼Œå‚æ•°ç±»å‹ä¸ä¸€æ ·ï¼Œè¿™å¦‚æœå®åœ¨æ™®é€šçš„ç»§æ‰¿å…³ç³»ä¸­ï¼Œæ ¹æœ¬å°±ä¸ä¼šæ˜¯é‡å†™ï¼Œè€Œæ˜¯é‡è½½ã€‚

       æˆ‘ä»¬åœ¨ä¸€ä¸ªmainæ–¹æ³•æµ‹è¯•ä¸€ä¸‹ï¼š

       ```java
       DateInter dateInter = new DateInter();
       dateInter.setValue(new Date());
       dateInter.setValue(new Object()); //ç¼–è¯‘é”™è¯¯  
       
       ```

       å¦‚æœæ˜¯é‡è½½ï¼Œé‚£ä¹ˆå­ç±»ä¸­ä¸¤ä¸ª`setValue`æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯å‚æ•°`Object`ç±»å‹ï¼Œä¸€ä¸ªæ˜¯`Date`ç±»å‹ï¼Œå¯æ˜¯æˆ‘ä»¬å‘ç°ï¼Œæ ¹æœ¬å°±æ²¡æœ‰è¿™æ ·çš„ä¸€ä¸ªå­ç±»ç»§æ‰¿è‡ªçˆ¶ç±»çš„Objectç±»å‹å‚æ•°çš„æ–¹æ³•ã€‚æ‰€ä»¥è¯´ï¼Œå´æ˜¯æ˜¯é‡å†™äº†ï¼Œè€Œä¸æ˜¯é‡è½½äº†ã€‚

       ???????????????

       åŸå› æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬ä¼ å…¥çˆ¶ç±»çš„æ³›å‹ç±»å‹æ˜¯`Dateï¼ŒPair`ï¼Œæˆ‘ä»¬çš„æœ¬æ„æ˜¯å°†æ³›å‹ç±»å˜ä¸ºå¦‚ä¸‹ï¼š

       ```java
       class Pair {
           private Date value;
           public Date getValue() {
               return value;
           }
           public void setValue(Date value) {
               this.value = value;
           }
       }
       
       ```

       ç„¶åå†å­ç±»ä¸­é‡å†™å‚æ•°ç±»å‹ä¸ºDateçš„é‚£ä¸¤ä¸ªæ–¹æ³•ï¼Œå®ç°ç»§æ‰¿ä¸­çš„å¤šæ€ã€‚

       å¯æ˜¯ç”±äºç§ç§åŸå› ï¼Œè™šæ‹Ÿæœºå¹¶ä¸èƒ½å°†æ³›å‹ç±»å‹å˜ä¸º`Date`ï¼Œåªèƒ½å°†ç±»å‹æ“¦é™¤æ‰ï¼Œå˜ä¸ºåŸå§‹ç±»å‹`Object`ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„æœ¬æ„æ˜¯è¿›è¡Œé‡å†™ï¼Œå®ç°å¤šæ€ã€‚å¯æ˜¯ç±»å‹æ“¦é™¤åï¼Œåªèƒ½å˜ä¸ºäº†é‡è½½ã€‚è¿™æ ·ï¼Œç±»å‹æ“¦é™¤å°±å’Œå¤šæ€æœ‰äº†å†²çªã€‚JVMçŸ¥é“ä½ çš„æœ¬æ„å—ï¼ŸçŸ¥é“ï¼ï¼ï¼å¯æ˜¯å®ƒèƒ½ç›´æ¥å®ç°å—ï¼Œä¸èƒ½ï¼ï¼ï¼å¦‚æœçœŸçš„ä¸èƒ½çš„è¯ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆå»é‡å†™æˆ‘ä»¬æƒ³è¦çš„`Date`ç±»å‹å‚æ•°çš„æ–¹æ³•å•Šã€‚

       äºæ˜¯JVMé‡‡ç”¨äº†ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³•ï¼Œæ¥å®Œæˆè¿™é¡¹åŠŸèƒ½ï¼Œé‚£å°±æ˜¯æ¡¥æ–¹æ³•ã€‚

       é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨`javap -c className`çš„æ–¹å¼åç¼–è¯‘ä¸‹`DateInter`å­ç±»çš„å­—èŠ‚ç ï¼Œç»“æœå¦‚ä¸‹ï¼š

       ```java
       class com.tao.test.DateInter extends com.tao.test.Pair<java.util.Date> {
               com.tao.test.DateInter();
               Code:
               0: aload_0
               1: invokespecial #8                  // Method com/tao/test/Pair."<init>":()V  
               4: return
       
       public void setValue(java.util.Date);  //æˆ‘ä»¬é‡å†™çš„setValueæ–¹æ³•  
               Code:
               0: aload_0
               1: aload_1
               2: invokespecial #16                 // Method com/tao/test/Pair.setValue:(Ljava/lang/Object;)V  
               5: return
       
       public java.util.Date getValue();    //æˆ‘ä»¬é‡å†™çš„getValueæ–¹æ³•  
               Code:
               0: aload_0
               1: invokespecial #23                 // Method com/tao/test/Pair.getValue:()Ljava/lang/Object;  
               4: checkcast     #26                 // class java/util/Date  
               7: areturn
       
       public java.lang.Object getValue();     //ç¼–è¯‘æ—¶ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„å·§æ–¹æ³•  
               Code:
               0: aload_0
               1: invokevirtual #28                 // Method getValue:()Ljava/util/Date å»è°ƒç”¨æˆ‘ä»¬é‡å†™çš„getValueæ–¹æ³•;  
               4: areturn
       
       public void setValue(java.lang.Object);   //ç¼–è¯‘æ—¶ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„å·§æ–¹æ³•  
               Code:
               0: aload_0
               1: aload_1
               2: checkcast     #26                 // class java/util/Date  
               5: invokevirtual #30                 // Method setValue:(Ljava/util/Date; å»è°ƒç”¨æˆ‘ä»¬é‡å†™çš„setValueæ–¹æ³•)V  
               8: return
               }
       }
       
       ```

       ä»ç¼–è¯‘çš„ç»“æœæ¥çœ‹ï¼Œæˆ‘ä»¬æœ¬æ„é‡å†™`setValue`å’Œ`getValue`æ–¹æ³•çš„å­ç±»ï¼Œç«Ÿç„¶æœ‰4ä¸ªæ–¹æ³•ï¼Œå…¶å®ä¸ç”¨æƒŠå¥‡ï¼Œæœ€åçš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯ç¼–è¯‘å™¨è‡ªå·±ç”Ÿæˆçš„æ¡¥æ–¹æ³•ã€‚å¯ä»¥çœ‹åˆ°æ¡¥æ–¹æ³•çš„å‚æ•°ç±»å‹éƒ½æ˜¯Objectï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå­ç±»ä¸­çœŸæ­£è¦†ç›–çˆ¶ç±»ä¸¤ä¸ªæ–¹æ³•çš„å°±æ˜¯è¿™ä¸¤ä¸ªæˆ‘ä»¬çœ‹ä¸åˆ°çš„æ¡¥æ–¹æ³•ã€‚è€Œæ‰“åœ¨æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„`setvalue`å’Œ`getValue`æ–¹æ³•ä¸Šé¢çš„`@Oveerride`åªä¸è¿‡æ˜¯å‡è±¡ã€‚è€Œæ¡¥æ–¹æ³•çš„å†…éƒ¨å®ç°ï¼Œå°±åªæ˜¯å»è°ƒç”¨æˆ‘ä»¬è‡ªå·±é‡å†™çš„é‚£ä¸¤ä¸ªæ–¹æ³•ã€‚

       æ‰€ä»¥ï¼Œè™šæ‹Ÿæœºå·§å¦™çš„ä½¿ç”¨äº†æ¡¥æ–¹æ³•ï¼Œæ¥è§£å†³äº†ç±»å‹æ“¦é™¤å’Œå¤šæ€çš„å†²çªã€‚

       ä¸è¿‡ï¼Œè¦æåˆ°ä¸€ç‚¹ï¼Œè¿™é‡Œé¢çš„`setValue`å’Œ`getValue`è¿™ä¸¤ä¸ªæ¡¥æ–¹æ³•çš„æ„ä¹‰åˆæœ‰ä¸åŒã€‚

       `setValue`æ–¹æ³•æ˜¯ä¸ºäº†è§£å†³ç±»å‹æ“¦é™¤ä¸å¤šæ€ä¹‹é—´çš„å†²çªã€‚

       è€Œ`getValue`å´æœ‰æ™®éçš„æ„ä¹‰ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œå¦‚æœè¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„ç»§æ‰¿å…³ç³»ï¼š

       é‚£ä¹ˆçˆ¶ç±»çš„`getValue`æ–¹æ³•å¦‚ä¸‹ï¼š

       ```java
       public Object getValue()
       {
         return super.getValue();
       }
       
       ```

       è€Œå­ç±»é‡å†™çš„æ–¹æ³•æ˜¯ï¼š

       ```java
       public Date getValue() {
           return super.getValue();
       }
       
       ```

       å…¶å®è¿™åœ¨æ™®é€šçš„ç±»ç»§æ‰¿ä¸­ä¹Ÿæ˜¯æ™®éå­˜åœ¨çš„é‡å†™ï¼Œè¿™å°±æ˜¯åå˜ã€‚

    5. ##### æ³›å‹ç±»å‹å˜é‡ä¸èƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹

       ä¸èƒ½ç”¨ç±»å‹å‚æ•°æ›¿æ¢åŸºæœ¬ç±»å‹ã€‚å°±æ¯”å¦‚ï¼Œæ²¡æœ‰`ArrayList`ï¼Œåªæœ‰`ArrayList`ã€‚å› ä¸ºå½“ç±»å‹æ“¦é™¤åï¼Œ`ArrayList`çš„åŸå§‹ç±»å‹å˜ä¸º`Object`ï¼Œä½†æ˜¯`Object`ç±»å‹ä¸èƒ½å­˜å‚¨`double`å€¼ï¼Œåªèƒ½å¼•ç”¨`Double`çš„å€¼ã€‚

       ##### è¿è¡Œæ—¶ç±»å‹æŸ¥è¯¢

       `ArrayList<String> arrayList = new ArrayList<String>();`

       å› ä¸ºç±»å‹æ“¦é™¤ä¹‹åï¼Œ`ArrayList`åªå‰©ä¸‹åŸå§‹ç±»å‹ï¼Œæ³›å‹ä¿¡æ¯`String`ä¸å­˜åœ¨äº†ã€‚

       é‚£ä¹ˆï¼Œè¿è¡Œæ—¶è¿›è¡Œç±»å‹æŸ¥è¯¢çš„æ—¶å€™ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ˜¯é”™è¯¯çš„

       `if( arrayList instanceof ArrayList<String>)`

    6. ##### æ³›å‹åœ¨é™æ€æ–¹æ³•å’Œé™æ€ç±»ä¸­çš„é—®é¢˜

       æ³›å‹ç±»ä¸­çš„é™æ€æ–¹æ³•å’Œé™æ€å˜é‡ä¸å¯ä»¥ä½¿ç”¨æ³›å‹ç±»æ‰€å£°æ˜çš„æ³›å‹ç±»å‹å‚æ•°

       ```java
       public class Test2<T> {
           public static T one;   //ç¼–è¯‘é”™è¯¯    
           public static  T show(T one){ //ç¼–è¯‘é”™è¯¯    
               return null;
           }
       }
       
       ```

       å› ä¸ºæ³›å‹ç±»ä¸­çš„æ³›å‹å‚æ•°çš„å®ä¾‹åŒ–æ˜¯åœ¨å®šä¹‰å¯¹è±¡çš„æ—¶å€™æŒ‡å®šçš„ï¼Œè€Œé™æ€å˜é‡å’Œé™æ€æ–¹æ³•ä¸éœ€è¦ä½¿ç”¨å¯¹è±¡æ¥è°ƒç”¨ã€‚å¯¹è±¡éƒ½æ²¡æœ‰åˆ›å»ºï¼Œå¦‚ä½•ç¡®å®šè¿™ä¸ªæ³›å‹å‚æ•°æ˜¯ä½•ç§ç±»å‹ï¼Œæ‰€ä»¥å½“ç„¶æ˜¯é”™è¯¯çš„ã€‚

       ä½†æ˜¯è¦æ³¨æ„åŒºåˆ†ä¸‹é¢çš„ä¸€ç§æƒ…å†µï¼š

       ```java
       public class Test2<T> {
       
           public static <T >T show(T one){ //è¿™æ˜¯æ­£ç¡®çš„    
               return null;
           }
       }
       
       ```

       å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œåœ¨æ³›å‹æ–¹æ³•ä¸­ä½¿ç”¨çš„Tæ˜¯è‡ªå·±åœ¨æ–¹æ³•ä¸­å®šä¹‰çš„ Tï¼Œè€Œä¸æ˜¯æ³›å‹ç±»ä¸­çš„Tã€‚

    ### Java ä¸­çš„ `? extends`

    ```java
    â˜•ï¸
    List<Button> buttons = new ArrayList<Button>();
          ğŸ‘‡
    List<? extends TextView> textViews = buttons;
    
    ```

    è¿™ä¸ª `? extends` å«åšã€Œä¸Šç•Œé€šé…ç¬¦ã€ï¼Œå¯ä»¥ä½¿ Java æ³›å‹å…·æœ‰ã€Œåå˜æ€§ Covarianceã€ï¼Œåå˜å°±æ˜¯å…è®¸ä¸Šé¢çš„èµ‹å€¼æ˜¯åˆæ³•çš„ã€‚

    > åœ¨ç»§æ‰¿å…³ç³»æ ‘ä¸­ï¼Œå­ç±»ç»§æ‰¿è‡ªçˆ¶ç±»ï¼Œå¯ä»¥è®¤ä¸ºçˆ¶ç±»åœ¨ä¸Šï¼Œå­ç±»åœ¨ä¸‹ã€‚`extends` é™åˆ¶äº†æ³›å‹ç±»å‹çš„çˆ¶ç±»å‹ï¼Œæ‰€ä»¥å«ä¸Šç•Œã€‚

    å®ƒæœ‰ä¸¤å±‚æ„æ€ï¼š

    - å…¶ä¸­ `?` æ˜¯ä¸ªé€šé…ç¬¦ï¼Œè¡¨ç¤ºè¿™ä¸ª `List` çš„æ³›å‹ç±»å‹æ˜¯ä¸€ä¸ª**æœªçŸ¥ç±»å‹**ã€‚
    - `extends` é™åˆ¶äº†è¿™ä¸ªæœªçŸ¥ç±»å‹çš„ä¸Šç•Œï¼Œä¹Ÿå°±æ˜¯æ³›å‹ç±»å‹å¿…é¡»æ»¡è¶³è¿™ä¸ª `extends` çš„é™åˆ¶æ¡ä»¶ï¼Œè¿™é‡Œå’Œå®šä¹‰ `class` çš„ `extends` å…³é”®å­—æœ‰ç‚¹ä¸ä¸€æ ·ï¼š
      - å®ƒçš„èŒƒå›´ä¸ä»…æ˜¯æ‰€æœ‰ç›´æ¥å’Œé—´æ¥å­ç±»ï¼Œè¿˜åŒ…æ‹¬ä¸Šç•Œå®šä¹‰çš„çˆ¶ç±»æœ¬èº«ï¼Œä¹Ÿå°±æ˜¯ `TextView`ã€‚
      - å®ƒè¿˜æœ‰ `implements` çš„æ„æ€ï¼Œå³è¿™é‡Œçš„ä¸Šç•Œä¹Ÿå¯ä»¥æ˜¯ `interface`ã€‚

    è¿™é‡Œ `Button` æ˜¯ `TextView` çš„å­ç±»ï¼Œæ»¡è¶³äº†æ³›å‹ç±»å‹çš„é™åˆ¶æ¡ä»¶ï¼Œå› è€Œèƒ½å¤ŸæˆåŠŸèµ‹å€¼ã€‚

    ä¸‹é¢å‡ ç§æƒ…å†µéƒ½æ˜¯å¯ä»¥çš„ï¼š

    ```java
    â˜•ï¸
    List<? extends TextView> textViews = new ArrayList<TextView>(); // ğŸ‘ˆ æœ¬èº«
    List<? extends TextView> textViews = new ArrayList<Button>(); // ğŸ‘ˆ ç›´æ¥å­ç±»
    List<? extends TextView> textViews = new ArrayList<RadioButton>(); // ğŸ‘ˆ é—´æ¥å­ç±»
    
    ```

    ä¸€èˆ¬é›†åˆç±»éƒ½åŒ…å«äº† `get` å’Œ `add` ä¸¤ç§æ“ä½œï¼Œæ¯”å¦‚ Java ä¸­çš„ `List`ï¼Œå®ƒçš„å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š

    ```java
    â˜•ï¸
    public interface List<E> extends Collection<E>{
        E get(int index);
        boolean add(E e);
        ...
    }
    
    
    ```

    ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`E` å°±æ˜¯è¡¨ç¤ºæ³›å‹ç±»å‹çš„ç¬¦å·ï¼ˆç”¨å…¶ä»–å­—æ¯ç”šè‡³å•è¯éƒ½å¯ä»¥ï¼‰ã€‚

    æˆ‘ä»¬çœ‹çœ‹åœ¨ä½¿ç”¨äº†ä¸Šç•Œé€šé…ç¬¦ä¹‹åï¼Œ`List` çš„ä½¿ç”¨ä¸Šæœ‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼š

    ```java
    â˜•ï¸
    List<? extends TextView> textViews = new ArrayList<Button>();
    TextView textView = textViews.get(0); // ğŸ‘ˆ get å¯ä»¥
    textViews.add(textView);
    //             ğŸ‘† add ä¼šæŠ¥é”™ï¼Œno suitable method found for add(TextView)
    
    ```

    å‰é¢è¯´åˆ° `List` çš„æ³›å‹ç±»å‹æ˜¯ä¸ªæœªçŸ¥ç±»å‹ `?`ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ç¡®å®šå®ƒæ˜¯å•¥ç±»å‹ï¼Œåªæ˜¯æœ‰ä¸ªé™åˆ¶æ¡ä»¶ã€‚

    ç”±äºå®ƒæ»¡è¶³ `? extends TextView` çš„é™åˆ¶æ¡ä»¶ï¼Œæ‰€ä»¥ `get` å‡ºæ¥çš„å¯¹è±¡ï¼Œè‚¯å®šæ˜¯ `TextView` çš„å­ç±»å‹ï¼Œæ ¹æ®å¤šæ€çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿèµ‹å€¼ç»™ `TextView`ï¼Œå•°å—¦ä¸€å¥ï¼Œèµ‹å€¼ç»™ `View` ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚

    åˆ°äº† `add` æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç†è§£ï¼š

    - `List` ç”±äºç±»å‹æœªçŸ¥ï¼Œå®ƒå¯èƒ½æ˜¯ `List`ï¼Œä¹Ÿå¯èƒ½æ˜¯ `List`ã€‚
    - å¯¹äºå‰è€…ï¼Œæ˜¾ç„¶æˆ‘ä»¬è¦æ·»åŠ  TextView æ˜¯ä¸å¯ä»¥çš„ã€‚
    - å®é™…æƒ…å†µæ˜¯ç¼–è¯‘å™¨æ— æ³•ç¡®å®šåˆ°åº•å±äºå“ªä¸€ç§ï¼Œæ— æ³•ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œå°±æŠ¥é”™äº†ã€‚

    é‚£æˆ‘å¹²è„†ä¸è¦ `extends TextView` ï¼Œåªç”¨é€šé…ç¬¦ `?` å‘¢ï¼Ÿè¿™æ ·ä½¿ç”¨ `List` å…¶å®æ˜¯ `List` çš„ç¼©å†™ã€‚

    ```java
    â˜•ï¸
    List<Button> buttons = new ArrayList<>();
    
    List<?> list = buttons;
    Object obj = list.get(0);
    
    list.add(obj); // ğŸ‘ˆ è¿™é‡Œè¿˜æ˜¯ä¼šæŠ¥é”™
    
    ```

    å’Œå‰é¢çš„ä¾‹å­ä¸€æ ·ï¼Œç¼–è¯‘å™¨æ²¡æ³•ç¡®å®š `?` çš„ç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œå°±åªèƒ½ `get` åˆ° `Object` å¯¹è±¡ã€‚

    åŒæ—¶ç¼–è¯‘å™¨ä¸ºäº†ä¿è¯ç±»å‹å®‰å…¨ï¼Œä¹Ÿä¸èƒ½å‘ `List` ä¸­æ·»åŠ ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼Œç†ç”±åŒä¸Šã€‚

    ç”±äº `add` çš„è¿™ä¸ªé™åˆ¶ï¼Œä½¿ç”¨äº† `? extends` æ³›å‹é€šé…ç¬¦çš„ `List`ï¼Œåªèƒ½å¤Ÿå‘å¤–æä¾›æ•°æ®è¢«æ¶ˆè´¹ï¼Œä»è¿™ä¸ªè§’åº¦æ¥è®²ï¼Œå‘å¤–æä¾›æ•°æ®çš„ä¸€æ–¹ç§°ä¸ºã€Œç”Ÿäº§è€… Producerã€ã€‚å¯¹åº”çš„è¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µå«ã€Œæ¶ˆè´¹è€… Consumerã€ï¼Œå¯¹åº” Java é‡Œé¢å¦ä¸€ä¸ªæ³›å‹é€šé…ç¬¦ `? super`ã€‚

    ### Java ä¸­çš„ `? super`

    ```java
    â˜•ï¸
         ğŸ‘‡
    List<? super Button> buttons = new ArrayList<TextView>();
    
    ```

    è¿™ä¸ª `? super` å«åšã€Œä¸‹ç•Œé€šé…ç¬¦ã€ï¼Œå¯ä»¥ä½¿ Java æ³›å‹å…·æœ‰ã€Œé€†å˜æ€§ Contravarianceã€ã€‚

    > ä¸ä¸Šç•Œé€šé…ç¬¦å¯¹åº”ï¼Œè¿™é‡Œ super é™åˆ¶äº†é€šé…ç¬¦ ? çš„å­ç±»å‹ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºä¸‹ç•Œã€‚

    å®ƒä¹Ÿæœ‰ä¸¤å±‚æ„æ€ï¼š

    - é€šé…ç¬¦ `?` è¡¨ç¤º `List` çš„æ³›å‹ç±»å‹æ˜¯ä¸€ä¸ª**æœªçŸ¥ç±»å‹**ã€‚
    - `super` é™åˆ¶äº†è¿™ä¸ªæœªçŸ¥ç±»å‹çš„ä¸‹ç•Œï¼Œä¹Ÿå°±æ˜¯æ³›å‹ç±»å‹å¿…é¡»æ»¡è¶³è¿™ä¸ª `super` çš„é™åˆ¶æ¡ä»¶ã€‚
      - `super` æˆ‘ä»¬åœ¨ç±»çš„æ–¹æ³•é‡Œé¢ç»å¸¸ç”¨åˆ°ï¼Œè¿™é‡Œçš„èŒƒå›´ä¸ä»…åŒ…æ‹¬ `Button` çš„ç›´æ¥å’Œé—´æ¥çˆ¶ç±»ï¼Œä¹ŸåŒ…æ‹¬ä¸‹ç•Œ `Button` æœ¬èº«ã€‚
      - `super` åŒæ ·æ”¯æŒ `interface`ã€‚

    ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ`TextView` æ˜¯ `Button` çš„çˆ¶ç±»å‹ ï¼Œä¹Ÿå°±èƒ½å¤Ÿæ»¡è¶³ `super` çš„é™åˆ¶æ¡ä»¶ï¼Œå°±å¯ä»¥æˆåŠŸèµ‹å€¼äº†ã€‚

    æ ¹æ®åˆšæ‰çš„æè¿°ï¼Œä¸‹é¢å‡ ç§æƒ…å†µéƒ½æ˜¯å¯ä»¥çš„ï¼š

    ```java
    â˜•ï¸
    List<? super Button> buttons = new ArrayList<Button>(); // ğŸ‘ˆ æœ¬èº«
    List<? super Button> buttons = new ArrayList<TextView>(); // ğŸ‘ˆ ç›´æ¥çˆ¶ç±»
    List<? super Button> buttons = new ArrayList<Object>(); // ğŸ‘ˆ é—´æ¥çˆ¶ç±»
    
    ```

    å¯¹äºä½¿ç”¨äº†ä¸‹ç•Œé€šé…ç¬¦çš„ `List`ï¼Œæˆ‘ä»¬å†çœ‹çœ‹å®ƒçš„ `get` å’Œ `add` æ“ä½œï¼š

    ```java
    â˜•ï¸
    List<? super Button> buttons = new ArrayList<TextView>();
    Object object = buttons.get(0); // ğŸ‘ˆ get å‡ºæ¥çš„æ˜¯ Object ç±»å‹
    Button button = ...
    buttons.add(button); // ğŸ‘ˆ add æ“ä½œæ˜¯å¯ä»¥çš„
    
    ```

    è§£é‡Šä¸‹ï¼Œé¦–å…ˆ `?` è¡¨ç¤ºæœªçŸ¥ç±»å‹ï¼Œç¼–è¯‘å™¨æ˜¯ä¸ç¡®å®šå®ƒçš„ç±»å‹çš„ã€‚

    è™½ç„¶ä¸çŸ¥é“å®ƒçš„å…·ä½“ç±»å‹ï¼Œä¸è¿‡åœ¨ Java é‡Œä»»ä½•å¯¹è±¡éƒ½æ˜¯ `Object` çš„å­ç±»ï¼Œæ‰€ä»¥è¿™é‡Œèƒ½æŠŠå®ƒèµ‹å€¼ç»™ `Object`ã€‚

    `Button` å¯¹è±¡ä¸€å®šæ˜¯è¿™ä¸ªæœªçŸ¥ç±»å‹çš„å­ç±»å‹ï¼Œæ ¹æ®å¤šæ€çš„ç‰¹æ€§ï¼Œè¿™é‡Œé€šè¿‡ `add` æ·»åŠ  `Button` å¯¹è±¡æ˜¯åˆæ³•çš„ã€‚

    ä½¿ç”¨ä¸‹ç•Œé€šé…ç¬¦ `? super` çš„æ³›å‹ `List`ï¼Œåªèƒ½è¯»å–åˆ° `Object` å¯¹è±¡ï¼Œä¸€èˆ¬æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ä½¿ç”¨åœºæ™¯ï¼Œé€šå¸¸ä¹Ÿåªæ‹¿å®ƒæ¥æ·»åŠ æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ¶ˆè´¹å·²æœ‰çš„ `List`ï¼Œå¾€é‡Œé¢æ·»åŠ  `Button`ï¼Œå› æ­¤è¿™ç§æ³›å‹ç±»å‹å£°æ˜ç§°ä¹‹ä¸ºã€Œæ¶ˆè´¹è€… Consumerã€ã€‚

    ------

    å°ç»“ä¸‹ï¼ŒJava çš„æ³›å‹æœ¬èº«æ˜¯ä¸æ”¯æŒåå˜å’Œé€†å˜çš„ã€‚

    - å¯ä»¥ä½¿ç”¨æ³›å‹é€šé…ç¬¦ `? extends` æ¥ä½¿æ³›å‹æ”¯æŒåå˜ï¼Œä½†æ˜¯ã€Œåªèƒ½è¯»å–ä¸èƒ½ä¿®æ”¹ã€ï¼Œè¿™é‡Œçš„ä¿®æ”¹ä»…æŒ‡å¯¹æ³›å‹é›†åˆæ·»åŠ å…ƒç´ ï¼Œå¦‚æœæ˜¯ `remove(int index)` ä»¥åŠ `clear` å½“ç„¶æ˜¯å¯ä»¥çš„ã€‚
    - å¯ä»¥ä½¿ç”¨æ³›å‹é€šé…ç¬¦ `? super` æ¥ä½¿æ³›å‹æ”¯æŒé€†å˜ï¼Œä½†æ˜¯ã€Œåªèƒ½ä¿®æ”¹ä¸èƒ½è¯»å–ã€ï¼Œè¿™é‡Œè¯´çš„ä¸èƒ½è¯»å–æ˜¯æŒ‡ä¸èƒ½æŒ‰ç…§æ³›å‹ç±»å‹è¯»å–ï¼Œä½ å¦‚æœæŒ‰ç…§ `Object` è¯»å‡ºæ¥å†å¼ºè½¬å½“ç„¶ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

    ### Kotlin ä¸­çš„ `out` å’Œ `in`

    å’Œ Java æ³›å‹ä¸€æ ·ï¼ŒKolin ä¸­çš„æ³›å‹æœ¬èº«ä¹Ÿæ˜¯ä¸å¯å˜çš„ã€‚

    - ä½¿ç”¨å…³é”®å­— `out` æ¥æ”¯æŒåå˜ï¼Œç­‰åŒäº Java ä¸­çš„ä¸Šç•Œé€šé…ç¬¦ `? extends`ã€‚
    - ä½¿ç”¨å…³é”®å­— `in` æ¥æ”¯æŒé€†å˜ï¼Œç­‰åŒäº Java ä¸­çš„ä¸‹ç•Œé€šé…ç¬¦ `? super`ã€‚

    ```kotlin
    ğŸï¸
    var textViews: List<out TextView>
    var textViews: List<in TextView>
    
    ```

    æ¢äº†ä¸ªå†™æ³•ï¼Œä½†ä½œç”¨æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚`out` è¡¨ç¤ºï¼Œæˆ‘è¿™ä¸ªå˜é‡æˆ–è€…å‚æ•°åªç”¨æ¥è¾“å‡ºï¼Œä¸ç”¨æ¥è¾“å…¥ï¼Œä½ åªèƒ½è¯»æˆ‘ä¸èƒ½å†™æˆ‘ï¼›`in` å°±åè¿‡æ¥ï¼Œè¡¨ç¤ºå®ƒåªç”¨æ¥è¾“å…¥ï¼Œä¸ç”¨æ¥è¾“å‡ºï¼Œä½ åªèƒ½å†™æˆ‘ä¸èƒ½è¯»æˆ‘ã€‚

    è¯´äº†è¿™ä¹ˆå¤š `List`ï¼Œå…¶å®æ³›å‹åœ¨éé›†åˆç±»çš„ä½¿ç”¨ä¹Ÿéå¸¸å¹¿æ³›ï¼Œå°±ä»¥ã€Œç”Ÿäº§è€…-æ¶ˆè´¹è€…ã€ä¸ºä¾‹å­ï¼š

    ```kotlin
    ğŸï¸
    class Producer<T> {
        fun produce(): T {
            ...
        }
    }
    
    val producer: Producer<out TextView> = Producer<Button>()
    val textView: TextView = producer.produce() // ğŸ‘ˆ ç›¸å½“äº 'List' çš„ `get`
    
    ```

    ```kotlin
    ğŸï¸            
    class Consumer<T> {
        fun consume(t: T) {
            ...
        }
    }
    
    val consumer: Consumer<in Button> = Consumer<TextView>()
    consumer.consume(Button(context))  // ğŸ‘ˆ ç›¸å½“äº 'List' çš„ 'add'
    
    ```

    åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œåœ¨å£°æ˜ `Producer` çš„æ—¶å€™å·²ç»ç¡®å®šäº†æ³›å‹ `T` åªä¼šä½œä¸ºè¾“å‡ºæ¥ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦åœ¨ä½¿ç”¨çš„æ—¶å€™åŠ ä¸Š `out TextView` æ¥æ”¯æŒåå˜ï¼Œå†™èµ·æ¥å¾ˆéº»çƒ¦ã€‚

    Kotlin æä¾›äº†å¦å¤–ä¸€ç§å†™æ³•ï¼šå¯ä»¥åœ¨å£°æ˜ç±»çš„æ—¶å€™ï¼Œç»™æ³›å‹ç¬¦å·åŠ ä¸Š `out` å…³é”®å­—ï¼Œè¡¨æ˜æ³›å‹å‚æ•° `T` åªä¼šç”¨æ¥è¾“å‡ºï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å°±ä¸ç”¨é¢å¤–åŠ  `out` äº†ã€‚

    ```kotlin
    ğŸï¸             ğŸ‘‡
    class Producer<out T> {
        fun produce(): T {
            ...
        }
    }
    
    val producer: Producer<TextView> = Producer<Button>() // ğŸ‘ˆ è¿™é‡Œä¸å†™ out ä¹Ÿä¸ä¼šæŠ¥é”™
    val producer: Producer<out TextView> = Producer<Button>() // ğŸ‘ˆ out å¯ä»¥ä½†æ²¡å¿…è¦
    
    ```

    ä¸ `out` ä¸€æ ·ï¼Œå¯ä»¥åœ¨å£°æ˜ç±»çš„æ—¶å€™ï¼Œç»™æ³›å‹å‚æ•°åŠ ä¸Š `in` å…³é”®å­—ï¼Œæ¥è¡¨æ˜è¿™ä¸ªæ³›å‹å‚æ•° `T` åªç”¨æ¥è¾“å…¥ã€‚

    ```kotlin
    ğŸï¸            ğŸ‘‡
    class Consumer<in T> {
        fun consume(t: T) {
            ...
        }
    }
    â€‹
    val consumer: Consumer<Button> = Consumer<TextView>() // ğŸ‘ˆ è¿™é‡Œä¸å†™ in ä¹Ÿä¸ä¼šæŠ¥é”™
    val consumer: Consumer<in Button> = Consumer<TextView>() // ğŸ‘ˆ in å¯ä»¥ä½†æ²¡å¿…è¦
    
    ```

    ### `*` å·

    å‰é¢è®²åˆ°äº† Java ä¸­å•ä¸ª `?` å·ä¹Ÿèƒ½ä½œä¸ºæ³›å‹é€šé…ç¬¦ä½¿ç”¨ï¼Œç›¸å½“äº `? extends Object`ã€‚ å®ƒåœ¨ Kotlin ä¸­æœ‰ç­‰æ•ˆçš„å†™æ³•ï¼š`*` å·ï¼Œç›¸å½“äº `out Any`ã€‚

    ```kotlin
    ğŸï¸            ğŸ‘‡
    var list: List<*>
    
    ```

    å’Œ Java ä¸åŒçš„åœ°æ–¹æ˜¯ï¼Œå¦‚æœä½ çš„ç±»å‹å®šä¹‰é‡Œå·²ç»æœ‰äº† `out` æˆ–è€… `in`ï¼Œé‚£è¿™ä¸ªé™åˆ¶åœ¨å˜é‡å£°æ˜æ—¶ä¹Ÿä¾ç„¶åœ¨ï¼Œä¸ä¼šè¢« `*` å·å»æ‰ã€‚

    æ¯”å¦‚ä½ çš„ç±»å‹å®šä¹‰é‡Œæ˜¯ `out T : Number` çš„ï¼Œé‚£å®ƒåŠ ä¸Š `<*>` ä¹‹åçš„æ•ˆæœå°±ä¸æ˜¯ `out Any`ï¼Œè€Œæ˜¯ `out Number`ã€‚

    ### `where` å…³é”®å­—

    Java ä¸­å£°æ˜ç±»æˆ–æ¥å£çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ `extends` æ¥è®¾ç½®è¾¹ç•Œï¼Œå°†æ³›å‹ç±»å‹å‚æ•°é™åˆ¶ä¸ºæŸä¸ªç±»å‹çš„å­é›†ï¼š

    ```java
    â˜•ï¸                
    //                ğŸ‘‡  T çš„ç±»å‹å¿…é¡»æ˜¯ Animal çš„å­ç±»å‹
    class Monster<T extends Animal>{
    }
    
    ```

    æ³¨æ„è¿™ä¸ªå’Œå‰é¢è®²çš„å£°æ˜å˜é‡æ—¶çš„æ³›å‹ç±»å‹å£°æ˜æ˜¯ä¸åŒçš„ä¸œè¥¿ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰ `?`ã€‚

    åŒæ—¶è¿™ä¸ªè¾¹ç•Œæ˜¯å¯ä»¥è®¾ç½®å¤šä¸ªï¼Œç”¨ `&` ç¬¦å·è¿æ¥ï¼š

    ```java
    â˜•ï¸
    //                            ğŸ‘‡  T çš„ç±»å‹å¿…é¡»åŒæ—¶æ˜¯ Animal å’Œ Food çš„å­ç±»å‹
    class Monster<T extends Animal & Food>{ 
    }
    
    ```

    Kotlin åªæ˜¯æŠŠ `extends` æ¢æˆäº† `:` å†’å·ã€‚

    ```kotlin
    ğŸï¸             ğŸ‘‡
    class Monster<T : Animal>
    
    ```

    è®¾ç½®å¤šä¸ªè¾¹ç•Œå¯ä»¥ä½¿ç”¨ `where` å…³é”®å­—ï¼š

    ```kotlin
    ğŸï¸                ğŸ‘‡
    class Monster<T> where T : Animal, T : Food
    
    ```

    æœ‰äººåœ¨çœ‹æ–‡æ¡£çš„æ—¶å€™è§‰å¾—è¿™ä¸ª `where` æ˜¯ä¸ªæ–°ä¸œè¥¿ï¼Œå…¶å®è™½ç„¶ Java é‡Œæ²¡æœ‰ `where` ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å¸¦æ¥æ–°åŠŸèƒ½ï¼Œåªæ˜¯æŠŠä¸€ä¸ªè€åŠŸèƒ½æ¢äº†ä¸ªæ–°å†™æ³•ã€‚

    ä¸è¿‡ç¬”è€…è§‰å¾— Kotlin é‡Œ `where` è¿™æ ·çš„å†™æ³•å¯è¯»æ€§æ›´ç¬¦åˆè‹±æ–‡é‡Œçš„è¯­æ³•ï¼Œå°¤å…¶æ˜¯å¦‚æœ `Monster` æœ¬èº«è¿˜æœ‰ç»§æ‰¿çš„æ—¶å€™ï¼š

    ```kotlin
    ğŸï¸
    class Monster<T> : MonsterParent<T>
        where T : Animal
    
    ```

    ### `reified` å…³é”®å­—

    ç”±äº Java ä¸­çš„æ³›å‹å­˜åœ¨ç±»å‹æ“¦é™¤çš„æƒ…å†µï¼Œä»»ä½•åœ¨è¿è¡Œæ—¶éœ€è¦çŸ¥é“æ³›å‹ç¡®åˆ‡ç±»å‹ä¿¡æ¯çš„æ“ä½œéƒ½æ²¡æ³•ç”¨äº†ã€‚

    æ¯”å¦‚ä½ ä¸èƒ½æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºæ³›å‹ç±»å‹ `T` çš„å®ä¾‹ï¼š

    ```kotlin
    â˜•ï¸
    <T> void printIfTypeMatch(Object item) {
        if (item instanceof T) { // ğŸ‘ˆ IDE ä¼šæç¤ºé”™è¯¯ï¼Œillegal generic type for instanceof
            System.out.println(item);
        }
    }
    
    ```

    Kotlin é‡ŒåŒæ ·ä¹Ÿä¸è¡Œï¼š

    ```kotlin
    ğŸï¸
    fun <T> printIfTypeMatch(item: Any) {
        if (item is T) { // ğŸ‘ˆ IDE ä¼šæç¤ºé”™è¯¯ï¼ŒCannot check for instance of erased type: T
            println(item)
        }
    }
    
    ```

    è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ Java ä¸­çš„è§£å†³æ–¹æ¡ˆé€šå¸¸æ˜¯é¢å¤–ä¼ é€’ä¸€ä¸ª `Class` ç±»å‹çš„å‚æ•°ï¼Œç„¶åé€šè¿‡ `Class#isInstance` 

    æ–¹æ³•æ¥æ£€æŸ¥ï¼š

    ```java
    â˜•ï¸                             ğŸ‘‡
    <T> void check(Object item, Class<T> type) {
        if (type.isInstance(item)) {
                   ğŸ‘†
            System.out.println(item);
        }
    }
    
    ```

    Kotlin ä¸­åŒæ ·å¯ä»¥è¿™ä¹ˆè§£å†³ï¼Œä¸è¿‡è¿˜æœ‰ä¸€ä¸ªæ›´æ–¹ä¾¿çš„åšæ³•ï¼šä½¿ç”¨å…³é”®å­— `reified` é…åˆ `inline` æ¥è§£å†³ï¼š

    ```kotlin
    ğŸï¸ ğŸ‘‡         ğŸ‘‡
    inline fun <reified T> printIfTypeMatch(item: Any) {
        if (item is T) { // ğŸ‘ˆ è¿™é‡Œå°±ä¸ä¼šåœ¨æç¤ºé”™è¯¯äº†
            println(item)
        }
    }
    
    ```

    ------

    1. Java é‡Œçš„æ•°ç»„æ˜¯æ”¯æŒåå˜çš„ï¼Œè€Œ Kotlin ä¸­çš„æ•°ç»„ `Array` ä¸æ”¯æŒåå˜ã€‚

       è¿™æ˜¯å› ä¸ºåœ¨ Kotlin ä¸­æ•°ç»„æ˜¯ç”¨ `Array` ç±»æ¥è¡¨ç¤ºçš„ï¼Œè¿™ä¸ª `Array` ç±»ä½¿ç”¨æ³›å‹å°±å’Œé›†åˆç±»ä¸€æ ·ï¼Œæ‰€ä»¥ä¸æ”¯æŒåå˜ã€‚

    2. Java ä¸­çš„ `List` æ¥å£ä¸æ”¯æŒåå˜ï¼Œè€Œ Kotlin ä¸­çš„ `List` æ¥å£æ”¯æŒåå˜ã€‚

       Java ä¸­çš„ `List` ä¸æ”¯æŒåå˜ï¼ŒåŸå› åœ¨ä¸Šæ–‡å·²ç»è®²è¿‡äº†ï¼Œéœ€è¦ä½¿ç”¨æ³›å‹é€šé…ç¬¦æ¥è§£å†³ã€‚

       åœ¨ Kotlin ä¸­ï¼Œå®é™…ä¸Š `MutableList` æ¥å£æ‰ç›¸å½“äº Java çš„ `List`ã€‚Kotlin ä¸­çš„ `List` æ¥å£å®ç°äº†åªè¯»æ“ä½œï¼Œæ²¡æœ‰å†™æ“ä½œï¼Œæ‰€ä»¥ä¸ä¼šæœ‰ç±»å‹å®‰å…¨ä¸Šçš„é—®é¢˜ï¼Œè‡ªç„¶å¯ä»¥æ”¯æŒåå˜ã€‚

38. ### Kotlin çš„åç¨‹

    ### åç¨‹æ˜¯ä»€ä¹ˆ

    > ä» Android å¼€å‘è€…çš„è§’åº¦å»ç†è§£å®ƒä»¬çš„å…³ç³»ï¼š
    >
    > - æˆ‘ä»¬æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯è·‘åœ¨çº¿ç¨‹ä¸­çš„ï¼Œè€Œçº¿ç¨‹æ˜¯è·‘åœ¨è¿›ç¨‹ä¸­çš„ã€‚
    > - åç¨‹æ²¡æœ‰ç›´æ¥å’Œæ“ä½œç³»ç»Ÿå…³è”ï¼Œä½†å®ƒä¸æ˜¯ç©ºä¸­æ¥¼é˜ï¼Œå®ƒä¹Ÿæ˜¯è·‘åœ¨çº¿ç¨‹ä¸­çš„ï¼Œå¯ä»¥æ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šçº¿ç¨‹ã€‚
    > - å•çº¿ç¨‹ä¸­çš„åç¨‹æ€»çš„æ‰§è¡Œæ—¶é—´å¹¶ä¸ä¼šæ¯”ä¸ç”¨åç¨‹å°‘ã€‚
    > - Android ç³»ç»Ÿä¸Šï¼Œå¦‚æœåœ¨ä¸»çº¿ç¨‹è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œä¼šæŠ›å‡º `NetworkOnMainThreadException`ï¼Œå¯¹äºåœ¨ä¸»çº¿ç¨‹ä¸Šçš„åç¨‹ä¹Ÿä¸ä¾‹å¤–ï¼Œè¿™ç§åœºæ™¯ä½¿ç”¨åç¨‹è¿˜æ˜¯è¦åˆ‡çº¿ç¨‹çš„ã€‚
    >
    > åç¨‹è®¾è®¡çš„åˆè¡·æ˜¯ä¸ºäº†è§£å†³å¹¶å‘é—®é¢˜ï¼Œè®© ã€Œåä½œå¼å¤šä»»åŠ¡ã€ å®ç°èµ·æ¥æ›´åŠ æ–¹ä¾¿ã€‚

    åç¨‹å°±æ˜¯ Kotlin æä¾›çš„ä¸€å¥—çº¿ç¨‹å°è£…çš„ APIï¼Œä½†å¹¶ä¸æ˜¯è¯´åç¨‹å°±æ˜¯ä¸ºçº¿ç¨‹è€Œç”Ÿçš„ã€‚

    ä¸è¿‡ï¼Œæˆ‘ä»¬å­¦ä¹  Kotlin ä¸­çš„åç¨‹ï¼Œä¸€å¼€å§‹ç¡®å®å¯ä»¥ä»çº¿ç¨‹æ§åˆ¶çš„è§’åº¦æ¥åˆ‡å…¥ã€‚å› ä¸ºåœ¨ Kotlin ä¸­ï¼Œåç¨‹çš„ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯çº¿ç¨‹æ§åˆ¶ã€‚å°±åƒ Java ä¸­çš„ `Executor` å’Œ Android ä¸­çš„ `AsyncTask`ï¼ŒKotlin ä¸­çš„åç¨‹ä¹Ÿæœ‰å¯¹ Thread API çš„å°è£…ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨å†™ä»£ç æ—¶ï¼Œä¸ç”¨å…³æ³¨å¤šçº¿ç¨‹å°±èƒ½å¤Ÿå¾ˆæ–¹ä¾¿åœ°å†™å‡ºå¹¶å‘æ“ä½œã€‚

    åœ¨ Java ä¸­è¦å®ç°å¹¶å‘æ“ä½œé€šå¸¸éœ€è¦å¼€å¯ä¸€ä¸ª `Thread` ï¼š

    ```java
    â˜•ï¸
    new Thread(new Runnable() {
        @Override
        public void run() {
            ...
        }
    }).start();
    
    ```

    Kotlin ä¸­åŒæ ·å¯ä»¥é€šè¿‡çº¿ç¨‹çš„æ–¹å¼å»å†™ï¼š

    ```kotlin
    ğŸï¸
    Thread({
        ...
    }).start()
    
    ```

    å¯ä»¥çœ‹åˆ°ï¼Œå’Œ Java ä¸€æ ·ä¹Ÿæ‘†è„±ä¸äº†ç›´æ¥ä½¿ç”¨ `Thead` çš„é‚£äº›å›°éš¾å’Œä¸æ–¹ä¾¿ï¼š

    - çº¿ç¨‹ä»€ä¹ˆæ—¶å€™æ‰§è¡Œç»“æŸ
    - çº¿ç¨‹é—´çš„ç›¸äº’é€šä¿¡
    - å¤šä¸ªçº¿ç¨‹çš„ç®¡ç†

    æˆ‘ä»¬å¯ä»¥ç”¨ Java çš„ `Executor` çº¿ç¨‹æ± æ¥è¿›è¡Œçº¿ç¨‹ç®¡ç†ï¼š

    ```kotlin
    ğŸï¸
    val executor = Executors.newCachedThreadPool()
    executor.execute({
        ...
    })
    
    ```

    ------

    ä¸‹é¢çš„ä¾‹å­æ˜¯ä½¿ç”¨åç¨‹è¿›è¡Œç½‘ç»œè¯·æ±‚è·å–ç”¨æˆ·ä¿¡æ¯å¹¶æ˜¾ç¤ºåˆ° UI æ§ä»¶ä¸Šï¼š

    ```kotlin
    ğŸï¸
    launch({
        val user = api.getUser() // ğŸ‘ˆ ç½‘ç»œè¯·æ±‚ï¼ˆIO çº¿ç¨‹ï¼‰
        nameTv.text = user.name  // ğŸ‘ˆ æ›´æ–° UIï¼ˆä¸»çº¿ç¨‹ï¼‰
    })
    
    ```

    è¿™é‡Œåªæ˜¯å±•ç¤ºäº†ä¸€ä¸ªä»£ç ç‰‡æ®µï¼Œ`launch` å¹¶ä¸æ˜¯ä¸€ä¸ªé¡¶å±‚å‡½æ•°ï¼Œå®ƒå¿…é¡»åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬ä¹‹åå†è®²ï¼Œè¿™é‡Œåªå…³å¿ƒå®ƒå†…éƒ¨ä¸šåŠ¡é€»è¾‘çš„å†™æ³•ã€‚

    `launch` å‡½æ•°åŠ ä¸Šå®ç°åœ¨ `{}` ä¸­å…·ä½“çš„é€»è¾‘ï¼Œå°±æ„æˆäº†ä¸€ä¸ªåç¨‹ã€‚

    é€šå¸¸æˆ‘ä»¬åšç½‘ç»œè¯·æ±‚ï¼Œè¦ä¸å°±ä¼ ä¸€ä¸ª callbackï¼Œè¦ä¸å°±æ˜¯åœ¨ IO çº¿ç¨‹é‡Œè¿›è¡Œé˜»å¡å¼çš„åŒæ­¥è°ƒç”¨ï¼Œè€Œåœ¨è¿™æ®µä»£ç ä¸­ï¼Œä¸Šä¸‹ä¸¤ä¸ªè¯­å¥åˆ†åˆ«å·¥ä½œåœ¨ä¸¤ä¸ªçº¿ç¨‹é‡Œï¼Œä½†å†™æ³•ä¸Šçœ‹èµ·æ¥å’Œæ™®é€šçš„å•çº¿ç¨‹ä»£ç ä¸€æ ·ã€‚

    è¿™é‡Œçš„ `api.getUser` æ˜¯ä¸€ä¸ª**æŒ‚èµ·å‡½æ•°**ï¼Œæ‰€ä»¥èƒ½å¤Ÿä¿è¯ `nameTv.text` çš„æ­£ç¡®èµ‹å€¼.

    ### åç¨‹å¥½åœ¨å“ª

    åœ¨è®²ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ã€Œé—­åŒ…ã€è¿™ä¸ªæ¦‚å¿µï¼Œè°ƒç”¨ Kotlin åç¨‹ä¸­çš„ APIï¼Œç»å¸¸ä¼šç”¨åˆ°é—­åŒ…å†™æ³•ã€‚

    å…¶å®é—­åŒ…å¹¶ä¸æ˜¯ Kotlin ä¸­çš„æ–°æ¦‚å¿µï¼Œåœ¨ Java 8 ä¸­å°±å·²ç»æ”¯æŒã€‚

    æˆ‘ä»¬å…ˆä»¥ `Thread` ä¸ºä¾‹ï¼Œæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯é—­åŒ…ï¼š

    ```kotlin
    ğŸï¸
    // åˆ›å»ºä¸€ä¸ª Thread çš„å®Œæ•´å†™æ³•
    Thread(object : Runnable {
        override fun run() {
            ...
        }
    })
    â€‹
    // æ»¡è¶³ SAMï¼Œå…ˆç®€åŒ–ä¸º
    Thread({
        ...
    })
    â€‹
    // ä½¿ç”¨é—­åŒ…ï¼Œå†ç®€åŒ–ä¸º
    Thread {
        ...
    }
    
    ```

    å½¢å¦‚ `Thread {...}` è¿™æ ·çš„ç»“æ„ä¸­ `{}` å°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚

    åœ¨ Kotlin ä¸­æœ‰è¿™æ ·ä¸€ä¸ªè¯­æ³•ç³–ï¼šå½“å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ lambda è¡¨è¾¾å¼æ—¶ï¼Œå¯ä»¥å°† lambda å†™åœ¨æ‹¬å·å¤–ã€‚è¿™å°±æ˜¯å®ƒçš„é—­åŒ…åŸåˆ™ã€‚

    åœ¨è¿™é‡Œéœ€è¦ä¸€ä¸ªç±»å‹ä¸º `Runnable` çš„å‚æ•°ï¼Œè€Œ `Runnable` æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸”åªå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° `run`ï¼Œè¿™ç§æƒ…å†µæ»¡è¶³äº† Kotlin çš„ [SAM](https://medium.com/tompee/idiomatic-kotlin-lambdas-and-sam-constructors-fe2075965bfb)ï¼Œå¯ä»¥è½¬æ¢æˆä¼ é€’ä¸€ä¸ª lambda è¡¨è¾¾å¼ï¼ˆç¬¬äºŒæ®µï¼‰ï¼Œå› ä¸ºæ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œæ ¹æ®é—­åŒ…åŸåˆ™æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å†™æˆ `Thread {...}`ï¼ˆç¬¬ä¸‰æ®µï¼‰ çš„å½¢å¼ã€‚

    å¯¹äºä¸Šæ–‡æ‰€ä½¿ç”¨çš„ `launch` å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡é—­åŒ…æ¥è¿›è¡Œç®€åŒ– ï¼š

    ```kotlin
    ğŸï¸
    launch {
        ...
    }
    
    ```

    #### åŸºæœ¬ä½¿ç”¨

    å‰é¢æåˆ°ï¼Œ`launch` å‡½æ•°ä¸æ˜¯é¡¶å±‚å‡½æ•°ï¼Œæ˜¯ä¸èƒ½ç›´æ¥ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸‰ç§æ–¹æ³•æ¥åˆ›å»ºåç¨‹ï¼š

    ```kotlin
    ğŸï¸
    // æ–¹æ³•ä¸€ï¼Œä½¿ç”¨ runBlocking é¡¶å±‚å‡½æ•°
    runBlocking {
        getImage(imageId)
    }
    
    // æ–¹æ³•äºŒï¼Œä½¿ç”¨ GlobalScope å•ä¾‹å¯¹è±¡
    //            ğŸ‘‡ å¯ä»¥ç›´æ¥è°ƒç”¨ launch å¼€å¯åç¨‹
    GlobalScope.launch {
        getImage(imageId)
    }
    
    // æ–¹æ³•ä¸‰ï¼Œè‡ªè¡Œé€šè¿‡ CoroutineContext åˆ›å»ºä¸€ä¸ª CoroutineScope å¯¹è±¡
    //                                    ğŸ‘‡ éœ€è¦ä¸€ä¸ªç±»å‹ä¸º CoroutineContext çš„å‚æ•°
    val coroutineScope = CoroutineScope(context)
    coroutineScope.launch {
        getImage(imageId)
    }
    
    ```

    - æ–¹æ³•ä¸€é€šå¸¸é€‚ç”¨äºå•å…ƒæµ‹è¯•çš„åœºæ™¯ï¼Œè€Œä¸šåŠ¡å¼€å‘ä¸­ä¸ä¼šç”¨åˆ°è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºå®ƒæ˜¯çº¿ç¨‹é˜»å¡çš„ã€‚
    - æ–¹æ³•äºŒå’Œä½¿ç”¨ `runBlocking` çš„åŒºåˆ«åœ¨äºä¸ä¼šé˜»å¡çº¿ç¨‹ã€‚ä½†åœ¨ Android å¼€å‘ä¸­åŒæ ·ä¸æ¨èè¿™ç§ç”¨æ³•ï¼Œå› ä¸ºå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¼šå’Œ app ä¸€è‡´ï¼Œä¸”ä¸èƒ½å–æ¶ˆï¼ˆä»€ä¹ˆæ˜¯åç¨‹çš„å–æ¶ˆåé¢çš„æ–‡ç« ä¼šè®²ï¼‰ã€‚
    - æ–¹æ³•ä¸‰æ˜¯æ¯”è¾ƒæ¨èçš„ä½¿ç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `context` å‚æ•°å»ç®¡ç†å’Œæ§åˆ¶åç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼ˆè¿™é‡Œçš„ `context` å’Œ Android é‡Œçš„ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œæ˜¯ä¸€ä¸ªæ›´é€šç”¨çš„æ¦‚å¿µï¼Œä¼šæœ‰ä¸€ä¸ª Android å¹³å°çš„å°è£…æ¥é…åˆä½¿ç”¨ï¼‰ã€‚

    åç¨‹æœ€å¸¸ç”¨çš„åŠŸèƒ½æ˜¯å¹¶å‘ï¼Œè€Œå¹¶å‘çš„å…¸å‹åœºæ™¯å°±æ˜¯å¤šçº¿ç¨‹ã€‚å¯ä»¥ä½¿ç”¨ `Dispatchers.IO` å‚æ•°æŠŠä»»åŠ¡åˆ‡åˆ° IO çº¿ç¨‹æ‰§è¡Œï¼š

    ```
    ğŸï¸
    coroutineScope.launch(Dispatchers.IO) {
        ...
    }
    
    ```

    ä¹Ÿå¯ä»¥ä½¿ç”¨ `Dispatchers.Main` å‚æ•°åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ï¼š

    ```kotlin
    ğŸï¸
    coroutineScope.launch(Dispatchers.Main) {
        ...
    }
    
    ```

    æ‰€ä»¥åœ¨ã€Œåç¨‹æ˜¯ä»€ä¹ˆã€ä¸€èŠ‚ä¸­è®²åˆ°çš„å¼‚æ­¥è¯·æ±‚çš„ä¾‹å­å®Œæ•´å†™å‡ºæ¥æ˜¯è¿™æ ·çš„ï¼š

    ```kotlin
    ğŸï¸
    coroutineScope.launch(Dispatchers.Main) {   // åœ¨ä¸»çº¿ç¨‹å¼€å¯åç¨‹
        val user = api.getUser() // IO çº¿ç¨‹æ‰§è¡Œç½‘ç»œè¯·æ±‚
        nameTv.text = user.name  // ä¸»çº¿ç¨‹æ›´æ–° UI
    }
    
    ```

    è€Œé€šè¿‡ Java å®ç°ä»¥ä¸Šé€»è¾‘ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦è¿™æ ·å†™ï¼š

    ```
    â˜•ï¸
    api.getUser(new Callback<User>() {
        @Override
        public void success(User user) {
            runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    nameTv.setText(user.name);
                }
            })
        }
        
        @Override
        public void failure(Exception e) {
            ...
        }
    });
    
    ```

    è¿™ç§å›è°ƒå¼çš„å†™æ³•ï¼Œæ‰“ç ´äº†ä»£ç çš„é¡ºåºç»“æ„å’Œå®Œæ•´æ€§ï¼Œè¯»èµ·æ¥ç›¸å½“éš¾å—ã€‚

    #### åç¨‹çš„ã€Œ1 åˆ° 0ã€

    å¯¹äºå›è°ƒå¼çš„å†™æ³•ï¼Œå¦‚æœå¹¶å‘åœºæ™¯å†å¤æ‚ä¸€äº›ï¼Œä»£ç çš„åµŒå¥—å¯èƒ½ä¼šæ›´å¤šï¼Œè¿™æ ·çš„è¯ç»´æŠ¤èµ·æ¥å°±éå¸¸éº»çƒ¦ã€‚ä½†å¦‚æœä½ ä½¿ç”¨äº† Kotlin åç¨‹ï¼Œå¤šå±‚ç½‘ç»œè¯·æ±‚åªéœ€è¦è¿™ä¹ˆå†™ï¼š

    ```kotlin
    ğŸï¸
    coroutineScope.launch(Dispatchers.Main) {       // å¼€å§‹åç¨‹ï¼šä¸»çº¿ç¨‹
        val token = api.getToken()                  // ç½‘ç»œè¯·æ±‚ï¼šIO çº¿ç¨‹
        val user = api.getUser(token)               // ç½‘ç»œè¯·æ±‚ï¼šIO çº¿ç¨‹
        nameTv.text = user.name                     // æ›´æ–° UIï¼šä¸»çº¿ç¨‹
    }
    
    ```

    å¦‚æœé‡åˆ°çš„åœºæ™¯æ˜¯å¤šä¸ªç½‘ç»œè¯·æ±‚éœ€è¦ç­‰å¾…æ‰€æœ‰è¯·æ±‚ç»“æŸä¹‹åå†å¯¹ UI è¿›è¡Œæ›´æ–°ã€‚æ¯”å¦‚ä»¥ä¸‹ä¸¤ä¸ªè¯·æ±‚ï¼š

    ```kotlin
    ğŸï¸
    api.getAvatar(user, callback)
    api.getCompanyLogo(user, callback)
    
    ```

    å¦‚æœä½¿ç”¨å›è°ƒå¼çš„å†™æ³•ï¼Œé‚£ä¹ˆä»£ç å¯èƒ½å†™èµ·æ¥æ—¢å›°éš¾åˆåˆ«æ‰­ã€‚äºæ˜¯æˆ‘ä»¬å¯èƒ½ä¼šé€‰æ‹©å¦¥åï¼Œé€šè¿‡å…ˆåè¯·æ±‚ä»£æ›¿åŒæ—¶è¯·æ±‚ï¼š

    ```kotlin
    ğŸï¸
    api.getAvatar(user) { avatar ->
        api.getCompanyLogo(user) { logo ->
            show(merge(avatar, logo))
        }
    }
    
    ```

    åœ¨å®é™…å¼€å‘ä¸­å¦‚æœè¿™æ ·å†™ï¼Œæœ¬æ¥èƒ½å¤Ÿå¹¶è¡Œå¤„ç†çš„è¯·æ±‚è¢«å¼ºåˆ¶é€šè¿‡ä¸²è¡Œçš„æ–¹å¼å»å®ç°ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç­‰å¾…æ—¶é—´é•¿äº†ä¸€å€ï¼Œä¹Ÿå°±æ˜¯æ€§èƒ½å·®äº†ä¸€å€ã€‚

    è€Œå¦‚æœä½¿ç”¨åç¨‹ï¼Œå¯ä»¥ç›´æ¥æŠŠä¸¤ä¸ªå¹¶è¡Œè¯·æ±‚å†™æˆä¸Šä¸‹ä¸¤è¡Œï¼Œæœ€åå†æŠŠç»“æœè¿›è¡Œåˆå¹¶å³å¯ï¼š

    ```kotlin
    ğŸï¸
    coroutineScope.launch(Dispatchers.Main) {
        //            ğŸ‘‡  async å‡½æ•°ä¹‹åå†è®²
        val avatar = async { api.getAvatar(user) }    // è·å–ç”¨æˆ·å¤´åƒ
        val logo = async { api.getCompanyLogo(user) } // è·å–ç”¨æˆ·æ‰€åœ¨å…¬å¸çš„ logo
        val merged = suspendingMerge(avatar, logo)    // åˆå¹¶ç»“æœ
        //                  ğŸ‘†
        show(merged) // æ›´æ–° UI
    }
    
    ```

    'å¯ä»¥çœ‹åˆ°ï¼Œå³ä¾¿æ˜¯æ¯”è¾ƒå¤æ‚çš„å¹¶è¡Œç½‘ç»œè¯·æ±‚ï¼Œä¹Ÿèƒ½å¤Ÿé€šè¿‡åç¨‹å†™å‡ºç»“æ„æ¸…æ™°çš„ä»£ç ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ `suspendingMerge` å¹¶ä¸æ˜¯åç¨‹ API ä¸­æä¾›çš„æ–¹æ³•ï¼Œè€Œæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸€ä¸ªå¯ã€ŒæŒ‚èµ·ã€çš„ç»“æœåˆå¹¶æ–¹æ³•ã€‚

    è®©å¤æ‚çš„å¹¶å‘ä»£ç ï¼Œå†™èµ·æ¥å˜å¾—ç®€å•ä¸”æ¸…æ™°ï¼Œæ˜¯åç¨‹çš„ä¼˜åŠ¿ã€‚

    è¿™é‡Œï¼Œä¸¤ä¸ªæ²¡æœ‰ç›¸å…³æ€§çš„åå°ä»»åŠ¡ï¼Œå› ä¸ºç”¨äº†åç¨‹ï¼Œè¢«å®‰æ’å¾—æ˜æ˜ç™½ç™½ï¼Œäº’ç›¸ä¹‹é—´é…åˆå¾—å¾ˆå¥½ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´çš„ã€Œåä½œå¼ä»»åŠ¡ã€ã€‚

    æœ¬æ¥éœ€è¦å›è°ƒï¼Œç°åœ¨ç›´æ¥æ²¡æœ‰å›è°ƒäº†ï¼Œè¿™ç§ä» 1 åˆ° 0 çš„è®¾è®¡æ€æƒ³çœŸçš„å¦™å“‰ã€‚


    Kotlin åç¨‹æ˜¯ä»¥å®˜æ–¹æ‰©å±•åº“çš„å½¢å¼è¿›è¡Œæ”¯æŒçš„ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„ã€Œæ ¸å¿ƒåº“ã€å’Œ ã€Œå¹³å°åº“ã€çš„ç‰ˆæœ¬åº”è¯¥ä¿æŒä¸€è‡´ã€‚

    - æ ¸å¿ƒåº“ä¸­åŒ…å«çš„ä»£ç ä¸»è¦æ˜¯åç¨‹çš„å…¬å…± API éƒ¨åˆ†ã€‚æœ‰äº†è¿™ä¸€å±‚å…¬å…±ä»£ç ï¼Œæ‰ä½¿å¾—åç¨‹åœ¨å„ä¸ªå¹³å°ä¸Šçš„æ¥å£å¾—åˆ°ç»Ÿä¸€ã€‚
    - å¹³å°åº“ä¸­åŒ…å«çš„ä»£ç ä¸»è¦æ˜¯åç¨‹æ¡†æ¶åœ¨å…·ä½“å¹³å°çš„å…·ä½“å®ç°æ–¹å¼ã€‚å› ä¸ºå¤šçº¿ç¨‹åœ¨å„ä¸ªå¹³å°çš„å®ç°æ–¹å¼æ˜¯æœ‰æ‰€å·®å¼‚çš„ã€‚

    #### å¼€å§‹ä½¿ç”¨åç¨‹

    åç¨‹æœ€ç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼Œå…¶å®åœ¨å‰é¢ç« èŠ‚å°±å·²ç»çœ‹åˆ°äº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ª `launch` å‡½æ•°å®ç°çº¿ç¨‹åˆ‡æ¢çš„åŠŸèƒ½ï¼š

    ```kotlin
    ğŸï¸
    //               ğŸ‘‡
    coroutineScope.launch(Dispatchers.IO) {
        ...
    }
    
    ```

    è¿™ä¸ª `launch` å‡½æ•°ï¼Œå®ƒå…·ä½“çš„å«ä¹‰æ˜¯ï¼šæˆ‘è¦åˆ›å»ºä¸€ä¸ªæ–°çš„åç¨‹ï¼Œå¹¶åœ¨æŒ‡å®šçš„çº¿ç¨‹ä¸Šè¿è¡Œå®ƒã€‚è¿™ä¸ªè¢«åˆ›å»ºã€è¢«è¿è¡Œçš„æ‰€è°“ã€Œåç¨‹ã€æ˜¯è°ï¼Ÿå°±æ˜¯ä½ ä¼ ç»™ `launch` çš„é‚£äº›ä»£ç ï¼Œè¿™ä¸€æ®µè¿ç»­ä»£ç å«åšä¸€ä¸ªã€Œåç¨‹ã€ã€‚

    æ‰€ä»¥ï¼Œä»€ä¹ˆæ—¶å€™ç”¨åç¨‹ï¼Ÿå½“ä½ éœ€è¦åˆ‡çº¿ç¨‹æˆ–è€…æŒ‡å®šçº¿ç¨‹çš„æ—¶å€™ã€‚ä½ è¦åœ¨åå°æ‰§è¡Œä»»åŠ¡ï¼Ÿåˆ‡ï¼

    ```kotlin
    ğŸï¸
    launch(Dispatchers.IO) {
        val image = getImage(imageId)
    }
    
    ```

    ç„¶åéœ€è¦åœ¨å‰å°æ›´æ–°ç•Œé¢ï¼Ÿå†åˆ‡ï¼

    ```kotlin
    ğŸï¸
    coroutineScope.launch(Dispatchers.IO) {
        val image = getImage(imageId)
        launch(Dispatch.Main) {
            avatarIv.setImageBitmap(image)
        }
    }
    
    ```

    å¥½åƒæœ‰ç‚¹ä¸å¯¹åŠ²ï¼Ÿè¿™ä¸è¿˜æ˜¯æœ‰åµŒå¥—å˜›ã€‚

    å¦‚æœåªæ˜¯ä½¿ç”¨ `launch` å‡½æ•°ï¼Œåç¨‹å¹¶ä¸èƒ½æ¯”çº¿ç¨‹åšæ›´å¤šçš„äº‹ã€‚ä¸è¿‡åç¨‹ä¸­å´æœ‰ä¸€ä¸ªå¾ˆå®ç”¨çš„å‡½æ•°ï¼š`withContext` ã€‚è¿™ä¸ªå‡½æ•°å¯ä»¥åˆ‡æ¢åˆ°æŒ‡å®šçš„çº¿ç¨‹ï¼Œå¹¶åœ¨é—­åŒ…å†…çš„é€»è¾‘æ‰§è¡Œç»“æŸä¹‹åï¼Œè‡ªåŠ¨æŠŠçº¿ç¨‹åˆ‡å›å»ç»§ç»­æ‰§è¡Œã€‚é‚£ä¹ˆå¯ä»¥å°†ä¸Šé¢çš„ä»£ç å†™æˆè¿™æ ·ï¼š

    ```kotlin
    ğŸï¸
    coroutineScope.launch(Dispatchers.Main) {      // ğŸ‘ˆ åœ¨ UI çº¿ç¨‹å¼€å§‹
        val image = withContext(Dispatchers.IO) {  // ğŸ‘ˆ åˆ‡æ¢åˆ° IO çº¿ç¨‹ï¼Œå¹¶åœ¨æ‰§è¡Œå®Œæˆååˆ‡å› UI çº¿ç¨‹
            getImage(imageId)                      // ğŸ‘ˆ å°†ä¼šè¿è¡Œåœ¨ IO çº¿ç¨‹
        }
        avatarIv.setImageBitmap(image)             // ğŸ‘ˆ å›åˆ° UI çº¿ç¨‹æ›´æ–° UI
    } 
    
    ```

    è¿™ç§å†™æ³•çœ‹ä¸Šå»å¥½åƒå’Œåˆšæ‰é‚£ç§åŒºåˆ«ä¸å¤§ï¼Œä½†å¦‚æœä½ éœ€è¦é¢‘ç¹åœ°è¿›è¡Œçº¿ç¨‹åˆ‡æ¢ï¼Œè¿™ç§å†™æ³•çš„ä¼˜åŠ¿å°±ä¼šä½“ç°å‡ºæ¥ã€‚å¯ä»¥å‚è€ƒä¸‹é¢çš„å¯¹æ¯”ï¼š

    ```kotlin
    ğŸï¸
    // ç¬¬ä¸€ç§å†™æ³•
    coroutineScope.launch(Dispachers.IO) {
        ...
        launch(Dispachers.Main){
            ...
            launch(Dispachers.IO) {
                ...
                launch(Dispacher.Main) {
                    ...
                }
            }
        }
    }
    â€‹
    // é€šè¿‡ç¬¬äºŒç§å†™æ³•æ¥å®ç°ç›¸åŒçš„é€»è¾‘
    coroutineScope.launch(Dispachers.Main) {
        ...
        withContext(Dispachers.IO) {
            ...
        }
        ...
        withContext(Dispachers.IO) {
            ...
        }
        ...
    }
    
    ```

    ç”±äºå¯ä»¥"è‡ªåŠ¨åˆ‡å›æ¥"ï¼Œæ¶ˆé™¤äº†å¹¶å‘ä»£ç åœ¨åä½œæ—¶çš„åµŒå¥—ã€‚ç”±äºæ¶ˆé™¤äº†åµŒå¥—å…³ç³»ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æŠŠ `withContext` æ”¾è¿›ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°é‡Œé¢ï¼š

    ```
    ğŸï¸
    launch(Dispachers.Main) {              // ğŸ‘ˆ åœ¨ UI çº¿ç¨‹å¼€å§‹
        val image = getImage(imageId)
        avatarIv.setImageBitmap(image)     // ğŸ‘ˆ æ‰§è¡Œç»“æŸåï¼Œè‡ªåŠ¨åˆ‡æ¢å› UI çº¿ç¨‹
    }
    //                               ğŸ‘‡
    fun getImage(imageId: Int) = withContext(Dispatchers.IO) {
        ...
    }
    
    ```

    è¿™å°±æ˜¯ä¹‹å‰è¯´çš„ã€Œç”¨åŒæ­¥çš„æ–¹å¼å†™å¼‚æ­¥çš„ä»£ç ã€äº†ã€‚

    ä¸è¿‡å¦‚æœåªæ˜¯è¿™æ ·å†™ï¼Œç¼–è¯‘å™¨æ˜¯ä¼šæŠ¥é”™çš„ï¼š

    ```kotlin
    ğŸï¸
    fun getImage(imageId: Int) = withContext(Dispatchers.IO) {
        // IDE æŠ¥é”™ Suspend function'withContext' should be called only from a coroutine or another suspend funcion
    }
    
    ```

    æ„æ€æ˜¯è¯´ï¼Œ`withContext` æ˜¯ä¸€ä¸ª `suspend` å‡½æ•°ï¼Œå®ƒéœ€è¦åœ¨åç¨‹æˆ–è€…æ˜¯å¦ä¸€ä¸ª `suspend` å‡½æ•°ä¸­è°ƒç”¨ã€‚

    ------

    å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ç”¨ `launch` å‡½æ•°æ¥åˆ›å»ºåç¨‹ï¼Œå…¶å®è¿˜æœ‰å…¶ä»–ä¸¤ä¸ªå‡½æ•°ä¹Ÿå¯ä»¥ç”¨æ¥åˆ›å»ºåç¨‹ï¼š

    - `runBlocking`
    - `async`

    `runBlocking` é€šå¸¸é€‚ç”¨äºå•å…ƒæµ‹è¯•çš„åœºæ™¯ï¼Œè€Œä¸šåŠ¡å¼€å‘ä¸­ä¸ä¼šç”¨åˆ°è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºå®ƒæ˜¯çº¿ç¨‹é˜»å¡çš„ã€‚

    æ¥ä¸‹æ¥æˆ‘ä»¬ä¸»è¦æ¥å¯¹æ¯” `launch` ä¸ `async` è¿™ä¸¤ä¸ªå‡½æ•°ã€‚

    - ç›¸åŒç‚¹ï¼šå®ƒä»¬éƒ½å¯ä»¥ç”¨æ¥å¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œè¿”å›çš„éƒ½æ˜¯ `Coroutine`ï¼Œæˆ‘ä»¬è¿™é‡Œä¸éœ€è¦çº ç»“å…·ä½“æ˜¯è¿”å›å“ªä¸ªç±»ã€‚
    - ä¸åŒç‚¹ï¼š`async` è¿”å›çš„ `Coroutine` å¤šå®ç°äº† `Deferred` æ¥å£ã€‚

    å…³äº `Deferred` æ›´æ·±å…¥çš„çŸ¥è¯†å°±ä¸åœ¨è¿™é‡Œè¿‡å¤šé˜è¿°ï¼Œå®ƒçš„æ„æ€å°±æ˜¯å»¶è¿Ÿï¼Œä¹Ÿå°±æ˜¯ç»“æœç¨åæ‰èƒ½æ‹¿åˆ°ã€‚

    æˆ‘ä»¬è°ƒç”¨ `Deferred.await()` å°±å¯ä»¥å¾—åˆ°ç»“æœäº†ã€‚

    æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­çœ‹çœ‹ `async` æ˜¯å¦‚ä½•ä½¿ç”¨çš„

    ```kotlin
    ğŸï¸
    
    coroutineScope.launch(Dispatchers.Main) {
        //                      ğŸ‘‡  async å‡½æ•°å¯åŠ¨æ–°çš„åç¨‹
        val avatar: Deferred = async { api.getAvatar(user) }    // è·å–ç”¨æˆ·å¤´åƒ
        val logo: Deferred = async { api.getCompanyLogo(user) } // è·å–ç”¨æˆ·æ‰€åœ¨å…¬å¸çš„ logo
        //            ğŸ‘‡          ğŸ‘‡ è·å–è¿”å›å€¼
        show(avatar.await(), logo.await())                     // æ›´æ–° UI
        
      }
        
    
    ```

    å¯ä»¥çœ‹åˆ° avatar å’Œ logo çš„ç±»å‹å¯ä»¥å£°æ˜ä¸º `Deferred` ï¼Œé€šè¿‡ `await` è·å–ç»“æœå¹¶ä¸”æ›´æ–°åˆ° UI ä¸Šæ˜¾ç¤ºã€‚

    `await` å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

    ```kotlin
    public suspend fun await(): T
    
    ```

39. ### suspend ã€ŒæŒ‚èµ·ã€çš„æœ¬è´¨

    > **æŒ‚èµ·ï¼Œå°±æ˜¯ä¸€ä¸ªç¨åä¼šè¢«è‡ªåŠ¨åˆ‡å›æ¥çš„çº¿ç¨‹è°ƒåº¦æ“ä½œã€‚**

    åç¨‹ä¸­ã€ŒæŒ‚èµ·ã€çš„å¯¹è±¡åˆ°åº•æ˜¯ä»€ä¹ˆï¼ŸæŒ‚èµ·çº¿ç¨‹ï¼Œè¿˜æ˜¯æŒ‚èµ·å‡½æ•°ï¼Ÿéƒ½ä¸å¯¹ï¼Œ**æˆ‘ä»¬æŒ‚èµ·çš„å¯¹è±¡æ˜¯åç¨‹ã€‚**

    è¿˜è®°å¾—åç¨‹æ˜¯ä»€ä¹ˆå—ï¼Ÿå¯åŠ¨ä¸€ä¸ªåç¨‹å¯ä»¥ä½¿ç”¨ `launch` æˆ–è€… `async` å‡½æ•°ï¼Œåç¨‹å…¶å®å°±æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°ä¸­é—­åŒ…çš„ä»£ç å—ã€‚

    `launch` ï¼Œ`async` æˆ–è€…å…¶ä»–å‡½æ•°åˆ›å»ºçš„åç¨‹ï¼Œåœ¨æ‰§è¡Œåˆ°æŸä¸€ä¸ª `suspend` å‡½æ•°çš„æ—¶å€™ï¼Œè¿™ä¸ªåç¨‹ä¼šè¢«ã€Œsuspendã€ï¼Œä¹Ÿå°±æ˜¯è¢«æŒ‚èµ·ã€‚

    é‚£æ­¤æ—¶åˆæ˜¯ä»å“ªé‡ŒæŒ‚èµ·ï¼Ÿ**ä»å½“å‰çº¿ç¨‹æŒ‚èµ·ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯è¿™ä¸ªåç¨‹ä»æ­£åœ¨æ‰§è¡Œå®ƒçš„çº¿ç¨‹ä¸Šè„±ç¦»ã€‚**

    æ³¨æ„ï¼Œä¸æ˜¯è¿™ä¸ªåç¨‹åœä¸‹æ¥äº†ï¼æ˜¯è„±ç¦»ï¼Œå½“å‰çº¿ç¨‹ä¸å†ç®¡è¿™ä¸ªåç¨‹è¦å»åšä»€ä¹ˆäº†ã€‚

    suspend æ˜¯æœ‰æš‚åœçš„æ„æ€ï¼Œä½†æˆ‘ä»¬åœ¨åç¨‹ä¸­åº”è¯¥ç†è§£ä¸ºï¼šå½“çº¿ç¨‹æ‰§è¡Œåˆ°åç¨‹çš„ suspend å‡½æ•°çš„æ—¶å€™ï¼Œæš‚æ—¶ä¸ç»§ç»­æ‰§è¡Œåç¨‹ä»£ç äº†ã€‚

    æˆ‘ä»¬å…ˆè®©æ—¶é—´é™æ­¢ï¼Œç„¶åå…µåˆ†ä¸¤è·¯ï¼Œåˆ†åˆ«çœ‹çœ‹è¿™ä¸¤ä¸ªäº’ç›¸è„±ç¦»çš„çº¿ç¨‹å’Œåç¨‹æ¥ä¸‹æ¥å°†ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ï¼š

    **çº¿ç¨‹ï¼š**

    å‰é¢æˆ‘ä»¬æåˆ°ï¼ŒæŒ‚èµ·ä¼šè®©åç¨‹ä»æ­£åœ¨æ‰§è¡Œå®ƒçš„çº¿ç¨‹ä¸Šè„±ç¦»ï¼Œå…·ä½“åˆ°ä»£ç å…¶å®æ˜¯ï¼š

    åç¨‹çš„ä»£ç å—ä¸­ï¼Œçº¿ç¨‹æ‰§è¡Œåˆ°äº† suspend å‡½æ•°è¿™é‡Œçš„æ—¶å€™ï¼Œå°±æš‚æ—¶ä¸å†æ‰§è¡Œå‰©ä½™çš„åç¨‹ä»£ç ï¼Œè·³å‡ºåç¨‹çš„ä»£ç å—ã€‚

    é‚£çº¿ç¨‹æ¥ä¸‹æ¥ä¼šåšä»€ä¹ˆå‘¢ï¼Ÿ

    å¦‚æœå®ƒæ˜¯ä¸€ä¸ªåå°çº¿ç¨‹ï¼š

    - è¦ä¹ˆæ— äº‹å¯åšï¼Œè¢«ç³»ç»Ÿå›æ”¶
    - è¦ä¹ˆç»§ç»­æ‰§è¡Œåˆ«çš„åå°ä»»åŠ¡

    è·Ÿ Java çº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹åœ¨å·¥ä½œç»“æŸä¹‹åæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼šå›æ”¶æˆ–è€…å†åˆ©ç”¨ã€‚

    å¦‚æœè¿™ä¸ªçº¿ç¨‹å®ƒæ˜¯ Android çš„ä¸»çº¿ç¨‹ï¼Œé‚£å®ƒæ¥ä¸‹æ¥å°±ä¼šç»§ç»­å›å»å·¥ä½œï¼šä¹Ÿå°±æ˜¯ä¸€ç§’é’Ÿ 60 æ¬¡çš„ç•Œé¢åˆ·æ–°ä»»åŠ¡ã€‚

    ä¸€ä¸ªå¸¸è§çš„åœºæ™¯æ˜¯ï¼Œè·å–ä¸€ä¸ªå›¾ç‰‡ï¼Œç„¶åæ˜¾ç¤ºå‡ºæ¥ï¼š

    ```kotlin
    ğŸï¸
    // ä¸»çº¿ç¨‹ä¸­
    GlobalScope.launch(Dispatchers.Main) {
      val image = suspendingGetImage(imageId)  // è·å–å›¾ç‰‡
      avatarIv.setImageBitmap(image)           // æ˜¾ç¤ºå‡ºæ¥
    }
    suspend fun suspendingGetImage(id: String) = withContext(Dispatchers.IO) {
      ...
    }
    
    ```

    è¿™æ®µæ‰§è¡Œåœ¨ä¸»çº¿ç¨‹çš„åç¨‹ï¼Œå®ƒå®è´¨ä¸Šä¼šå¾€ä½ çš„ä¸»çº¿ç¨‹ `post` ä¸€ä¸ª `Runnable`ï¼Œè¿™ä¸ª `Runnable` å°±æ˜¯ä½ çš„åç¨‹ä»£ç ï¼š

    ```kotlin
    ğŸï¸
    handler.post {
      val image = suspendingGetImage(imageId)
      avatarIv.setImageBitmap(image)
    }
    
    ```

    å½“è¿™ä¸ªåç¨‹è¢«æŒ‚èµ·çš„æ—¶å€™ï¼Œå°±æ˜¯ä¸»çº¿ç¨‹ `post` çš„è¿™ä¸ª `Runnable` æå‰ç»“æŸï¼Œç„¶åç»§ç»­æ‰§è¡Œå®ƒç•Œé¢åˆ·æ–°çš„ä»»åŠ¡ã€‚

    ------

    **åç¨‹ï¼š**

    çº¿ç¨‹çš„ä»£ç åœ¨åˆ°è¾¾ `suspend` å‡½æ•°çš„æ—¶å€™è¢«ææ–­ï¼Œæ¥ä¸‹æ¥åç¨‹ä¼šä»è¿™ä¸ª `suspend` å‡½æ•°å¼€å§‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œä¸è¿‡æ˜¯åœ¨**æŒ‡å®šçš„çº¿ç¨‹**ã€‚

    è°æŒ‡å®šçš„ï¼Ÿæ˜¯ `suspend` å‡½æ•°æŒ‡å®šçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•°å†…éƒ¨çš„ `withContext` ä¼ å…¥çš„ `Dispatchers.IO` æ‰€æŒ‡å®šçš„ IO çº¿ç¨‹ã€‚

    `Dispatchers` è°ƒåº¦å™¨ï¼Œå®ƒå¯ä»¥å°†åç¨‹é™åˆ¶åœ¨ä¸€ä¸ªç‰¹å®šçš„çº¿ç¨‹æ‰§è¡Œï¼Œæˆ–è€…å°†å®ƒåˆ†æ´¾åˆ°ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæˆ–è€…è®©å®ƒä¸å—é™åˆ¶åœ°è¿è¡Œï¼Œå…³äº `Dispatchers` è¿™é‡Œå…ˆä¸å±•å¼€äº†ã€‚

    é‚£æˆ‘ä»¬å¹³æ—¥é‡Œå¸¸ç”¨åˆ°çš„è°ƒåº¦å™¨æœ‰å“ªäº›ï¼Ÿ

    å¸¸ç”¨çš„ `Dispatchers` ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§ï¼š

    - `Dispatchers.Main`ï¼šAndroid ä¸­çš„ä¸»çº¿ç¨‹
    - `Dispatchers.IO`ï¼šé’ˆå¯¹ç£ç›˜å’Œç½‘ç»œ IO è¿›è¡Œäº†ä¼˜åŒ–ï¼Œé€‚åˆ IO å¯†é›†å‹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ï¼šè¯»å†™æ–‡ä»¶ï¼Œæ“ä½œæ•°æ®åº“ä»¥åŠç½‘ç»œè¯·æ±‚
    - `Dispatchers.Default`ï¼šé€‚åˆ CPU å¯†é›†å‹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚è®¡ç®—

    å›åˆ°æˆ‘ä»¬çš„åç¨‹ï¼Œå®ƒä» `suspend` å‡½æ•°å¼€å§‹è„±ç¦»å¯åŠ¨å®ƒçš„çº¿ç¨‹ï¼Œç»§ç»­æ‰§è¡Œåœ¨ `Dispatchers` æ‰€æŒ‡å®šçš„ IO çº¿ç¨‹ã€‚

    ç´§æ¥ç€åœ¨ `suspend` å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åï¼Œåç¨‹ä¸ºæˆ‘ä»¬åšçš„æœ€çˆ½çš„äº‹å°±æ¥äº†ï¼šä¼š**è‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠçº¿ç¨‹å†åˆ‡å›æ¥**ã€‚

    è¿™ä¸ªã€Œåˆ‡å›æ¥ã€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

    æˆ‘ä»¬çš„åç¨‹åŸæœ¬æ˜¯è¿è¡Œåœ¨**ä¸»çº¿ç¨‹**çš„ï¼Œå½“ä»£ç é‡åˆ° suspend å‡½æ•°çš„æ—¶å€™ï¼Œå‘ç”Ÿçº¿ç¨‹åˆ‡æ¢ï¼Œæ ¹æ® `Dispatchers` åˆ‡æ¢åˆ°äº† IO çº¿ç¨‹ï¼›

    å½“è¿™ä¸ªå‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œçº¿ç¨‹åˆåˆ‡äº†å›æ¥ï¼Œã€Œåˆ‡å›æ¥ã€ä¹Ÿå°±æ˜¯åç¨‹ä¼šå¸®æˆ‘å† `post` ä¸€ä¸ª `Runnable`ï¼Œè®©æˆ‘å‰©ä¸‹çš„ä»£ç ç»§ç»­å›åˆ°ä¸»çº¿ç¨‹å»æ‰§è¡Œã€‚

     

    æˆ‘ä»¬ä»çº¿ç¨‹å’Œåç¨‹çš„ä¸¤ä¸ªè§’åº¦éƒ½åˆ†æå®Œæˆåï¼Œç»ˆäºå¯ä»¥å¯¹åç¨‹çš„ã€ŒæŒ‚èµ·ã€suspend åšä¸€ä¸ªè§£é‡Šï¼š

    åç¨‹åœ¨æ‰§è¡Œåˆ°æœ‰ suspend æ ‡è®°çš„å‡½æ•°çš„æ—¶å€™ï¼Œä¼šè¢« suspend ä¹Ÿå°±æ˜¯è¢«æŒ‚èµ·ï¼Œè€Œæ‰€è°“çš„è¢«æŒ‚èµ·ï¼Œå°±æ˜¯åˆ‡ä¸ªçº¿ç¨‹ï¼›

    ä¸è¿‡åŒºåˆ«åœ¨äºï¼Œ**æŒ‚èµ·å‡½æ•°åœ¨æ‰§è¡Œå®Œæˆä¹‹åï¼Œåç¨‹ä¼šé‡æ–°åˆ‡å›å®ƒåŸå…ˆçš„çº¿ç¨‹**ã€‚

    å†ç®€å•æ¥è®²ï¼Œåœ¨ Kotlin ä¸­æ‰€è°“çš„æŒ‚èµ·ï¼Œå°±æ˜¯**ä¸€ä¸ªç¨åä¼šè¢«è‡ªåŠ¨åˆ‡å›æ¥çš„çº¿ç¨‹è°ƒåº¦æ“ä½œ**ã€‚

    >  è¿™ä¸ªã€Œåˆ‡å›æ¥ã€çš„åŠ¨ä½œï¼Œåœ¨ Kotlin é‡Œå«åš [resume](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/-continuation/resume.html)ï¼Œæ¢å¤ã€‚

    é€šè¿‡åˆšæ‰çš„åˆ†ææˆ‘ä»¬çŸ¥é“ï¼šæŒ‚èµ·ä¹‹åæ˜¯éœ€è¦æ¢å¤ã€‚

    è€Œæ¢å¤è¿™ä¸ªåŠŸèƒ½æ˜¯åç¨‹çš„ï¼Œå¦‚æœä½ ä¸åœ¨åç¨‹é‡Œé¢è°ƒç”¨ï¼Œæ¢å¤è¿™ä¸ªåŠŸèƒ½æ²¡æ³•å®ç°ï¼Œæ‰€ä»¥ä¹Ÿå°±å›ç­”äº†è¿™ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆæŒ‚èµ·å‡½æ•°å¿…é¡»åœ¨åç¨‹æˆ–è€…å¦ä¸€ä¸ªæŒ‚èµ·å‡½æ•°é‡Œè¢«è°ƒç”¨ã€‚

    å†ç»†æƒ³ä¸‹è¿™ä¸ªé€»è¾‘ï¼šä¸€ä¸ªæŒ‚èµ·å‡½æ•°è¦ä¹ˆåœ¨åç¨‹é‡Œè¢«è°ƒç”¨ï¼Œè¦ä¹ˆåœ¨å¦ä¸€ä¸ªæŒ‚èµ·å‡½æ•°é‡Œè¢«è°ƒç”¨ï¼Œé‚£ä¹ˆå®ƒå…¶å®ç›´æ¥æˆ–è€…é—´æ¥åœ°ï¼Œæ€»æ˜¯ä¼šåœ¨ä¸€ä¸ªåç¨‹é‡Œè¢«è°ƒç”¨çš„ã€‚

    æ‰€ä»¥ï¼Œè¦æ±‚ `suspend` å‡½æ•°åªèƒ½åœ¨åç¨‹é‡Œæˆ–è€…å¦ä¸€ä¸ª suspend å‡½æ•°é‡Œè¢«è°ƒç”¨ï¼Œè¿˜æ˜¯ä¸ºäº†è¦è®©åç¨‹èƒ½å¤Ÿåœ¨ `suspend` å‡½æ•°åˆ‡æ¢çº¿ç¨‹ä¹‹åå†åˆ‡å›æ¥ã€‚

    ------

    ####  æ€ä¹ˆå°±ã€ŒæŒ‚èµ·ã€äº†ï¼Ÿ

    æˆ‘ä»¬äº†è§£åˆ°äº†ä»€ä¹ˆæ˜¯ã€ŒæŒ‚èµ·ã€åï¼Œå†æ¥ç€çœ‹çœ‹è¿™ä¸ªã€ŒæŒ‚èµ·ã€æ˜¯æ€ä¹ˆåšåˆ°çš„ã€‚

    å…ˆéšä¾¿å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„ `suspend` å‡½æ•°ï¼š

    ```kotlin
    ğŸï¸
    suspend fun suspendingPrint() {
      println("Thread: ${Thread.currentThread().name}")
     }
    
    I/System.out: Thread: main
    
    ```

    è¾“å‡ºçš„ç»“æœè¿˜æ˜¯åœ¨ä¸»çº¿ç¨‹ã€‚

    ä¸ºä»€ä¹ˆæ²¡åˆ‡æ¢çº¿ç¨‹ï¼Ÿå› ä¸ºå®ƒä¸çŸ¥é“å¾€å“ªåˆ‡ï¼Œéœ€è¦æˆ‘ä»¬å‘Šè¯‰å®ƒã€‚

    å¯¹æ¯”ä¹‹å‰ä¾‹å­ä¸­ `suspendingGetImage` å‡½æ•°ä»£ç ï¼š

    ```kotlin
    ğŸï¸
    //                                               ğŸ‘‡
    suspend fun suspendingGetImage(id: String) = withContext(Dispatchers.IO) {
      ...
      
    }
    
    ```

    æˆ‘ä»¬å¯ä»¥å‘ç°ä¸åŒä¹‹å¤„å…¶å®åœ¨äº `withContext` å‡½æ•°ã€‚

    å…¶å®é€šè¿‡ `withContext` æºç å¯ä»¥çŸ¥é“ï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª `Dispatcher` å‚æ•°ï¼Œä¾èµ–è¿™ä¸ª `Dispatcher` å‚æ•°çš„æŒ‡ç¤ºï¼Œä½ çš„åç¨‹è¢«æŒ‚èµ·ï¼Œç„¶ååˆ‡åˆ°åˆ«çš„çº¿ç¨‹ã€‚

    æ‰€ä»¥è¿™ä¸ª `suspend`ï¼Œå…¶å®å¹¶ä¸æ˜¯èµ·åˆ°æŠŠä»»ä½•æŠŠåç¨‹æŒ‚èµ·ï¼Œæˆ–è€…è¯´åˆ‡æ¢çº¿ç¨‹çš„ä½œç”¨ã€‚

    çœŸæ­£æŒ‚èµ·åç¨‹è¿™ä»¶äº‹ï¼Œæ˜¯ Kotlin çš„åç¨‹æ¡†æ¶å¸®æˆ‘ä»¬åšçš„ã€‚

    æ‰€ä»¥æˆ‘ä»¬æƒ³è¦è‡ªå·±å†™ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œä»…ä»…åªåŠ ä¸Š `suspend` å…³é”®å­—æ˜¯ä¸è¡Œçš„ï¼Œè¿˜éœ€è¦å‡½æ•°å†…éƒ¨ç›´æ¥æˆ–é—´æ¥åœ°è°ƒç”¨åˆ° Kotlin åç¨‹æ¡†æ¶è‡ªå¸¦çš„ `suspend` å‡½æ•°æ‰è¡Œã€‚

    ### suspend çš„æ„ä¹‰ï¼Ÿ

    è¿™ä¸ª `suspend` å…³é”®å­—ï¼Œæ—¢ç„¶å®ƒå¹¶ä¸æ˜¯çœŸæ­£å®ç°æŒ‚èµ·ï¼Œé‚£å®ƒçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ

    **å®ƒå…¶å®æ˜¯ä¸€ä¸ªæé†’ã€‚**

    å‡½æ•°çš„åˆ›å»ºè€…å¯¹å‡½æ•°çš„ä½¿ç”¨è€…çš„æé†’ï¼šæˆ‘æ˜¯ä¸€ä¸ªè€—æ—¶å‡½æ•°ï¼Œæˆ‘è¢«æˆ‘çš„åˆ›å»ºè€…ç”¨æŒ‚èµ·çš„æ–¹å¼æ”¾åœ¨åå°è¿è¡Œï¼Œæ‰€ä»¥è¯·åœ¨åç¨‹é‡Œè°ƒç”¨æˆ‘ã€‚

    ä¸ºä»€ä¹ˆ `suspend` å…³é”®å­—å¹¶æ²¡æœ‰å®é™…å»æ“ä½œæŒ‚èµ·ï¼Œä½† Kotlin å´æŠŠå®ƒæä¾›å‡ºæ¥ï¼Ÿ

    å› ä¸ºå®ƒæœ¬æ¥å°±ä¸æ˜¯ç”¨æ¥æ“ä½œæŒ‚èµ·çš„ã€‚

    æŒ‚èµ·çš„æ“ä½œ â€”â€” ä¹Ÿå°±æ˜¯åˆ‡çº¿ç¨‹ï¼Œä¾èµ–çš„æ˜¯æŒ‚èµ·å‡½æ•°é‡Œé¢çš„å®é™…ä»£ç ï¼Œè€Œä¸æ˜¯è¿™ä¸ªå…³é”®å­—ã€‚

    æ‰€ä»¥è¿™ä¸ªå…³é”®å­—ï¼Œ**åªæ˜¯ä¸€ä¸ªæé†’**ã€‚

    è¿˜è®°å¾—åˆšæ‰æˆ‘ä»¬å°è¯•è‡ªå®šä¹‰æŒ‚èµ·å‡½æ•°çš„æ–¹æ³•å—ï¼Ÿ

    ```kotlin
    ğŸï¸
    // ğŸ‘‡ redundant suspend modifier
    suspend fun suspendingPrint() {
      println("Thread: ${Thread.currentThread().name}")
    }
    
    ```

    å¦‚æœä½ åˆ›å»ºä¸€ä¸ª `suspend` å‡½æ•°ä½†å®ƒå†…éƒ¨ä¸åŒ…å«çœŸæ­£çš„æŒ‚èµ·é€»è¾‘ï¼Œç¼–è¯‘å™¨ä¼šç»™ä½ ä¸€ä¸ªæé†’ï¼š`redundant suspend modifier`ï¼Œå‘Šè¯‰ä½ è¿™ä¸ª `suspend` æ˜¯å¤šä½™çš„ã€‚

    å› ä¸ºä½ è¿™ä¸ªå‡½æ•°å®è´¨ä¸Šå¹¶æ²¡æœ‰å‘ç”ŸæŒ‚èµ·ï¼Œé‚£ä½ è¿™ä¸ª `suspend` å…³é”®å­—åªæœ‰ä¸€ä¸ªæ•ˆæœï¼šå°±æ˜¯é™åˆ¶è¿™ä¸ªå‡½æ•°åªèƒ½åœ¨åç¨‹é‡Œè¢«è°ƒç”¨ï¼Œå¦‚æœåœ¨éåç¨‹çš„ä»£ç ä¸­è°ƒç”¨ï¼Œå°±ä¼šç¼–è¯‘ä¸é€šè¿‡ã€‚

    æ‰€ä»¥ï¼Œåˆ›å»ºä¸€ä¸ª `suspend` å‡½æ•°ï¼Œä¸ºäº†è®©å®ƒåŒ…å«çœŸæ­£æŒ‚èµ·çš„é€»è¾‘ï¼Œè¦åœ¨å®ƒå†…éƒ¨ç›´æ¥æˆ–é—´æ¥è°ƒç”¨ Kotlin è‡ªå¸¦çš„ `suspend` å‡½æ•°ï¼Œä½ çš„è¿™ä¸ª `suspend` æ‰æ˜¯æœ‰æ„ä¹‰çš„ã€‚

    ### æ€ä¹ˆè‡ªå®šä¹‰ suspend å‡½æ•°ï¼Ÿ

    åœ¨äº†è§£äº† `suspend` å…³é”®å­—çš„æ¥é¾™å»è„‰ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥ä¸‹ä¸€ä¸ªè¯é¢˜äº†ï¼šæ€ä¹ˆè‡ªå®šä¹‰ `suspend` å‡½æ•°ã€‚

    è¿™ä¸ªã€Œæ€ä¹ˆè‡ªå®šä¹‰ã€å…¶å®åˆ†ä¸ºä¸¤ä¸ªé—®é¢˜ï¼š

    - ä»€ä¹ˆæ—¶å€™éœ€è¦è‡ªå®šä¹‰ `suspend` å‡½æ•°ï¼Ÿ
    - å…·ä½“è¯¥æ€ä¹ˆå†™å‘¢ï¼Ÿ

    #### ä»€ä¹ˆæ—¶å€™éœ€è¦è‡ªå®šä¹‰ suspend å‡½æ•°

    å¦‚æœä½ çš„æŸä¸ªå‡½æ•°æ¯”è¾ƒè€—æ—¶ï¼Œä¹Ÿå°±æ˜¯è¦ç­‰çš„æ“ä½œï¼Œé‚£å°±æŠŠå®ƒå†™æˆ `suspend` å‡½æ•°ã€‚è¿™å°±æ˜¯åŸåˆ™ã€‚

    è€—æ—¶æ“ä½œä¸€èˆ¬åˆ†ä¸ºä¸¤ç±»ï¼šI/O æ“ä½œå’Œ CPU è®¡ç®—å·¥ä½œã€‚æ¯”å¦‚æ–‡ä»¶çš„è¯»å†™ã€ç½‘ç»œäº¤äº’ã€å›¾ç‰‡çš„æ¨¡ç³Šå¤„ç†ï¼Œéƒ½æ˜¯è€—æ—¶çš„ï¼Œé€šé€šå¯ä»¥æŠŠå®ƒä»¬å†™è¿› `suspend` å‡½æ•°é‡Œã€‚

    å¦å¤–è¿™ä¸ªã€Œè€—æ—¶ã€è¿˜æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå°±æ˜¯è¿™ä»¶äº‹æœ¬èº«åšèµ·æ¥å¹¶ä¸æ…¢ï¼Œä½†å®ƒéœ€è¦ç­‰å¾…ï¼Œæ¯”å¦‚ 5 ç§’é’Ÿä¹‹åå†åšè¿™ä¸ªæ“ä½œã€‚è¿™ç§ä¹Ÿæ˜¯ `suspend` å‡½æ•°çš„åº”ç”¨åœºæ™¯ã€‚

    #### å…·ä½“è¯¥æ€ä¹ˆå†™

    ç»™å‡½æ•°åŠ ä¸Š `suspend` å…³é”®å­—ï¼Œç„¶ååœ¨ `withContext` æŠŠå‡½æ•°çš„å†…å®¹åŒ…ä½å°±å¯ä»¥äº†ã€‚

    æåˆ°ç”¨ `withContext`æ˜¯å› ä¸ºå®ƒåœ¨æŒ‚èµ·å‡½æ•°é‡ŒåŠŸèƒ½æœ€ç®€å•ç›´æ¥ï¼šæŠŠçº¿ç¨‹è‡ªåŠ¨åˆ‡èµ°å’Œåˆ‡å›ã€‚

    å½“ç„¶å¹¶ä¸æ˜¯åªæœ‰ `withContext` è¿™ä¸€ä¸ªå‡½æ•°æ¥è¾…åŠ©æˆ‘ä»¬å®ç°è‡ªå®šä¹‰çš„ `suspend` å‡½æ•°ï¼Œæ¯”å¦‚è¿˜æœ‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°å« `delay`ï¼Œå®ƒçš„ä½œç”¨æ˜¯ç­‰å¾…ä¸€æ®µæ—¶é—´åå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œä»£ç ã€‚

    ä½¿ç”¨å®ƒå°±å¯ä»¥å®ç°åˆšæ‰æåˆ°çš„ç­‰å¾…ç±»å‹çš„è€—æ—¶æ“ä½œï¼š

    ```kotlin
    ğŸï¸
    suspend fun suspendUntilDone() {
       while (!done) {
         delay(5)
       }
    }
    
    ```

40. ### ä»€ä¹ˆæ˜¯ã€Œéé˜»å¡å¼æŒ‚èµ·ã€

    > - åç¨‹å°±æ˜¯ä¸ªçº¿ç¨‹æ¡†æ¶
    > - åç¨‹çš„æŒ‚èµ·æœ¬è´¨å°±æ˜¯çº¿ç¨‹åˆ‡å‡ºå»å†åˆ‡å›æ¥

    ä»è¯­ä¹‰ä¸Šç†è§£ã€Œéé˜»å¡å¼æŒ‚èµ·ã€ï¼Œè®²çš„æ˜¯ã€Œéé˜»å¡å¼ã€è¿™ä¸ªæ˜¯æŒ‚èµ·çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåç¨‹çš„æŒ‚èµ·ï¼Œå°±æ˜¯éé˜»å¡å¼çš„ï¼Œé˜»å¡ä¸é˜»å¡ï¼Œéƒ½æ˜¯é’ˆå¯¹å•çº¿ç¨‹è®²çš„ï¼Œä¸€æ—¦åˆ‡äº†çº¿ç¨‹ï¼Œè‚¯å®šæ˜¯éé˜»å¡çš„ï¼Œä½ éƒ½è·‘åˆ°åˆ«çš„çº¿ç¨‹äº†ï¼Œä¹‹å‰çš„çº¿ç¨‹å°±è‡ªç”±äº†ï¼Œå¯ä»¥ç»§ç»­åšåˆ«çš„äº‹æƒ…äº†ã€‚

    æ‰€ä»¥ã€Œéé˜»å¡å¼æŒ‚èµ·ã€ï¼Œå…¶å®å°±æ˜¯åœ¨è®²åç¨‹åœ¨æŒ‚èµ·çš„åŒæ—¶åˆ‡çº¿ç¨‹è¿™ä»¶äº‹æƒ…ã€‚

    * åç¨‹åªæ˜¯åœ¨å†™æ³•ä¸Šã€Œçœ‹èµ·æ¥é˜»å¡ã€ï¼Œå…¶å®æ˜¯ã€Œéé˜»å¡ã€çš„ï¼Œå› ä¸ºåœ¨åç¨‹é‡Œé¢å®ƒåšäº†å¾ˆå¤šå·¥ä½œï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå°±æ˜¯å¸®æˆ‘ä»¬åˆ‡çº¿ç¨‹ã€‚

    * åˆ‡çº¿ç¨‹å…ˆåˆ‡è¿‡å»ï¼Œç„¶åå†åˆ‡å›æ¥ã€‚
    * çº¿ç¨‹è™½ç„¶ä¼šåˆ‡ï¼Œä½†å†™æ³•ä¸Šå’Œæ™®é€šçš„å•çº¿ç¨‹å·®ä¸å¤šã€‚

    è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š

    ```kotlin
    ğŸï¸
    main {
        GlobalScope.launch(Dispatchers.Main) {
            // ğŸ‘‡ è€—æ—¶æ“ä½œ
            val user = suspendingRequestUser()
            updateView(user)
        }
        
        private suspend fun suspendingRequestUser() : User = withContext(Dispatchers.IO) {
            api.requestUser()
        }
    }
    
    ```

    ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œè€—æ—¶æ“ä½œå’Œæ›´æ–° UI çš„é€»è¾‘åƒå†™å•çº¿ç¨‹ä¸€æ ·æ”¾åœ¨äº†ä¸€èµ·ï¼Œåªæ˜¯åœ¨å¤–é¢åŒ…äº†ä¸€å±‚åç¨‹ã€‚

    è€Œæ­£æ˜¯è¿™ä¸ªåç¨‹è§£å†³äº†åŸæ¥æˆ‘ä»¬å•çº¿ç¨‹å†™æ³•ä¼šå¡çº¿ç¨‹è¿™ä»¶äº‹ã€‚

41. ### åç¨‹ä¸çº¿ç¨‹

    åœ¨ Kotlin é‡Œï¼Œåç¨‹å°±æ˜¯åŸºäºçº¿ç¨‹æ¥å®ç°çš„ä¸€ç§æ›´ä¸Šå±‚çš„å·¥å…· APIï¼Œç±»ä¼¼äº Java è‡ªå¸¦çš„ Executor ç³»åˆ— API æˆ–è€… Android çš„ Handler ç³»åˆ— APIã€‚

    åªä¸è¿‡å‘¢ï¼Œåç¨‹å®ƒä¸ä»…æä¾›äº†æ–¹ä¾¿çš„ APIï¼Œåœ¨è®¾è®¡æ€æƒ³ä¸Šæ˜¯ä¸€ä¸ª**åŸºäºçº¿ç¨‹çš„ä¸Šå±‚æ¡†æ¶**ï¼Œä½ å¯ä»¥ç†è§£ä¸ºæ–°é€ äº†ä¸€äº›æ¦‚å¿µç”¨æ¥å¸®åŠ©ä½ æ›´å¥½åœ°ä½¿ç”¨è¿™äº› APIï¼Œä»…æ­¤è€Œå·²ã€‚

    å°±åƒ ReactiveX ä¸€æ ·ï¼Œä¸ºäº†è®©ä½ æ›´å¥½åœ°ä½¿ç”¨å„ç§æ“ä½œç¬¦ APIï¼Œæ–°é€ äº† Observable ç­‰æ¦‚å¿µã€‚

    è¯´åˆ°è¿™é‡Œï¼ŒKotlin åç¨‹çš„ä¸‰å¤§ç–‘é—®ï¼šåç¨‹æ˜¯ä»€ä¹ˆã€æŒ‚èµ·æ˜¯ä»€ä¹ˆã€æŒ‚èµ·çš„éé˜»å¡å¼æ˜¯æ€ä¹ˆå›äº‹:

    - åç¨‹å°±æ˜¯åˆ‡çº¿ç¨‹,åŸºäºçº¿ç¨‹æ¥å®ç°çš„ä¸€ç§æ›´ä¸Šå±‚çš„å·¥å…· APIï¼›
    - æŒ‚èµ·å°±æ˜¯å¯ä»¥è‡ªåŠ¨åˆ‡å›æ¥çš„åˆ‡çº¿ç¨‹ï¼›
    - æŒ‚èµ·çš„éé˜»å¡å¼æŒ‡çš„æ˜¯å®ƒèƒ½ç”¨çœ‹èµ·æ¥é˜»å¡çš„ä»£ç å†™å‡ºéé˜»å¡çš„æ“ä½œ

    

42. 

